{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./Cell.js","webpack:///../node_modules/@turf/inside/index.js","webpack:///../node_modules/chroma-js/chroma.js","webpack:///../node_modules/@turf/invariant/index.js","webpack:///./layer/L.CanvasLayer.js","webpack:///./layer/L.CanvasLayer.SimpleLonLat.js","webpack:///./layer/L.CanvasLayer.Field.js","webpack:///./layer/L.CanvasLayer.ScalarField.js","webpack:///./layer/L.CanvasLayer.VectorFieldAnim.js","webpack:///./control/L.Control.ColorBar.js","webpack:///./control/L.Control.LayersPlayer.js","webpack:///./Vector.js","webpack:///./Field.js","webpack:///./ScalarField.js","webpack:///./VectorField.js","webpack:///./_main.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Cell","center","xSize","ySize","this","anotherCell","equals","_equalValues","anotherValue","type","constructor","Number","Vector","u","v","halfX","halfY","cLat","lat","cLng","lng","ul","L","latLng","lr","latLngBounds","invariant","getCoord","getCoords","inRing","pt","ring","ignoreBoundary","isInside","length","slice","j","xi","yi","xj","yj","point","polygon","Error","polys","geometry","bbox","inBBox","insidePoly","inHole","k","limit","x","min","max","classToType","list","toLowerCase","obj","toString","PI","Math","utils","clip_rgb","rgb","_clipped","_unclipped","unpack","args","keyOrder","Array","split","filter","undefined","map","last","TWOPI","PITHIRD","DEG2RAD","RAD2DEG","input","format","autodetect","last$1","clip_rgb$1","type$1","Color","len","arguments","me","sorted","sort","a","b","chk","test","apply","_rgb","push","hex","join","Color_1","chroma","Function","concat","version","chroma_1","unpack$1","rgb2cmyk_1","ref","g","f","y","unpack$2","cmyk2rgb_1","alpha","unpack$3","type$2","cmyk","unpack$4","last$2","rnd","round","hsl2css_1","hsla","unpack$5","rgb2hsl_1","h","NaN","unpack$6","last$3","rgb2css_1","rgba","substr","unpack$7","round$1","hsl2rgb_1","assign","t3","t2","t1","h_","RE_RGB","RE_RGBA","RE_RGB_PCT","RE_RGBA_PCT","RE_HSL","RE_HSLA","round$2","css2rgb","css","trim","named","e","match","rgb$1","i$1","rgb$2","i$2","rgb$3","i$3","hsl","rgb$4","hsl$1","rgb$5","css2rgb_1","type$3","rest","unpack$8","gl","unpack$9","rgb2hcg_1","delta","_g","unpack$a","floor","hcg2rgb_1","assign$1","assign$2","assign$3","assign$4","assign$5","_c","q","unpack$b","type$4","hcg","unpack$c","last$4","round$3","rgb2hex_1","str","hxa","RE_HEX","RE_HEXA","hex2rgb_1","parseInt","u$1","type$5","indexOf","unpack$d","sqrt","acos","rgb2hsi_1","min_","unpack$e","limit$1","TWOPI$1","cos","hsi2rgb_1","isNaN","unpack$f","type$6","hsi","unpack$g","type$7","unpack$h","min$1","max$1","rgb2hsv","max_","unpack$i","floor$1","hsv2rgb_1","unpack$j","type$8","hsv","labConstants","unpack$k","pow","rgb_xyz","xyz_lab","rgb2xyz","rgb2lab_1","ref$1","z","unpack$l","pow$1","xyz_rgb","lab_xyz","lab2rgb_1","unpack$m","type$9","lab","unpack$n","sqrt$1","atan2","round$4","lab2lch_1","unpack$o","rgb2lch_1","b_","unpack$p","sin","cos$1","lch2lab_1","unpack$q","lch2rgb_1","unpack$r","hcl2rgb_1","hcl","reverse","unpack$s","type$a","lch","forEach","w3cx11_1","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflower","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","laserlemon","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrod","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","maroon2","maroon3","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","purple2","purple3","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","type$b","keys","unpack$t","rgb2num_1","type$c","num2rgb_1","num","type$d","unpack$u","type$e","round$5","log","temperature2rgb_1","kelvin","temp","unpack$v","round$6","rgb2temperature_1","minTemp","maxTemp","eps","temperature","type$f","mutate","clipped","darken","amount","brighten","darker","brighter","mc","channel","src","type$g","pow$2","luminance","lum","cur_lum","max_iter","low","high","mid","interpolate","lm","abs","rgb2luminance","luminance_x","interpolator","type$h","mix","col1","col2","premultiply","saturate","desaturate","type$i","set","charAt","out","xyz0","xyz1","sqrt$2","pow$3","lrgb","x1","y1","z1","x2","y2","z2","_hsx","hue0","hue1","sat0","sat1","lbv0","lbv1","sat","hue","lch$1","c1","c2","clip_rgb$2","pow$4","sqrt$3","PI$1","cos$2","sin$1","atan2$1","_average_lrgb","colors","weights","xyz","col","type$j","pow$5","scale","_mode","_nacol","_spread","_domain","_pos","_padding","_classes","_colors","_out","_min","_max","_correctLightness","_colorCache","_useCache","_gamma","setColors","brewer","c$1","resetCache","tMapLightness","tMapDomain","getColor","val","bypassMap","getClass","classes","analyze","limits","domain","from","tOut","tBreaks","every","_m","range","_o","spread","correctLightness","L0","L1","pol","L_actual","L_ideal","L_diff","t0","padding","numColors","result","dm","dd","__range__","samples","end","asc","cache","gamma","nodata","left","right","inclusive","ascending","bezier","I","lab0","lab1","lab2","lab3","I0","I1","blend","bottom","top","blend_f","c0","each","normal","multiply","screen","overlay","lighten","dodge","burn","blend_1","type$k","clip_rgb$3","TWOPI$2","pow$6","sin$2","cos$3","floor$2","random","log$1","pow$7","floor$3","data","MAX_VALUE","sum","values","count","min_log","LOG10E","max_log","pb","pr","cluster","assignments","clusterSizes","repeat","nb_iters","centroids","i$4","mindist","best","j$1","dist","newCentroids","j$2","i$5","j$3","j$4","kClusters","j$5","i$6","tmpKMeansBreaks","j$6","i$7","analyze_1","sqrt$4","atan2$2","abs$1","cos$4","PI$2","scales","cool","hot","colorbrewer","OrRd","PuBu","BuPu","Oranges","BuGn","YlOrBr","YlGn","Reds","RdPu","Greens","YlGnBu","Purples","GnBu","Greys","YlOrRd","PuRd","Blues","PuBuGn","Viridis","Spectral","RdYlGn","RdBu","PiYG","PRGn","RdYlBu","BrBG","RdGy","PuOr","Set2","Accent","Set1","Set3","Dark2","Paired","Pastel2","Pastel1","list$1","colorbrewer_1","average","reduce","w","first","shift","cnt","dx","dy","A","ci","xyz2","A$1","cubehelix","start","rotations","lightness","dl","dh","fract","amp","cos_a","sin_a","code","contrast","l1","l2","deltaE","C","a1","b1","L2","a2","b2","sl","sc","h1","c4","sh","delC","delA","delB","v1","v2","distance","sum_sq","valid","factory","coordinates","containsNumber","isArray","getGeom","geojson","geometries","geojsonType","collectionOf","featureCollection","features","feature","featureOf","getGeomType","geom","CanvasLayer","Layer","extend","initialize","options","_map","_canvas","_frame","_delegate","setOptions","delegate","del","needRedraw","Util","requestAnimFrame","drawLayer","_onLayerDidResize","resizeEvent","width","newSize","height","_onLayerDidMove","topLeft","containerPointToLayerPoint","DomUtil","setPosition","getEvents","events","resize","moveend","zoomAnimation","Browser","any3d","zoomanim","_animateZoom","onAdd","tiles","size","getSize","animated","addClass","pane","getPanes","_panes","overlayPane","appendChild","on","onLayerDidMount","onRemove","onLayerWillUnmount","removeChild","off","addTo","addLayer","LatLonToMercator","latlon","bounds","getBounds","zoom","getZoom","getCenter","corner","containerPointToLatLng","onDrawLayer","layer","canvas","getZoomScale","offset","_latLngToNewLayerPoint","getNorthWest","setTransform","canvasLayer","SimpleLonLat","color","points","setData","viewInfo","getContext","clearRect","fillStyle","latLngToContainerPoint","beginPath","fillRect","fill","closePath","stroke","xs","ys","xmin","ymin","xmax","ymax","southWest","northEast","simpleLonLat","lonslats","Field","mouseMoveCursor","noValue","opacity","onClick","onMouseMove","inFilter","field","_visible","zoomstart","_hideCanvas","zoomend","_showCanvas","_enableIdentify","_ensureCanvasAlignment","show","hide","_disableIdentify","isVisible","style","visibility","_onClick","_onMouseMove","_field","TypeError","setFilter","fire","setOpacity","_updateOpacity","bb","extent","_queryValue","_changeCursorOn","getContainer","cursor","valueAt","latlng","_getDrawingContext","ScalarField","vectorSize","arrowDirection","scalarField","_defaultColorScale","setColor","_getRendererMethod","_drawImage","_drawArrows","_ensureColor","ctx","img","createImageData","_prepareImageIn","putImageData","pos","pointCoords","lon","_getColorFor","R","G","B","_pixelBounds","pixelSize","nCols","stride","strokeStyle","currentBounds","_lonLatAtIndexes","contains","cell","cellXSize","cellYSize","_drawArrow","northWest","southEast","getSouthEast","projected","save","translate","rotationRads","rotate","moveTo","lineTo","restore","VectorFieldAnim","paths","fade","duration","maxAge","velocityScale","vectorField","timer","_stopAnimation","_prepareParticlePaths","d3","prev","par","age","self","randomPosition","vector","xt","yt","hasValueAt","magnitude","globalCompositeOperation","lineWidth","_drawParticle","source","target","pA","pB","_randomAge","stop","vectorFieldAnim","Control","ColorBar","position","margin","background","textColor","steps","decimals","units","title","labels","textLabels","labelFontSize","labelTextPosition","div","DomEvent","addListener","stopPropagation","preventDefault","backgroundColor","innerHTML","palette","document","createElement","select","append","attr","text","svg","_createSvgIn","_appendColorBarTo","_appendLabelsTo","spaceForLabels","colorPerValue","_getColorPerValue","buckets","selectAll","enter","toFixed","positionPerLabelValue","_getPositionPerLabelValue","label","xPositionFor","scaleLinear","index","control","colorBar","LayersPlayer","canvasList","paneId","activePopup","refreshTime","loop","currentPlay","buttons","cvLst","currentFrame","_createLabels","_createButtons","goTo","displayLayer","idxShow","lastCreated","paneChildren","getPane","children","idxCurrent","paneChild","isActive","display","toggleLoop","_setButtonActive","idx","querySelector","_zeroPad","_latlng","cellValue","fireEvent","frameChange","goFirst","goLast","lastId","goNext","nextIdx","playStop","goPrev","playBackward","setInterval","playForward","clearInterval","_addStyles","domUtilElement","styleDictionary","container","_createMoveFirstButton","_createPlayBackwardsButton","_createPreviousButton","_createStopButton","_createNextButton","_createPlayForwardButton","_createMoveLastButton","_createToggleLoopButton","_createButton","id","defaults","onClickFunction","customClass","cssClass","ex","button","customStyle","_buttonsDefaultStyle","setAttribute","buttonId","buttonClassRunId","cssClassRun","removeClass","places","String","padStart","layersPlayer","newControler","clear","node","hasChildNodes","firstChild","parentNode","clearInner","inDegrees","directionTo","params","nRows","xllCorner","yllCorner","xurCorner","yurCorner","grid","isContinuous","longitudeNeedsToBeWrapped","_inFilter","_spatialMask","_calculateRange","cells","_valueAtIndexes","_updateRange","_getWrappedLongitudes","_pointInMask","_pointInExtent","longitudeIn","latitudeIn","properties","poly","inside","notContains","_getDecimalIndexes","interpolatedValueAtIndexes","indexes","_getFourSurroundingIndexes","fi","fj","cj","_getFourSurroundingValues","g00","g10","g01","g11","_doInterpolation","_clampColumnIndex","_clampRowIndex","row","_isValid","ii","jj","hasValue","included","_longitudeAtX","_latitudeAtY","halfXPixel","halfYPixel","maxCol","maxRow","zs","_buildGrid","scaleFactor","lines","header","_parseASCIIGridHeader","line","items","it","floatItem","parseFloat","noDataValue","headerLines","headerItems","toUpperCase","usesCorner","cellSize","err","bandIndex","multipleFromGeoTIFF","bandIndexes","tiff","GeoTIFF","parse","image","getImage","rasters","readRasters","tiepoint","getTiePoints","fileDirectory","getFileDirectory","ModelPixelScale","xScale","yScale","GDAL_NODATA","noData","getWidth","getHeight","_arrayTo2d","array","rx","ry","VectorField","us","vs","ascU","ascV","fromASCIIGrid","_paramsFromScalarFields","gtU","gtV","fromGeoTIFF","geotiffData","bandIndexesForUV","_getFunctionFor","_applyOnField","func","numCells","_arraysTo2d","vectors","getCells","magnitudes","window","require"],"mappings":"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","file":"leaflet.canvaslayer.field.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 11);\n","/**\r\n *  Simple regular cell in a raster\r\n */\r\nexport default class Cell {\r\n    /**\r\n     * A simple cell with a numerical value\r\n     * @param {L.LatLng} center\r\n     * @param {Number|Vector} value\r\n     * @param {Number} xSize\r\n     * @param {Number} ySize\r\n     */\r\n    constructor(center, value, xSize, ySize = xSize) {\r\n        this.center = center;\r\n        this.value = value;\r\n        this.xSize = xSize;\r\n        this.ySize = ySize;\r\n    }\r\n\r\n    equals(anotherCell) {\r\n        return (\r\n            this.center.equals(anotherCell.center) &&\r\n            this._equalValues(this.value, anotherCell.value) &&\r\n            this.xSize === anotherCell.xSize &&\r\n            this.ySize === anotherCell.ySize\r\n        );\r\n    }\r\n\r\n    _equalValues(value, anotherValue) {\r\n        let type = value.constructor.name;\r\n        let answerFor = {\r\n            Number: value === anotherValue,\r\n            Vector: value.u === anotherValue.u && value.v === anotherValue.v\r\n        };\r\n        return answerFor[type];\r\n    }\r\n\r\n    /**\r\n     * Bounds for the cell\r\n     * @returns {LatLngBounds}\r\n     */\r\n    getBounds() {\r\n        let halfX = this.xSize / 2.0;\r\n        let halfY = this.ySize / 2.0;\r\n        let cLat = this.center.lat;\r\n        let cLng = this.center.lng;\r\n        let ul = L.latLng([cLat + halfY, cLng - halfX]);\r\n        let lr = L.latLng([cLat - halfY, cLng + halfX]);\r\n\r\n        return L.latLngBounds(\r\n            L.latLng(lr.lat, ul.lng),\r\n            L.latLng(ul.lat, lr.lng)\r\n        );\r\n    }\r\n}\r\n","var invariant = require('@turf/invariant');\nvar getCoord = invariant.getCoord;\nvar getCoords = invariant.getCoords;\n\n// http://en.wikipedia.org/wiki/Even%E2%80%93odd_rule\n// modified from: https://github.com/substack/point-in-polygon/blob/master/index.js\n// which was modified from http://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/pnpoly.html\n\n/**\n * Takes a {@link Point} and a {@link Polygon} or {@link MultiPolygon} and determines if the point resides inside the polygon. The polygon can\n * be convex or concave. The function accounts for holes.\n *\n * @name inside\n * @param {Feature<Point>} point input point\n * @param {Feature<Polygon|MultiPolygon>} polygon input polygon or multipolygon\n * @param {boolean} [ignoreBoundary=false] True if polygon boundary should be ignored when determining if the point is inside the polygon otherwise false.\n * @returns {boolean} `true` if the Point is inside the Polygon; `false` if the Point is not inside the Polygon\n * @example\n * var pt = turf.point([-77, 44]);\n * var poly = turf.polygon([[\n *   [-81, 41],\n *   [-81, 47],\n *   [-72, 47],\n *   [-72, 41],\n *   [-81, 41]\n * ]]);\n *\n * turf.inside(pt, poly);\n * //= true\n */\nmodule.exports = function (point, polygon, ignoreBoundary) {\n    // validation\n    if (!point) throw new Error('point is required');\n    if (!polygon) throw new Error('polygon is required');\n\n    var pt = getCoord(point);\n    var polys = getCoords(polygon);\n    var type = (polygon.geometry) ? polygon.geometry.type : polygon.type;\n    var bbox = polygon.bbox;\n\n    // Quick elimination if point is not inside bbox\n    if (bbox && inBBox(pt, bbox) === false) return false;\n\n    // normalize to multipolygon\n    if (type === 'Polygon') polys = [polys];\n\n    for (var i = 0, insidePoly = false; i < polys.length && !insidePoly; i++) {\n        // check if it is in the outer ring first\n        if (inRing(pt, polys[i][0], ignoreBoundary)) {\n            var inHole = false;\n            var k = 1;\n            // check for the point in any of the holes\n            while (k < polys[i].length && !inHole) {\n                if (inRing(pt, polys[i][k], !ignoreBoundary)) {\n                    inHole = true;\n                }\n                k++;\n            }\n            if (!inHole) insidePoly = true;\n        }\n    }\n    return insidePoly;\n};\n\n/**\n * inRing\n *\n * @private\n * @param {[number, number]} pt [x,y]\n * @param {Array<[number, number]>} ring [[x,y], [x,y],..]\n * @param {boolean} ignoreBoundary ignoreBoundary\n * @returns {boolean} inRing\n */\nfunction inRing(pt, ring, ignoreBoundary) {\n    var isInside = false;\n    if (ring[0][0] === ring[ring.length - 1][0] && ring[0][1] === ring[ring.length - 1][1]) ring = ring.slice(0, ring.length - 1);\n\n    for (var i = 0, j = ring.length - 1; i < ring.length; j = i++) {\n        var xi = ring[i][0], yi = ring[i][1];\n        var xj = ring[j][0], yj = ring[j][1];\n        var onBoundary = (pt[1] * (xi - xj) + yi * (xj - pt[0]) + yj * (pt[0] - xi) === 0) &&\n            ((xi - pt[0]) * (xj - pt[0]) <= 0) && ((yi - pt[1]) * (yj - pt[1]) <= 0);\n        if (onBoundary) return !ignoreBoundary;\n        var intersect = ((yi > pt[1]) !== (yj > pt[1])) &&\n        (pt[0] < (xj - xi) * (pt[1] - yi) / (yj - yi) + xi);\n        if (intersect) isInside = !isInside;\n    }\n    return isInside;\n}\n\n/**\n * inBBox\n *\n * @private\n * @param {[number, number]} pt point [x,y]\n * @param {[number, number, number, number]} bbox BBox [west, south, east, north]\n * @returns {boolean} true/false if point is inside BBox\n */\nfunction inBBox(pt, bbox) {\n    return bbox[0] <= pt[0] &&\n           bbox[1] <= pt[1] &&\n           bbox[2] >= pt[0] &&\n           bbox[3] >= pt[1];\n}\n","/**\n * chroma.js - JavaScript library for color conversions\n *\n * Copyright (c) 2011-2019, Gregor Aisch\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n * list of conditions and the following disclaimer.\n *\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n * this list of conditions and the following disclaimer in the documentation\n * and/or other materials provided with the distribution.\n *\n * 3. The name Gregor Aisch may not be used to endorse or promote products\n * derived from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,\n * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * -------------------------------------------------------\n *\n * chroma.js includes colors from colorbrewer2.org, which are released under\n * the following license:\n *\n * Copyright (c) 2002 Cynthia Brewer, Mark Harrower,\n * and The Pennsylvania State University.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,\n * either express or implied. See the License for the specific\n * language governing permissions and limitations under the License.\n *\n * ------------------------------------------------------\n *\n * Named colors are taken from X11 Color Names.\n * http://www.w3.org/TR/css3-color/#svg-color\n *\n * @preserve\n */\n\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define(factory) :\n    (global.chroma = factory());\n}(this, (function () { 'use strict';\n\n    var limit = function (x, min, max) {\n        if ( min === void 0 ) min=0;\n        if ( max === void 0 ) max=1;\n\n        return x < min ? min : x > max ? max : x;\n    };\n\n    var clip_rgb = function (rgb) {\n        rgb._clipped = false;\n        rgb._unclipped = rgb.slice(0);\n        for (var i=0; i<=3; i++) {\n            if (i < 3) {\n                if (rgb[i] < 0 || rgb[i] > 255) { rgb._clipped = true; }\n                rgb[i] = limit(rgb[i], 0, 255);\n            } else if (i === 3) {\n                rgb[i] = limit(rgb[i], 0, 1);\n            }\n        }\n        return rgb;\n    };\n\n    // ported from jQuery's $.type\n    var classToType = {};\n    for (var i = 0, list = ['Boolean', 'Number', 'String', 'Function', 'Array', 'Date', 'RegExp', 'Undefined', 'Null']; i < list.length; i += 1) {\n        var name = list[i];\n\n        classToType[(\"[object \" + name + \"]\")] = name.toLowerCase();\n    }\n    var type = function(obj) {\n        return classToType[Object.prototype.toString.call(obj)] || \"object\";\n    };\n\n    var unpack = function (args, keyOrder) {\n        if ( keyOrder === void 0 ) keyOrder=null;\n\n    \t// if called with more than 3 arguments, we return the arguments\n        if (args.length >= 3) { return Array.prototype.slice.call(args); }\n        // with less than 3 args we check if first arg is object\n        // and use the keyOrder string to extract and sort properties\n    \tif (type(args[0]) == 'object' && keyOrder) {\n    \t\treturn keyOrder.split('')\n    \t\t\t.filter(function (k) { return args[0][k] !== undefined; })\n    \t\t\t.map(function (k) { return args[0][k]; });\n    \t}\n    \t// otherwise we just return the first argument\n    \t// (which we suppose is an array of args)\n        return args[0];\n    };\n\n    var last = function (args) {\n        if (args.length < 2) { return null; }\n        var l = args.length-1;\n        if (type(args[l]) == 'string') { return args[l].toLowerCase(); }\n        return null;\n    };\n\n    var PI = Math.PI;\n\n    var utils = {\n    \tclip_rgb: clip_rgb,\n    \tlimit: limit,\n    \ttype: type,\n    \tunpack: unpack,\n    \tlast: last,\n    \tPI: PI,\n    \tTWOPI: PI*2,\n    \tPITHIRD: PI/3,\n    \tDEG2RAD: PI / 180,\n    \tRAD2DEG: 180 / PI\n    };\n\n    var input = {\n    \tformat: {},\n    \tautodetect: []\n    };\n\n    var last$1 = utils.last;\n    var clip_rgb$1 = utils.clip_rgb;\n    var type$1 = utils.type;\n\n\n    var Color = function Color() {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var me = this;\n        if (type$1(args[0]) === 'object' &&\n            args[0].constructor &&\n            args[0].constructor === this.constructor) {\n            // the argument is already a Color instance\n            return args[0];\n        }\n\n        // last argument could be the mode\n        var mode = last$1(args);\n        var autodetect = false;\n\n        if (!mode) {\n            autodetect = true;\n            if (!input.sorted) {\n                input.autodetect = input.autodetect.sort(function (a,b) { return b.p - a.p; });\n                input.sorted = true;\n            }\n            // auto-detect format\n            for (var i = 0, list = input.autodetect; i < list.length; i += 1) {\n                var chk = list[i];\n\n                mode = chk.test.apply(chk, args);\n                if (mode) { break; }\n            }\n        }\n\n        if (input.format[mode]) {\n            var rgb = input.format[mode].apply(null, autodetect ? args : args.slice(0,-1));\n            me._rgb = clip_rgb$1(rgb);\n        } else {\n            throw new Error('unknown format: '+args);\n        }\n\n        // add alpha channel\n        if (me._rgb.length === 3) { me._rgb.push(1); }\n    };\n\n    Color.prototype.toString = function toString () {\n        if (type$1(this.hex) == 'function') { return this.hex(); }\n        return (\"[\" + (this._rgb.join(',')) + \"]\");\n    };\n\n    var Color_1 = Color;\n\n    var chroma = function () {\n    \tvar args = [], len = arguments.length;\n    \twhile ( len-- ) args[ len ] = arguments[ len ];\n\n    \treturn new (Function.prototype.bind.apply( chroma.Color, [ null ].concat( args) ));\n    };\n\n    chroma.Color = Color_1;\n    chroma.version = '2.1.0';\n\n    var chroma_1 = chroma;\n\n    var unpack$1 = utils.unpack;\n    var max = Math.max;\n\n    var rgb2cmyk = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var ref = unpack$1(args, 'rgb');\n        var r = ref[0];\n        var g = ref[1];\n        var b = ref[2];\n        r = r / 255;\n        g = g / 255;\n        b = b / 255;\n        var k = 1 - max(r,max(g,b));\n        var f = k < 1 ? 1 / (1-k) : 0;\n        var c = (1-r-k) * f;\n        var m = (1-g-k) * f;\n        var y = (1-b-k) * f;\n        return [c,m,y,k];\n    };\n\n    var rgb2cmyk_1 = rgb2cmyk;\n\n    var unpack$2 = utils.unpack;\n\n    var cmyk2rgb = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        args = unpack$2(args, 'cmyk');\n        var c = args[0];\n        var m = args[1];\n        var y = args[2];\n        var k = args[3];\n        var alpha = args.length > 4 ? args[4] : 1;\n        if (k === 1) { return [0,0,0,alpha]; }\n        return [\n            c >= 1 ? 0 : 255 * (1-c) * (1-k), // r\n            m >= 1 ? 0 : 255 * (1-m) * (1-k), // g\n            y >= 1 ? 0 : 255 * (1-y) * (1-k), // b\n            alpha\n        ];\n    };\n\n    var cmyk2rgb_1 = cmyk2rgb;\n\n    var unpack$3 = utils.unpack;\n    var type$2 = utils.type;\n\n\n\n    Color_1.prototype.cmyk = function() {\n        return rgb2cmyk_1(this._rgb);\n    };\n\n    chroma_1.cmyk = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['cmyk']) ));\n    };\n\n    input.format.cmyk = cmyk2rgb_1;\n\n    input.autodetect.push({\n        p: 2,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            args = unpack$3(args, 'cmyk');\n            if (type$2(args) === 'array' && args.length === 4) {\n                return 'cmyk';\n            }\n        }\n    });\n\n    var unpack$4 = utils.unpack;\n    var last$2 = utils.last;\n    var rnd = function (a) { return Math.round(a*100)/100; };\n\n    /*\n     * supported arguments:\n     * - hsl2css(h,s,l)\n     * - hsl2css(h,s,l,a)\n     * - hsl2css([h,s,l], mode)\n     * - hsl2css([h,s,l,a], mode)\n     * - hsl2css({h,s,l,a}, mode)\n     */\n    var hsl2css = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var hsla = unpack$4(args, 'hsla');\n        var mode = last$2(args) || 'lsa';\n        hsla[0] = rnd(hsla[0] || 0);\n        hsla[1] = rnd(hsla[1]*100) + '%';\n        hsla[2] = rnd(hsla[2]*100) + '%';\n        if (mode === 'hsla' || (hsla.length > 3 && hsla[3]<1)) {\n            hsla[3] = hsla.length > 3 ? hsla[3] : 1;\n            mode = 'hsla';\n        } else {\n            hsla.length = 3;\n        }\n        return (mode + \"(\" + (hsla.join(',')) + \")\");\n    };\n\n    var hsl2css_1 = hsl2css;\n\n    var unpack$5 = utils.unpack;\n\n    /*\n     * supported arguments:\n     * - rgb2hsl(r,g,b)\n     * - rgb2hsl(r,g,b,a)\n     * - rgb2hsl([r,g,b])\n     * - rgb2hsl([r,g,b,a])\n     * - rgb2hsl({r,g,b,a})\n     */\n    var rgb2hsl = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        args = unpack$5(args, 'rgba');\n        var r = args[0];\n        var g = args[1];\n        var b = args[2];\n\n        r /= 255;\n        g /= 255;\n        b /= 255;\n\n        var min = Math.min(r, g, b);\n        var max = Math.max(r, g, b);\n\n        var l = (max + min) / 2;\n        var s, h;\n\n        if (max === min){\n            s = 0;\n            h = Number.NaN;\n        } else {\n            s = l < 0.5 ? (max - min) / (max + min) : (max - min) / (2 - max - min);\n        }\n\n        if (r == max) { h = (g - b) / (max - min); }\n        else if (g == max) { h = 2 + (b - r) / (max - min); }\n        else if (b == max) { h = 4 + (r - g) / (max - min); }\n\n        h *= 60;\n        if (h < 0) { h += 360; }\n        if (args.length>3 && args[3]!==undefined) { return [h,s,l,args[3]]; }\n        return [h,s,l];\n    };\n\n    var rgb2hsl_1 = rgb2hsl;\n\n    var unpack$6 = utils.unpack;\n    var last$3 = utils.last;\n\n\n    var round = Math.round;\n\n    /*\n     * supported arguments:\n     * - rgb2css(r,g,b)\n     * - rgb2css(r,g,b,a)\n     * - rgb2css([r,g,b], mode)\n     * - rgb2css([r,g,b,a], mode)\n     * - rgb2css({r,g,b,a}, mode)\n     */\n    var rgb2css = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var rgba = unpack$6(args, 'rgba');\n        var mode = last$3(args) || 'rgb';\n        if (mode.substr(0,3) == 'hsl') {\n            return hsl2css_1(rgb2hsl_1(rgba), mode);\n        }\n        rgba[0] = round(rgba[0]);\n        rgba[1] = round(rgba[1]);\n        rgba[2] = round(rgba[2]);\n        if (mode === 'rgba' || (rgba.length > 3 && rgba[3]<1)) {\n            rgba[3] = rgba.length > 3 ? rgba[3] : 1;\n            mode = 'rgba';\n        }\n        return (mode + \"(\" + (rgba.slice(0,mode==='rgb'?3:4).join(',')) + \")\");\n    };\n\n    var rgb2css_1 = rgb2css;\n\n    var unpack$7 = utils.unpack;\n    var round$1 = Math.round;\n\n    var hsl2rgb = function () {\n        var assign;\n\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n        args = unpack$7(args, 'hsl');\n        var h = args[0];\n        var s = args[1];\n        var l = args[2];\n        var r,g,b;\n        if (s === 0) {\n            r = g = b = l*255;\n        } else {\n            var t3 = [0,0,0];\n            var c = [0,0,0];\n            var t2 = l < 0.5 ? l * (1+s) : l+s-l*s;\n            var t1 = 2 * l - t2;\n            var h_ = h / 360;\n            t3[0] = h_ + 1/3;\n            t3[1] = h_;\n            t3[2] = h_ - 1/3;\n            for (var i=0; i<3; i++) {\n                if (t3[i] < 0) { t3[i] += 1; }\n                if (t3[i] > 1) { t3[i] -= 1; }\n                if (6 * t3[i] < 1)\n                    { c[i] = t1 + (t2 - t1) * 6 * t3[i]; }\n                else if (2 * t3[i] < 1)\n                    { c[i] = t2; }\n                else if (3 * t3[i] < 2)\n                    { c[i] = t1 + (t2 - t1) * ((2 / 3) - t3[i]) * 6; }\n                else\n                    { c[i] = t1; }\n            }\n            (assign = [round$1(c[0]*255),round$1(c[1]*255),round$1(c[2]*255)], r = assign[0], g = assign[1], b = assign[2]);\n        }\n        if (args.length > 3) {\n            // keep alpha channel\n            return [r,g,b,args[3]];\n        }\n        return [r,g,b,1];\n    };\n\n    var hsl2rgb_1 = hsl2rgb;\n\n    var RE_RGB = /^rgb\\(\\s*(-?\\d+),\\s*(-?\\d+)\\s*,\\s*(-?\\d+)\\s*\\)$/;\n    var RE_RGBA = /^rgba\\(\\s*(-?\\d+),\\s*(-?\\d+)\\s*,\\s*(-?\\d+)\\s*,\\s*([01]|[01]?\\.\\d+)\\)$/;\n    var RE_RGB_PCT = /^rgb\\(\\s*(-?\\d+(?:\\.\\d+)?)%,\\s*(-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(-?\\d+(?:\\.\\d+)?)%\\s*\\)$/;\n    var RE_RGBA_PCT = /^rgba\\(\\s*(-?\\d+(?:\\.\\d+)?)%,\\s*(-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(-?\\d+(?:\\.\\d+)?)%\\s*,\\s*([01]|[01]?\\.\\d+)\\)$/;\n    var RE_HSL = /^hsl\\(\\s*(-?\\d+(?:\\.\\d+)?),\\s*(-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(-?\\d+(?:\\.\\d+)?)%\\s*\\)$/;\n    var RE_HSLA = /^hsla\\(\\s*(-?\\d+(?:\\.\\d+)?),\\s*(-?\\d+(?:\\.\\d+)?)%\\s*,\\s*(-?\\d+(?:\\.\\d+)?)%\\s*,\\s*([01]|[01]?\\.\\d+)\\)$/;\n\n    var round$2 = Math.round;\n\n    var css2rgb = function (css) {\n        css = css.toLowerCase().trim();\n        var m;\n\n        if (input.format.named) {\n            try {\n                return input.format.named(css);\n            } catch (e) {\n                // eslint-disable-next-line\n            }\n        }\n\n        // rgb(250,20,0)\n        if ((m = css.match(RE_RGB))) {\n            var rgb = m.slice(1,4);\n            for (var i=0; i<3; i++) {\n                rgb[i] = +rgb[i];\n            }\n            rgb[3] = 1;  // default alpha\n            return rgb;\n        }\n\n        // rgba(250,20,0,0.4)\n        if ((m = css.match(RE_RGBA))) {\n            var rgb$1 = m.slice(1,5);\n            for (var i$1=0; i$1<4; i$1++) {\n                rgb$1[i$1] = +rgb$1[i$1];\n            }\n            return rgb$1;\n        }\n\n        // rgb(100%,0%,0%)\n        if ((m = css.match(RE_RGB_PCT))) {\n            var rgb$2 = m.slice(1,4);\n            for (var i$2=0; i$2<3; i$2++) {\n                rgb$2[i$2] = round$2(rgb$2[i$2] * 2.55);\n            }\n            rgb$2[3] = 1;  // default alpha\n            return rgb$2;\n        }\n\n        // rgba(100%,0%,0%,0.4)\n        if ((m = css.match(RE_RGBA_PCT))) {\n            var rgb$3 = m.slice(1,5);\n            for (var i$3=0; i$3<3; i$3++) {\n                rgb$3[i$3] = round$2(rgb$3[i$3] * 2.55);\n            }\n            rgb$3[3] = +rgb$3[3];\n            return rgb$3;\n        }\n\n        // hsl(0,100%,50%)\n        if ((m = css.match(RE_HSL))) {\n            var hsl = m.slice(1,4);\n            hsl[1] *= 0.01;\n            hsl[2] *= 0.01;\n            var rgb$4 = hsl2rgb_1(hsl);\n            rgb$4[3] = 1;\n            return rgb$4;\n        }\n\n        // hsla(0,100%,50%,0.5)\n        if ((m = css.match(RE_HSLA))) {\n            var hsl$1 = m.slice(1,4);\n            hsl$1[1] *= 0.01;\n            hsl$1[2] *= 0.01;\n            var rgb$5 = hsl2rgb_1(hsl$1);\n            rgb$5[3] = +m[4];  // default alpha = 1\n            return rgb$5;\n        }\n    };\n\n    css2rgb.test = function (s) {\n        return RE_RGB.test(s) ||\n            RE_RGBA.test(s) ||\n            RE_RGB_PCT.test(s) ||\n            RE_RGBA_PCT.test(s) ||\n            RE_HSL.test(s) ||\n            RE_HSLA.test(s);\n    };\n\n    var css2rgb_1 = css2rgb;\n\n    var type$3 = utils.type;\n\n\n\n\n    Color_1.prototype.css = function(mode) {\n        return rgb2css_1(this._rgb, mode);\n    };\n\n    chroma_1.css = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['css']) ));\n    };\n\n    input.format.css = css2rgb_1;\n\n    input.autodetect.push({\n        p: 5,\n        test: function (h) {\n            var rest = [], len = arguments.length - 1;\n            while ( len-- > 0 ) rest[ len ] = arguments[ len + 1 ];\n\n            if (!rest.length && type$3(h) === 'string' && css2rgb_1.test(h)) {\n                return 'css';\n            }\n        }\n    });\n\n    var unpack$8 = utils.unpack;\n\n    input.format.gl = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var rgb = unpack$8(args, 'rgba');\n        rgb[0] *= 255;\n        rgb[1] *= 255;\n        rgb[2] *= 255;\n        return rgb;\n    };\n\n    chroma_1.gl = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['gl']) ));\n    };\n\n    Color_1.prototype.gl = function() {\n        var rgb = this._rgb;\n        return [rgb[0]/255, rgb[1]/255, rgb[2]/255, rgb[3]];\n    };\n\n    var unpack$9 = utils.unpack;\n\n    var rgb2hcg = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var ref = unpack$9(args, 'rgb');\n        var r = ref[0];\n        var g = ref[1];\n        var b = ref[2];\n        var min = Math.min(r, g, b);\n        var max = Math.max(r, g, b);\n        var delta = max - min;\n        var c = delta * 100 / 255;\n        var _g = min / (255 - delta) * 100;\n        var h;\n        if (delta === 0) {\n            h = Number.NaN;\n        } else {\n            if (r === max) { h = (g - b) / delta; }\n            if (g === max) { h = 2+(b - r) / delta; }\n            if (b === max) { h = 4+(r - g) / delta; }\n            h *= 60;\n            if (h < 0) { h += 360; }\n        }\n        return [h, c, _g];\n    };\n\n    var rgb2hcg_1 = rgb2hcg;\n\n    var unpack$a = utils.unpack;\n    var floor = Math.floor;\n\n    /*\n     * this is basically just HSV with some minor tweaks\n     *\n     * hue.. [0..360]\n     * chroma .. [0..1]\n     * grayness .. [0..1]\n     */\n\n    var hcg2rgb = function () {\n        var assign, assign$1, assign$2, assign$3, assign$4, assign$5;\n\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n        args = unpack$a(args, 'hcg');\n        var h = args[0];\n        var c = args[1];\n        var _g = args[2];\n        var r,g,b;\n        _g = _g * 255;\n        var _c = c * 255;\n        if (c === 0) {\n            r = g = b = _g;\n        } else {\n            if (h === 360) { h = 0; }\n            if (h > 360) { h -= 360; }\n            if (h < 0) { h += 360; }\n            h /= 60;\n            var i = floor(h);\n            var f = h - i;\n            var p = _g * (1 - c);\n            var q = p + _c * (1 - f);\n            var t = p + _c * f;\n            var v = p + _c;\n            switch (i) {\n                case 0: (assign = [v, t, p], r = assign[0], g = assign[1], b = assign[2]); break\n                case 1: (assign$1 = [q, v, p], r = assign$1[0], g = assign$1[1], b = assign$1[2]); break\n                case 2: (assign$2 = [p, v, t], r = assign$2[0], g = assign$2[1], b = assign$2[2]); break\n                case 3: (assign$3 = [p, q, v], r = assign$3[0], g = assign$3[1], b = assign$3[2]); break\n                case 4: (assign$4 = [t, p, v], r = assign$4[0], g = assign$4[1], b = assign$4[2]); break\n                case 5: (assign$5 = [v, p, q], r = assign$5[0], g = assign$5[1], b = assign$5[2]); break\n            }\n        }\n        return [r, g, b, args.length > 3 ? args[3] : 1];\n    };\n\n    var hcg2rgb_1 = hcg2rgb;\n\n    var unpack$b = utils.unpack;\n    var type$4 = utils.type;\n\n\n\n\n\n\n    Color_1.prototype.hcg = function() {\n        return rgb2hcg_1(this._rgb);\n    };\n\n    chroma_1.hcg = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['hcg']) ));\n    };\n\n    input.format.hcg = hcg2rgb_1;\n\n    input.autodetect.push({\n        p: 1,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            args = unpack$b(args, 'hcg');\n            if (type$4(args) === 'array' && args.length === 3) {\n                return 'hcg';\n            }\n        }\n    });\n\n    var unpack$c = utils.unpack;\n    var last$4 = utils.last;\n    var round$3 = Math.round;\n\n    var rgb2hex = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var ref = unpack$c(args, 'rgba');\n        var r = ref[0];\n        var g = ref[1];\n        var b = ref[2];\n        var a = ref[3];\n        var mode = last$4(args) || 'auto';\n        if (a === undefined) { a = 1; }\n        if (mode === 'auto') {\n            mode = a < 1 ? 'rgba' : 'rgb';\n        }\n        r = round$3(r);\n        g = round$3(g);\n        b = round$3(b);\n        var u = r << 16 | g << 8 | b;\n        var str = \"000000\" + u.toString(16); //#.toUpperCase();\n        str = str.substr(str.length - 6);\n        var hxa = '0' + round$3(a * 255).toString(16);\n        hxa = hxa.substr(hxa.length - 2);\n        switch (mode.toLowerCase()) {\n            case 'rgba': return (\"#\" + str + hxa);\n            case 'argb': return (\"#\" + hxa + str);\n            default: return (\"#\" + str);\n        }\n    };\n\n    var rgb2hex_1 = rgb2hex;\n\n    var RE_HEX = /^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/;\n    var RE_HEXA = /^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/;\n\n    var hex2rgb = function (hex) {\n        if (hex.match(RE_HEX)) {\n            // remove optional leading #\n            if (hex.length === 4 || hex.length === 7) {\n                hex = hex.substr(1);\n            }\n            // expand short-notation to full six-digit\n            if (hex.length === 3) {\n                hex = hex.split('');\n                hex = hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2];\n            }\n            var u = parseInt(hex, 16);\n            var r = u >> 16;\n            var g = u >> 8 & 0xFF;\n            var b = u & 0xFF;\n            return [r,g,b,1];\n        }\n\n        // match rgba hex format, eg #FF000077\n        if (hex.match(RE_HEXA)) {\n            if (hex.length === 5 || hex.length === 9) {\n                // remove optional leading #\n                hex = hex.substr(1);\n            }\n            // expand short-notation to full eight-digit\n            if (hex.length === 4) {\n                hex = hex.split('');\n                hex = hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2]+hex[3]+hex[3];\n            }\n            var u$1 = parseInt(hex, 16);\n            var r$1 = u$1 >> 24 & 0xFF;\n            var g$1 = u$1 >> 16 & 0xFF;\n            var b$1 = u$1 >> 8 & 0xFF;\n            var a = Math.round((u$1 & 0xFF) / 0xFF * 100) / 100;\n            return [r$1,g$1,b$1,a];\n        }\n\n        // we used to check for css colors here\n        // if _input.css? and rgb = _input.css hex\n        //     return rgb\n\n        throw new Error((\"unknown hex color: \" + hex));\n    };\n\n    var hex2rgb_1 = hex2rgb;\n\n    var type$5 = utils.type;\n\n\n\n\n    Color_1.prototype.hex = function(mode) {\n        return rgb2hex_1(this._rgb, mode);\n    };\n\n    chroma_1.hex = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['hex']) ));\n    };\n\n    input.format.hex = hex2rgb_1;\n    input.autodetect.push({\n        p: 4,\n        test: function (h) {\n            var rest = [], len = arguments.length - 1;\n            while ( len-- > 0 ) rest[ len ] = arguments[ len + 1 ];\n\n            if (!rest.length && type$5(h) === 'string' && [3,4,5,6,7,8,9].indexOf(h.length) >= 0) {\n                return 'hex';\n            }\n        }\n    });\n\n    var unpack$d = utils.unpack;\n    var TWOPI = utils.TWOPI;\n    var min = Math.min;\n    var sqrt = Math.sqrt;\n    var acos = Math.acos;\n\n    var rgb2hsi = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        /*\n        borrowed from here:\n        http://hummer.stanford.edu/museinfo/doc/examples/humdrum/keyscape2/rgb2hsi.cpp\n        */\n        var ref = unpack$d(args, 'rgb');\n        var r = ref[0];\n        var g = ref[1];\n        var b = ref[2];\n        r /= 255;\n        g /= 255;\n        b /= 255;\n        var h;\n        var min_ = min(r,g,b);\n        var i = (r+g+b) / 3;\n        var s = i > 0 ? 1 - min_/i : 0;\n        if (s === 0) {\n            h = NaN;\n        } else {\n            h = ((r-g)+(r-b)) / 2;\n            h /= sqrt((r-g)*(r-g) + (r-b)*(g-b));\n            h = acos(h);\n            if (b > g) {\n                h = TWOPI - h;\n            }\n            h /= TWOPI;\n        }\n        return [h*360,s,i];\n    };\n\n    var rgb2hsi_1 = rgb2hsi;\n\n    var unpack$e = utils.unpack;\n    var limit$1 = utils.limit;\n    var TWOPI$1 = utils.TWOPI;\n    var PITHIRD = utils.PITHIRD;\n    var cos = Math.cos;\n\n    /*\n     * hue [0..360]\n     * saturation [0..1]\n     * intensity [0..1]\n     */\n    var hsi2rgb = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        /*\n        borrowed from here:\n        http://hummer.stanford.edu/museinfo/doc/examples/humdrum/keyscape2/hsi2rgb.cpp\n        */\n        args = unpack$e(args, 'hsi');\n        var h = args[0];\n        var s = args[1];\n        var i = args[2];\n        var r,g,b;\n\n        if (isNaN(h)) { h = 0; }\n        if (isNaN(s)) { s = 0; }\n        // normalize hue\n        if (h > 360) { h -= 360; }\n        if (h < 0) { h += 360; }\n        h /= 360;\n        if (h < 1/3) {\n            b = (1-s)/3;\n            r = (1+s*cos(TWOPI$1*h)/cos(PITHIRD-TWOPI$1*h))/3;\n            g = 1 - (b+r);\n        } else if (h < 2/3) {\n            h -= 1/3;\n            r = (1-s)/3;\n            g = (1+s*cos(TWOPI$1*h)/cos(PITHIRD-TWOPI$1*h))/3;\n            b = 1 - (r+g);\n        } else {\n            h -= 2/3;\n            g = (1-s)/3;\n            b = (1+s*cos(TWOPI$1*h)/cos(PITHIRD-TWOPI$1*h))/3;\n            r = 1 - (g+b);\n        }\n        r = limit$1(i*r*3);\n        g = limit$1(i*g*3);\n        b = limit$1(i*b*3);\n        return [r*255, g*255, b*255, args.length > 3 ? args[3] : 1];\n    };\n\n    var hsi2rgb_1 = hsi2rgb;\n\n    var unpack$f = utils.unpack;\n    var type$6 = utils.type;\n\n\n\n\n\n\n    Color_1.prototype.hsi = function() {\n        return rgb2hsi_1(this._rgb);\n    };\n\n    chroma_1.hsi = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['hsi']) ));\n    };\n\n    input.format.hsi = hsi2rgb_1;\n\n    input.autodetect.push({\n        p: 2,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            args = unpack$f(args, 'hsi');\n            if (type$6(args) === 'array' && args.length === 3) {\n                return 'hsi';\n            }\n        }\n    });\n\n    var unpack$g = utils.unpack;\n    var type$7 = utils.type;\n\n\n\n\n\n\n    Color_1.prototype.hsl = function() {\n        return rgb2hsl_1(this._rgb);\n    };\n\n    chroma_1.hsl = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['hsl']) ));\n    };\n\n    input.format.hsl = hsl2rgb_1;\n\n    input.autodetect.push({\n        p: 2,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            args = unpack$g(args, 'hsl');\n            if (type$7(args) === 'array' && args.length === 3) {\n                return 'hsl';\n            }\n        }\n    });\n\n    var unpack$h = utils.unpack;\n    var min$1 = Math.min;\n    var max$1 = Math.max;\n\n    /*\n     * supported arguments:\n     * - rgb2hsv(r,g,b)\n     * - rgb2hsv([r,g,b])\n     * - rgb2hsv({r,g,b})\n     */\n    var rgb2hsl$1 = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        args = unpack$h(args, 'rgb');\n        var r = args[0];\n        var g = args[1];\n        var b = args[2];\n        var min_ = min$1(r, g, b);\n        var max_ = max$1(r, g, b);\n        var delta = max_ - min_;\n        var h,s,v;\n        v = max_ / 255.0;\n        if (max_ === 0) {\n            h = Number.NaN;\n            s = 0;\n        } else {\n            s = delta / max_;\n            if (r === max_) { h = (g - b) / delta; }\n            if (g === max_) { h = 2+(b - r) / delta; }\n            if (b === max_) { h = 4+(r - g) / delta; }\n            h *= 60;\n            if (h < 0) { h += 360; }\n        }\n        return [h, s, v]\n    };\n\n    var rgb2hsv = rgb2hsl$1;\n\n    var unpack$i = utils.unpack;\n    var floor$1 = Math.floor;\n\n    var hsv2rgb = function () {\n        var assign, assign$1, assign$2, assign$3, assign$4, assign$5;\n\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n        args = unpack$i(args, 'hsv');\n        var h = args[0];\n        var s = args[1];\n        var v = args[2];\n        var r,g,b;\n        v *= 255;\n        if (s === 0) {\n            r = g = b = v;\n        } else {\n            if (h === 360) { h = 0; }\n            if (h > 360) { h -= 360; }\n            if (h < 0) { h += 360; }\n            h /= 60;\n\n            var i = floor$1(h);\n            var f = h - i;\n            var p = v * (1 - s);\n            var q = v * (1 - s * f);\n            var t = v * (1 - s * (1 - f));\n\n            switch (i) {\n                case 0: (assign = [v, t, p], r = assign[0], g = assign[1], b = assign[2]); break\n                case 1: (assign$1 = [q, v, p], r = assign$1[0], g = assign$1[1], b = assign$1[2]); break\n                case 2: (assign$2 = [p, v, t], r = assign$2[0], g = assign$2[1], b = assign$2[2]); break\n                case 3: (assign$3 = [p, q, v], r = assign$3[0], g = assign$3[1], b = assign$3[2]); break\n                case 4: (assign$4 = [t, p, v], r = assign$4[0], g = assign$4[1], b = assign$4[2]); break\n                case 5: (assign$5 = [v, p, q], r = assign$5[0], g = assign$5[1], b = assign$5[2]); break\n            }\n        }\n        return [r,g,b,args.length > 3?args[3]:1];\n    };\n\n    var hsv2rgb_1 = hsv2rgb;\n\n    var unpack$j = utils.unpack;\n    var type$8 = utils.type;\n\n\n\n\n\n\n    Color_1.prototype.hsv = function() {\n        return rgb2hsv(this._rgb);\n    };\n\n    chroma_1.hsv = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['hsv']) ));\n    };\n\n    input.format.hsv = hsv2rgb_1;\n\n    input.autodetect.push({\n        p: 2,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            args = unpack$j(args, 'hsv');\n            if (type$8(args) === 'array' && args.length === 3) {\n                return 'hsv';\n            }\n        }\n    });\n\n    var labConstants = {\n        // Corresponds roughly to RGB brighter/darker\n        Kn: 18,\n\n        // D65 standard referent\n        Xn: 0.950470,\n        Yn: 1,\n        Zn: 1.088830,\n\n        t0: 0.137931034,  // 4 / 29\n        t1: 0.206896552,  // 6 / 29\n        t2: 0.12841855,   // 3 * t1 * t1\n        t3: 0.008856452,  // t1 * t1 * t1\n    };\n\n    var unpack$k = utils.unpack;\n    var pow = Math.pow;\n\n    var rgb2lab = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var ref = unpack$k(args, 'rgb');\n        var r = ref[0];\n        var g = ref[1];\n        var b = ref[2];\n        var ref$1 = rgb2xyz(r,g,b);\n        var x = ref$1[0];\n        var y = ref$1[1];\n        var z = ref$1[2];\n        var l = 116 * y - 16;\n        return [l < 0 ? 0 : l, 500 * (x - y), 200 * (y - z)];\n    };\n\n    var rgb_xyz = function (r) {\n        if ((r /= 255) <= 0.04045) { return r / 12.92; }\n        return pow((r + 0.055) / 1.055, 2.4);\n    };\n\n    var xyz_lab = function (t) {\n        if (t > labConstants.t3) { return pow(t, 1 / 3); }\n        return t / labConstants.t2 + labConstants.t0;\n    };\n\n    var rgb2xyz = function (r,g,b) {\n        r = rgb_xyz(r);\n        g = rgb_xyz(g);\n        b = rgb_xyz(b);\n        var x = xyz_lab((0.4124564 * r + 0.3575761 * g + 0.1804375 * b) / labConstants.Xn);\n        var y = xyz_lab((0.2126729 * r + 0.7151522 * g + 0.0721750 * b) / labConstants.Yn);\n        var z = xyz_lab((0.0193339 * r + 0.1191920 * g + 0.9503041 * b) / labConstants.Zn);\n        return [x,y,z];\n    };\n\n    var rgb2lab_1 = rgb2lab;\n\n    var unpack$l = utils.unpack;\n    var pow$1 = Math.pow;\n\n    /*\n     * L* [0..100]\n     * a [-100..100]\n     * b [-100..100]\n     */\n    var lab2rgb = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        args = unpack$l(args, 'lab');\n        var l = args[0];\n        var a = args[1];\n        var b = args[2];\n        var x,y,z, r,g,b_;\n\n        y = (l + 16) / 116;\n        x = isNaN(a) ? y : y + a / 500;\n        z = isNaN(b) ? y : y - b / 200;\n\n        y = labConstants.Yn * lab_xyz(y);\n        x = labConstants.Xn * lab_xyz(x);\n        z = labConstants.Zn * lab_xyz(z);\n\n        r = xyz_rgb(3.2404542 * x - 1.5371385 * y - 0.4985314 * z);  // D65 -> sRGB\n        g = xyz_rgb(-0.9692660 * x + 1.8760108 * y + 0.0415560 * z);\n        b_ = xyz_rgb(0.0556434 * x - 0.2040259 * y + 1.0572252 * z);\n\n        return [r,g,b_,args.length > 3 ? args[3] : 1];\n    };\n\n    var xyz_rgb = function (r) {\n        return 255 * (r <= 0.00304 ? 12.92 * r : 1.055 * pow$1(r, 1 / 2.4) - 0.055)\n    };\n\n    var lab_xyz = function (t) {\n        return t > labConstants.t1 ? t * t * t : labConstants.t2 * (t - labConstants.t0)\n    };\n\n    var lab2rgb_1 = lab2rgb;\n\n    var unpack$m = utils.unpack;\n    var type$9 = utils.type;\n\n\n\n\n\n\n    Color_1.prototype.lab = function() {\n        return rgb2lab_1(this._rgb);\n    };\n\n    chroma_1.lab = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['lab']) ));\n    };\n\n    input.format.lab = lab2rgb_1;\n\n    input.autodetect.push({\n        p: 2,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            args = unpack$m(args, 'lab');\n            if (type$9(args) === 'array' && args.length === 3) {\n                return 'lab';\n            }\n        }\n    });\n\n    var unpack$n = utils.unpack;\n    var RAD2DEG = utils.RAD2DEG;\n    var sqrt$1 = Math.sqrt;\n    var atan2 = Math.atan2;\n    var round$4 = Math.round;\n\n    var lab2lch = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var ref = unpack$n(args, 'lab');\n        var l = ref[0];\n        var a = ref[1];\n        var b = ref[2];\n        var c = sqrt$1(a * a + b * b);\n        var h = (atan2(b, a) * RAD2DEG + 360) % 360;\n        if (round$4(c*10000) === 0) { h = Number.NaN; }\n        return [l, c, h];\n    };\n\n    var lab2lch_1 = lab2lch;\n\n    var unpack$o = utils.unpack;\n\n\n\n    var rgb2lch = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var ref = unpack$o(args, 'rgb');\n        var r = ref[0];\n        var g = ref[1];\n        var b = ref[2];\n        var ref$1 = rgb2lab_1(r,g,b);\n        var l = ref$1[0];\n        var a = ref$1[1];\n        var b_ = ref$1[2];\n        return lab2lch_1(l,a,b_);\n    };\n\n    var rgb2lch_1 = rgb2lch;\n\n    var unpack$p = utils.unpack;\n    var DEG2RAD = utils.DEG2RAD;\n    var sin = Math.sin;\n    var cos$1 = Math.cos;\n\n    var lch2lab = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        /*\n        Convert from a qualitative parameter h and a quantitative parameter l to a 24-bit pixel.\n        These formulas were invented by David Dalrymple to obtain maximum contrast without going\n        out of gamut if the parameters are in the range 0-1.\n\n        A saturation multiplier was added by Gregor Aisch\n        */\n        var ref = unpack$p(args, 'lch');\n        var l = ref[0];\n        var c = ref[1];\n        var h = ref[2];\n        if (isNaN(h)) { h = 0; }\n        h = h * DEG2RAD;\n        return [l, cos$1(h) * c, sin(h) * c]\n    };\n\n    var lch2lab_1 = lch2lab;\n\n    var unpack$q = utils.unpack;\n\n\n\n    var lch2rgb = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        args = unpack$q(args, 'lch');\n        var l = args[0];\n        var c = args[1];\n        var h = args[2];\n        var ref = lch2lab_1 (l,c,h);\n        var L = ref[0];\n        var a = ref[1];\n        var b_ = ref[2];\n        var ref$1 = lab2rgb_1 (L,a,b_);\n        var r = ref$1[0];\n        var g = ref$1[1];\n        var b = ref$1[2];\n        return [r, g, b, args.length > 3 ? args[3] : 1];\n    };\n\n    var lch2rgb_1 = lch2rgb;\n\n    var unpack$r = utils.unpack;\n\n\n    var hcl2rgb = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var hcl = unpack$r(args, 'hcl').reverse();\n        return lch2rgb_1.apply(void 0, hcl);\n    };\n\n    var hcl2rgb_1 = hcl2rgb;\n\n    var unpack$s = utils.unpack;\n    var type$a = utils.type;\n\n\n\n\n\n\n    Color_1.prototype.lch = function() { return rgb2lch_1(this._rgb); };\n    Color_1.prototype.hcl = function() { return rgb2lch_1(this._rgb).reverse(); };\n\n    chroma_1.lch = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['lch']) ));\n    };\n    chroma_1.hcl = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['hcl']) ));\n    };\n\n    input.format.lch = lch2rgb_1;\n    input.format.hcl = hcl2rgb_1;\n\n    ['lch','hcl'].forEach(function (m) { return input.autodetect.push({\n        p: 2,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            args = unpack$s(args, m);\n            if (type$a(args) === 'array' && args.length === 3) {\n                return m;\n            }\n        }\n    }); });\n\n    /**\n    \tX11 color names\n\n    \thttp://www.w3.org/TR/css3-color/#svg-color\n    */\n\n    var w3cx11 = {\n        aliceblue: '#f0f8ff',\n        antiquewhite: '#faebd7',\n        aqua: '#00ffff',\n        aquamarine: '#7fffd4',\n        azure: '#f0ffff',\n        beige: '#f5f5dc',\n        bisque: '#ffe4c4',\n        black: '#000000',\n        blanchedalmond: '#ffebcd',\n        blue: '#0000ff',\n        blueviolet: '#8a2be2',\n        brown: '#a52a2a',\n        burlywood: '#deb887',\n        cadetblue: '#5f9ea0',\n        chartreuse: '#7fff00',\n        chocolate: '#d2691e',\n        coral: '#ff7f50',\n        cornflower: '#6495ed',\n        cornflowerblue: '#6495ed',\n        cornsilk: '#fff8dc',\n        crimson: '#dc143c',\n        cyan: '#00ffff',\n        darkblue: '#00008b',\n        darkcyan: '#008b8b',\n        darkgoldenrod: '#b8860b',\n        darkgray: '#a9a9a9',\n        darkgreen: '#006400',\n        darkgrey: '#a9a9a9',\n        darkkhaki: '#bdb76b',\n        darkmagenta: '#8b008b',\n        darkolivegreen: '#556b2f',\n        darkorange: '#ff8c00',\n        darkorchid: '#9932cc',\n        darkred: '#8b0000',\n        darksalmon: '#e9967a',\n        darkseagreen: '#8fbc8f',\n        darkslateblue: '#483d8b',\n        darkslategray: '#2f4f4f',\n        darkslategrey: '#2f4f4f',\n        darkturquoise: '#00ced1',\n        darkviolet: '#9400d3',\n        deeppink: '#ff1493',\n        deepskyblue: '#00bfff',\n        dimgray: '#696969',\n        dimgrey: '#696969',\n        dodgerblue: '#1e90ff',\n        firebrick: '#b22222',\n        floralwhite: '#fffaf0',\n        forestgreen: '#228b22',\n        fuchsia: '#ff00ff',\n        gainsboro: '#dcdcdc',\n        ghostwhite: '#f8f8ff',\n        gold: '#ffd700',\n        goldenrod: '#daa520',\n        gray: '#808080',\n        green: '#008000',\n        greenyellow: '#adff2f',\n        grey: '#808080',\n        honeydew: '#f0fff0',\n        hotpink: '#ff69b4',\n        indianred: '#cd5c5c',\n        indigo: '#4b0082',\n        ivory: '#fffff0',\n        khaki: '#f0e68c',\n        laserlemon: '#ffff54',\n        lavender: '#e6e6fa',\n        lavenderblush: '#fff0f5',\n        lawngreen: '#7cfc00',\n        lemonchiffon: '#fffacd',\n        lightblue: '#add8e6',\n        lightcoral: '#f08080',\n        lightcyan: '#e0ffff',\n        lightgoldenrod: '#fafad2',\n        lightgoldenrodyellow: '#fafad2',\n        lightgray: '#d3d3d3',\n        lightgreen: '#90ee90',\n        lightgrey: '#d3d3d3',\n        lightpink: '#ffb6c1',\n        lightsalmon: '#ffa07a',\n        lightseagreen: '#20b2aa',\n        lightskyblue: '#87cefa',\n        lightslategray: '#778899',\n        lightslategrey: '#778899',\n        lightsteelblue: '#b0c4de',\n        lightyellow: '#ffffe0',\n        lime: '#00ff00',\n        limegreen: '#32cd32',\n        linen: '#faf0e6',\n        magenta: '#ff00ff',\n        maroon: '#800000',\n        maroon2: '#7f0000',\n        maroon3: '#b03060',\n        mediumaquamarine: '#66cdaa',\n        mediumblue: '#0000cd',\n        mediumorchid: '#ba55d3',\n        mediumpurple: '#9370db',\n        mediumseagreen: '#3cb371',\n        mediumslateblue: '#7b68ee',\n        mediumspringgreen: '#00fa9a',\n        mediumturquoise: '#48d1cc',\n        mediumvioletred: '#c71585',\n        midnightblue: '#191970',\n        mintcream: '#f5fffa',\n        mistyrose: '#ffe4e1',\n        moccasin: '#ffe4b5',\n        navajowhite: '#ffdead',\n        navy: '#000080',\n        oldlace: '#fdf5e6',\n        olive: '#808000',\n        olivedrab: '#6b8e23',\n        orange: '#ffa500',\n        orangered: '#ff4500',\n        orchid: '#da70d6',\n        palegoldenrod: '#eee8aa',\n        palegreen: '#98fb98',\n        paleturquoise: '#afeeee',\n        palevioletred: '#db7093',\n        papayawhip: '#ffefd5',\n        peachpuff: '#ffdab9',\n        peru: '#cd853f',\n        pink: '#ffc0cb',\n        plum: '#dda0dd',\n        powderblue: '#b0e0e6',\n        purple: '#800080',\n        purple2: '#7f007f',\n        purple3: '#a020f0',\n        rebeccapurple: '#663399',\n        red: '#ff0000',\n        rosybrown: '#bc8f8f',\n        royalblue: '#4169e1',\n        saddlebrown: '#8b4513',\n        salmon: '#fa8072',\n        sandybrown: '#f4a460',\n        seagreen: '#2e8b57',\n        seashell: '#fff5ee',\n        sienna: '#a0522d',\n        silver: '#c0c0c0',\n        skyblue: '#87ceeb',\n        slateblue: '#6a5acd',\n        slategray: '#708090',\n        slategrey: '#708090',\n        snow: '#fffafa',\n        springgreen: '#00ff7f',\n        steelblue: '#4682b4',\n        tan: '#d2b48c',\n        teal: '#008080',\n        thistle: '#d8bfd8',\n        tomato: '#ff6347',\n        turquoise: '#40e0d0',\n        violet: '#ee82ee',\n        wheat: '#f5deb3',\n        white: '#ffffff',\n        whitesmoke: '#f5f5f5',\n        yellow: '#ffff00',\n        yellowgreen: '#9acd32'\n    };\n\n    var w3cx11_1 = w3cx11;\n\n    var type$b = utils.type;\n\n\n\n\n\n    Color_1.prototype.name = function() {\n        var hex = rgb2hex_1(this._rgb, 'rgb');\n        for (var i = 0, list = Object.keys(w3cx11_1); i < list.length; i += 1) {\n            var n = list[i];\n\n            if (w3cx11_1[n] === hex) { return n.toLowerCase(); }\n        }\n        return hex;\n    };\n\n    input.format.named = function (name) {\n        name = name.toLowerCase();\n        if (w3cx11_1[name]) { return hex2rgb_1(w3cx11_1[name]); }\n        throw new Error('unknown color name: '+name);\n    };\n\n    input.autodetect.push({\n        p: 5,\n        test: function (h) {\n            var rest = [], len = arguments.length - 1;\n            while ( len-- > 0 ) rest[ len ] = arguments[ len + 1 ];\n\n            if (!rest.length && type$b(h) === 'string' && w3cx11_1[h.toLowerCase()]) {\n                return 'named';\n            }\n        }\n    });\n\n    var unpack$t = utils.unpack;\n\n    var rgb2num = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var ref = unpack$t(args, 'rgb');\n        var r = ref[0];\n        var g = ref[1];\n        var b = ref[2];\n        return (r << 16) + (g << 8) + b;\n    };\n\n    var rgb2num_1 = rgb2num;\n\n    var type$c = utils.type;\n\n    var num2rgb = function (num) {\n        if (type$c(num) == \"number\" && num >= 0 && num <= 0xFFFFFF) {\n            var r = num >> 16;\n            var g = (num >> 8) & 0xFF;\n            var b = num & 0xFF;\n            return [r,g,b,1];\n        }\n        throw new Error(\"unknown num color: \"+num);\n    };\n\n    var num2rgb_1 = num2rgb;\n\n    var type$d = utils.type;\n\n\n\n    Color_1.prototype.num = function() {\n        return rgb2num_1(this._rgb);\n    };\n\n    chroma_1.num = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['num']) ));\n    };\n\n    input.format.num = num2rgb_1;\n\n    input.autodetect.push({\n        p: 5,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            if (args.length === 1 && type$d(args[0]) === 'number' && args[0] >= 0 && args[0] <= 0xFFFFFF) {\n                return 'num';\n            }\n        }\n    });\n\n    var unpack$u = utils.unpack;\n    var type$e = utils.type;\n    var round$5 = Math.round;\n\n    Color_1.prototype.rgb = function(rnd) {\n        if ( rnd === void 0 ) rnd=true;\n\n        if (rnd === false) { return this._rgb.slice(0,3); }\n        return this._rgb.slice(0,3).map(round$5);\n    };\n\n    Color_1.prototype.rgba = function(rnd) {\n        if ( rnd === void 0 ) rnd=true;\n\n        return this._rgb.slice(0,4).map(function (v,i) {\n            return i<3 ? (rnd === false ? v : round$5(v)) : v;\n        });\n    };\n\n    chroma_1.rgb = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['rgb']) ));\n    };\n\n    input.format.rgb = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var rgba = unpack$u(args, 'rgba');\n        if (rgba[3] === undefined) { rgba[3] = 1; }\n        return rgba;\n    };\n\n    input.autodetect.push({\n        p: 3,\n        test: function () {\n            var args = [], len = arguments.length;\n            while ( len-- ) args[ len ] = arguments[ len ];\n\n            args = unpack$u(args, 'rgba');\n            if (type$e(args) === 'array' && (args.length === 3 ||\n                args.length === 4 && type$e(args[3]) == 'number' && args[3] >= 0 && args[3] <= 1)) {\n                return 'rgb';\n            }\n        }\n    });\n\n    /*\n     * Based on implementation by Neil Bartlett\n     * https://github.com/neilbartlett/color-temperature\n     */\n\n    var log = Math.log;\n\n    var temperature2rgb = function (kelvin) {\n        var temp = kelvin / 100;\n        var r,g,b;\n        if (temp < 66) {\n            r = 255;\n            g = -155.25485562709179 - 0.44596950469579133 * (g = temp-2) + 104.49216199393888 * log(g);\n            b = temp < 20 ? 0 : -254.76935184120902 + 0.8274096064007395 * (b = temp-10) + 115.67994401066147 * log(b);\n        } else {\n            r = 351.97690566805693 + 0.114206453784165 * (r = temp-55) - 40.25366309332127 * log(r);\n            g = 325.4494125711974 + 0.07943456536662342 * (g = temp-50) - 28.0852963507957 * log(g);\n            b = 255;\n        }\n        return [r,g,b,1];\n    };\n\n    var temperature2rgb_1 = temperature2rgb;\n\n    /*\n     * Based on implementation by Neil Bartlett\n     * https://github.com/neilbartlett/color-temperature\n     **/\n\n\n    var unpack$v = utils.unpack;\n    var round$6 = Math.round;\n\n    var rgb2temperature = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var rgb = unpack$v(args, 'rgb');\n        var r = rgb[0], b = rgb[2];\n        var minTemp = 1000;\n        var maxTemp = 40000;\n        var eps = 0.4;\n        var temp;\n        while (maxTemp - minTemp > eps) {\n            temp = (maxTemp + minTemp) * 0.5;\n            var rgb$1 = temperature2rgb_1(temp);\n            if ((rgb$1[2] / rgb$1[0]) >= (b / r)) {\n                maxTemp = temp;\n            } else {\n                minTemp = temp;\n            }\n        }\n        return round$6(temp);\n    };\n\n    var rgb2temperature_1 = rgb2temperature;\n\n    Color_1.prototype.temp =\n    Color_1.prototype.kelvin =\n    Color_1.prototype.temperature = function() {\n        return rgb2temperature_1(this._rgb);\n    };\n\n    chroma_1.temp =\n    chroma_1.kelvin =\n    chroma_1.temperature = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        return new (Function.prototype.bind.apply( Color_1, [ null ].concat( args, ['temp']) ));\n    };\n\n    input.format.temp =\n    input.format.kelvin =\n    input.format.temperature = temperature2rgb_1;\n\n    var type$f = utils.type;\n\n    Color_1.prototype.alpha = function(a, mutate) {\n        if ( mutate === void 0 ) mutate=false;\n\n        if (a !== undefined && type$f(a) === 'number') {\n            if (mutate) {\n                this._rgb[3] = a;\n                return this;\n            }\n            return new Color_1([this._rgb[0], this._rgb[1], this._rgb[2], a], 'rgb');\n        }\n        return this._rgb[3];\n    };\n\n    Color_1.prototype.clipped = function() {\n        return this._rgb._clipped || false;\n    };\n\n    Color_1.prototype.darken = function(amount) {\n    \tif ( amount === void 0 ) amount=1;\n\n    \tvar me = this;\n    \tvar lab = me.lab();\n    \tlab[0] -= labConstants.Kn * amount;\n    \treturn new Color_1(lab, 'lab').alpha(me.alpha(), true);\n    };\n\n    Color_1.prototype.brighten = function(amount) {\n    \tif ( amount === void 0 ) amount=1;\n\n    \treturn this.darken(-amount);\n    };\n\n    Color_1.prototype.darker = Color_1.prototype.darken;\n    Color_1.prototype.brighter = Color_1.prototype.brighten;\n\n    Color_1.prototype.get = function(mc) {\n        var ref = mc.split('.');\n        var mode = ref[0];\n        var channel = ref[1];\n        var src = this[mode]();\n        if (channel) {\n            var i = mode.indexOf(channel);\n            if (i > -1) { return src[i]; }\n            throw new Error((\"unknown channel \" + channel + \" in mode \" + mode));\n        } else {\n            return src;\n        }\n    };\n\n    var type$g = utils.type;\n    var pow$2 = Math.pow;\n\n    var EPS = 1e-7;\n    var MAX_ITER = 20;\n\n    Color_1.prototype.luminance = function(lum) {\n        if (lum !== undefined && type$g(lum) === 'number') {\n            if (lum === 0) {\n                // return pure black\n                return new Color_1([0,0,0,this._rgb[3]], 'rgb');\n            }\n            if (lum === 1) {\n                // return pure white\n                return new Color_1([255,255,255,this._rgb[3]], 'rgb');\n            }\n            // compute new color using...\n            var cur_lum = this.luminance();\n            var mode = 'rgb';\n            var max_iter = MAX_ITER;\n\n            var test = function (low, high) {\n                var mid = low.interpolate(high, 0.5, mode);\n                var lm = mid.luminance();\n                if (Math.abs(lum - lm) < EPS || !max_iter--) {\n                    // close enough\n                    return mid;\n                }\n                return lm > lum ? test(low, mid) : test(mid, high);\n            };\n\n            var rgb = (cur_lum > lum ? test(new Color_1([0,0,0]), this) : test(this, new Color_1([255,255,255]))).rgb();\n            return new Color_1(rgb.concat( [this._rgb[3]]));\n        }\n        return rgb2luminance.apply(void 0, (this._rgb).slice(0,3));\n    };\n\n\n    var rgb2luminance = function (r,g,b) {\n        // relative luminance\n        // see http://www.w3.org/TR/2008/REC-WCAG20-20081211/#relativeluminancedef\n        r = luminance_x(r);\n        g = luminance_x(g);\n        b = luminance_x(b);\n        return 0.2126 * r + 0.7152 * g + 0.0722 * b;\n    };\n\n    var luminance_x = function (x) {\n        x /= 255;\n        return x <= 0.03928 ? x/12.92 : pow$2((x+0.055)/1.055, 2.4);\n    };\n\n    var interpolator = {};\n\n    var type$h = utils.type;\n\n\n    var mix = function (col1, col2, f) {\n        if ( f === void 0 ) f=0.5;\n        var rest = [], len = arguments.length - 3;\n        while ( len-- > 0 ) rest[ len ] = arguments[ len + 3 ];\n\n        var mode = rest[0] || 'lrgb';\n        if (!interpolator[mode] && !rest.length) {\n            // fall back to the first supported mode\n            mode = Object.keys(interpolator)[0];\n        }\n        if (!interpolator[mode]) {\n            throw new Error((\"interpolation mode \" + mode + \" is not defined\"));\n        }\n        if (type$h(col1) !== 'object') { col1 = new Color_1(col1); }\n        if (type$h(col2) !== 'object') { col2 = new Color_1(col2); }\n        return interpolator[mode](col1, col2, f)\n            .alpha(col1.alpha() + f * (col2.alpha() - col1.alpha()));\n    };\n\n    Color_1.prototype.mix =\n    Color_1.prototype.interpolate = function(col2, f) {\n    \tif ( f === void 0 ) f=0.5;\n    \tvar rest = [], len = arguments.length - 2;\n    \twhile ( len-- > 0 ) rest[ len ] = arguments[ len + 2 ];\n\n    \treturn mix.apply(void 0, [ this, col2, f ].concat( rest ));\n    };\n\n    Color_1.prototype.premultiply = function(mutate) {\n    \tif ( mutate === void 0 ) mutate=false;\n\n    \tvar rgb = this._rgb;\n    \tvar a = rgb[3];\n    \tif (mutate) {\n    \t\tthis._rgb = [rgb[0]*a, rgb[1]*a, rgb[2]*a, a];\n    \t\treturn this;\n    \t} else {\n    \t\treturn new Color_1([rgb[0]*a, rgb[1]*a, rgb[2]*a, a], 'rgb');\n    \t}\n    };\n\n    Color_1.prototype.saturate = function(amount) {\n    \tif ( amount === void 0 ) amount=1;\n\n    \tvar me = this;\n    \tvar lch = me.lch();\n    \tlch[1] += labConstants.Kn * amount;\n    \tif (lch[1] < 0) { lch[1] = 0; }\n    \treturn new Color_1(lch, 'lch').alpha(me.alpha(), true);\n    };\n\n    Color_1.prototype.desaturate = function(amount) {\n    \tif ( amount === void 0 ) amount=1;\n\n    \treturn this.saturate(-amount);\n    };\n\n    var type$i = utils.type;\n\n    Color_1.prototype.set = function(mc, value, mutate) {\n        if ( mutate === void 0 ) mutate=false;\n\n        var ref = mc.split('.');\n        var mode = ref[0];\n        var channel = ref[1];\n        var src = this[mode]();\n        if (channel) {\n            var i = mode.indexOf(channel);\n            if (i > -1) {\n                if (type$i(value) == 'string') {\n                    switch(value.charAt(0)) {\n                        case '+': src[i] += +value; break;\n                        case '-': src[i] += +value; break;\n                        case '*': src[i] *= +(value.substr(1)); break;\n                        case '/': src[i] /= +(value.substr(1)); break;\n                        default: src[i] = +value;\n                    }\n                } else if (type$i(value) === 'number') {\n                    src[i] = value;\n                } else {\n                    throw new Error(\"unsupported value for Color.set\");\n                }\n                var out = new Color_1(src, mode);\n                if (mutate) {\n                    this._rgb = out._rgb;\n                    return this;\n                }\n                return out;\n            }\n            throw new Error((\"unknown channel \" + channel + \" in mode \" + mode));\n        } else {\n            return src;\n        }\n    };\n\n    var rgb$1 = function (col1, col2, f) {\n        var xyz0 = col1._rgb;\n        var xyz1 = col2._rgb;\n        return new Color_1(\n            xyz0[0] + f * (xyz1[0]-xyz0[0]),\n            xyz0[1] + f * (xyz1[1]-xyz0[1]),\n            xyz0[2] + f * (xyz1[2]-xyz0[2]),\n            'rgb'\n        )\n    };\n\n    // register interpolator\n    interpolator.rgb = rgb$1;\n\n    var sqrt$2 = Math.sqrt;\n    var pow$3 = Math.pow;\n\n    var lrgb = function (col1, col2, f) {\n        var ref = col1._rgb;\n        var x1 = ref[0];\n        var y1 = ref[1];\n        var z1 = ref[2];\n        var ref$1 = col2._rgb;\n        var x2 = ref$1[0];\n        var y2 = ref$1[1];\n        var z2 = ref$1[2];\n        return new Color_1(\n            sqrt$2(pow$3(x1,2) * (1-f) + pow$3(x2,2) * f),\n            sqrt$2(pow$3(y1,2) * (1-f) + pow$3(y2,2) * f),\n            sqrt$2(pow$3(z1,2) * (1-f) + pow$3(z2,2) * f),\n            'rgb'\n        )\n    };\n\n    // register interpolator\n    interpolator.lrgb = lrgb;\n\n    var lab$1 = function (col1, col2, f) {\n        var xyz0 = col1.lab();\n        var xyz1 = col2.lab();\n        return new Color_1(\n            xyz0[0] + f * (xyz1[0]-xyz0[0]),\n            xyz0[1] + f * (xyz1[1]-xyz0[1]),\n            xyz0[2] + f * (xyz1[2]-xyz0[2]),\n            'lab'\n        )\n    };\n\n    // register interpolator\n    interpolator.lab = lab$1;\n\n    var _hsx = function (col1, col2, f, m) {\n        var assign, assign$1;\n\n        var xyz0, xyz1;\n        if (m === 'hsl') {\n            xyz0 = col1.hsl();\n            xyz1 = col2.hsl();\n        } else if (m === 'hsv') {\n            xyz0 = col1.hsv();\n            xyz1 = col2.hsv();\n        } else if (m === 'hcg') {\n            xyz0 = col1.hcg();\n            xyz1 = col2.hcg();\n        } else if (m === 'hsi') {\n            xyz0 = col1.hsi();\n            xyz1 = col2.hsi();\n        } else if (m === 'lch' || m === 'hcl') {\n            m = 'hcl';\n            xyz0 = col1.hcl();\n            xyz1 = col2.hcl();\n        }\n\n        var hue0, hue1, sat0, sat1, lbv0, lbv1;\n        if (m.substr(0, 1) === 'h') {\n            (assign = xyz0, hue0 = assign[0], sat0 = assign[1], lbv0 = assign[2]);\n            (assign$1 = xyz1, hue1 = assign$1[0], sat1 = assign$1[1], lbv1 = assign$1[2]);\n        }\n\n        var sat, hue, lbv, dh;\n\n        if (!isNaN(hue0) && !isNaN(hue1)) {\n            // both colors have hue\n            if (hue1 > hue0 && hue1 - hue0 > 180) {\n                dh = hue1-(hue0+360);\n            } else if (hue1 < hue0 && hue0 - hue1 > 180) {\n                dh = hue1+360-hue0;\n            } else{\n                dh = hue1 - hue0;\n            }\n            hue = hue0 + f * dh;\n        } else if (!isNaN(hue0)) {\n            hue = hue0;\n            if ((lbv1 == 1 || lbv1 == 0) && m != 'hsv') { sat = sat0; }\n        } else if (!isNaN(hue1)) {\n            hue = hue1;\n            if ((lbv0 == 1 || lbv0 == 0) && m != 'hsv') { sat = sat1; }\n        } else {\n            hue = Number.NaN;\n        }\n\n        if (sat === undefined) { sat = sat0 + f * (sat1 - sat0); }\n        lbv = lbv0 + f * (lbv1-lbv0);\n        return new Color_1([hue, sat, lbv], m);\n    };\n\n    var lch$1 = function (col1, col2, f) {\n    \treturn _hsx(col1, col2, f, 'lch');\n    };\n\n    // register interpolator\n    interpolator.lch = lch$1;\n    interpolator.hcl = lch$1;\n\n    var num$1 = function (col1, col2, f) {\n        var c1 = col1.num();\n        var c2 = col2.num();\n        return new Color_1(c1 + f * (c2-c1), 'num')\n    };\n\n    // register interpolator\n    interpolator.num = num$1;\n\n    var hcg$1 = function (col1, col2, f) {\n    \treturn _hsx(col1, col2, f, 'hcg');\n    };\n\n    // register interpolator\n    interpolator.hcg = hcg$1;\n\n    var hsi$1 = function (col1, col2, f) {\n    \treturn _hsx(col1, col2, f, 'hsi');\n    };\n\n    // register interpolator\n    interpolator.hsi = hsi$1;\n\n    var hsl$1 = function (col1, col2, f) {\n    \treturn _hsx(col1, col2, f, 'hsl');\n    };\n\n    // register interpolator\n    interpolator.hsl = hsl$1;\n\n    var hsv$1 = function (col1, col2, f) {\n    \treturn _hsx(col1, col2, f, 'hsv');\n    };\n\n    // register interpolator\n    interpolator.hsv = hsv$1;\n\n    var clip_rgb$2 = utils.clip_rgb;\n    var pow$4 = Math.pow;\n    var sqrt$3 = Math.sqrt;\n    var PI$1 = Math.PI;\n    var cos$2 = Math.cos;\n    var sin$1 = Math.sin;\n    var atan2$1 = Math.atan2;\n\n    var average = function (colors, mode, weights) {\n        if ( mode === void 0 ) mode='lrgb';\n        if ( weights === void 0 ) weights=null;\n\n        var l = colors.length;\n        if (!weights) { weights = Array.from(new Array(l)).map(function () { return 1; }); }\n        // normalize weights\n        var k = l / weights.reduce(function(a, b) { return a + b; });\n        weights.forEach(function (w,i) { weights[i] *= k; });\n        // convert colors to Color objects\n        colors = colors.map(function (c) { return new Color_1(c); });\n        if (mode === 'lrgb') {\n            return _average_lrgb(colors, weights)\n        }\n        var first = colors.shift();\n        var xyz = first.get(mode);\n        var cnt = [];\n        var dx = 0;\n        var dy = 0;\n        // initial color\n        for (var i=0; i<xyz.length; i++) {\n            xyz[i] = (xyz[i] || 0) * weights[0];\n            cnt.push(isNaN(xyz[i]) ? 0 : weights[0]);\n            if (mode.charAt(i) === 'h' && !isNaN(xyz[i])) {\n                var A = xyz[i] / 180 * PI$1;\n                dx += cos$2(A) * weights[0];\n                dy += sin$1(A) * weights[0];\n            }\n        }\n\n        var alpha = first.alpha() * weights[0];\n        colors.forEach(function (c,ci) {\n            var xyz2 = c.get(mode);\n            alpha += c.alpha() * weights[ci+1];\n            for (var i=0; i<xyz.length; i++) {\n                if (!isNaN(xyz2[i])) {\n                    cnt[i] += weights[ci+1];\n                    if (mode.charAt(i) === 'h') {\n                        var A = xyz2[i] / 180 * PI$1;\n                        dx += cos$2(A) * weights[ci+1];\n                        dy += sin$1(A) * weights[ci+1];\n                    } else {\n                        xyz[i] += xyz2[i] * weights[ci+1];\n                    }\n                }\n            }\n        });\n\n        for (var i$1=0; i$1<xyz.length; i$1++) {\n            if (mode.charAt(i$1) === 'h') {\n                var A$1 = atan2$1(dy / cnt[i$1], dx / cnt[i$1]) / PI$1 * 180;\n                while (A$1 < 0) { A$1 += 360; }\n                while (A$1 >= 360) { A$1 -= 360; }\n                xyz[i$1] = A$1;\n            } else {\n                xyz[i$1] = xyz[i$1]/cnt[i$1];\n            }\n        }\n        alpha /= l;\n        return (new Color_1(xyz, mode)).alpha(alpha > 0.99999 ? 1 : alpha, true);\n    };\n\n\n    var _average_lrgb = function (colors, weights) {\n        var l = colors.length;\n        var xyz = [0,0,0,0];\n        for (var i=0; i < colors.length; i++) {\n            var col = colors[i];\n            var f = weights[i] / l;\n            var rgb = col._rgb;\n            xyz[0] += pow$4(rgb[0],2) * f;\n            xyz[1] += pow$4(rgb[1],2) * f;\n            xyz[2] += pow$4(rgb[2],2) * f;\n            xyz[3] += rgb[3] * f;\n        }\n        xyz[0] = sqrt$3(xyz[0]);\n        xyz[1] = sqrt$3(xyz[1]);\n        xyz[2] = sqrt$3(xyz[2]);\n        if (xyz[3] > 0.9999999) { xyz[3] = 1; }\n        return new Color_1(clip_rgb$2(xyz));\n    };\n\n    // minimal multi-purpose interface\n\n    // @requires utils color analyze\n\n\n    var type$j = utils.type;\n\n    var pow$5 = Math.pow;\n\n    var scale = function(colors) {\n\n        // constructor\n        var _mode = 'rgb';\n        var _nacol = chroma_1('#ccc');\n        var _spread = 0;\n        // const _fixed = false;\n        var _domain = [0, 1];\n        var _pos = [];\n        var _padding = [0,0];\n        var _classes = false;\n        var _colors = [];\n        var _out = false;\n        var _min = 0;\n        var _max = 1;\n        var _correctLightness = false;\n        var _colorCache = {};\n        var _useCache = true;\n        var _gamma = 1;\n\n        // private methods\n\n        var setColors = function(colors) {\n            colors = colors || ['#fff', '#000'];\n            if (colors && type$j(colors) === 'string' && chroma_1.brewer &&\n                chroma_1.brewer[colors.toLowerCase()]) {\n                colors = chroma_1.brewer[colors.toLowerCase()];\n            }\n            if (type$j(colors) === 'array') {\n                // handle single color\n                if (colors.length === 1) {\n                    colors = [colors[0], colors[0]];\n                }\n                // make a copy of the colors\n                colors = colors.slice(0);\n                // convert to chroma classes\n                for (var c=0; c<colors.length; c++) {\n                    colors[c] = chroma_1(colors[c]);\n                }\n                // auto-fill color position\n                _pos.length = 0;\n                for (var c$1=0; c$1<colors.length; c$1++) {\n                    _pos.push(c$1/(colors.length-1));\n                }\n            }\n            resetCache();\n            return _colors = colors;\n        };\n\n        var getClass = function(value) {\n            if (_classes != null) {\n                var n = _classes.length-1;\n                var i = 0;\n                while (i < n && value >= _classes[i]) {\n                    i++;\n                }\n                return i-1;\n            }\n            return 0;\n        };\n\n        var tMapLightness = function (t) { return t; };\n        var tMapDomain = function (t) { return t; };\n\n        // const classifyValue = function(value) {\n        //     let val = value;\n        //     if (_classes.length > 2) {\n        //         const n = _classes.length-1;\n        //         const i = getClass(value);\n        //         const minc = _classes[0] + ((_classes[1]-_classes[0]) * (0 + (_spread * 0.5)));  // center of 1st class\n        //         const maxc = _classes[n-1] + ((_classes[n]-_classes[n-1]) * (1 - (_spread * 0.5)));  // center of last class\n        //         val = _min + ((((_classes[i] + ((_classes[i+1] - _classes[i]) * 0.5)) - minc) / (maxc-minc)) * (_max - _min));\n        //     }\n        //     return val;\n        // };\n\n        var getColor = function(val, bypassMap) {\n            var col, t;\n            if (bypassMap == null) { bypassMap = false; }\n            if (isNaN(val) || (val === null)) { return _nacol; }\n            if (!bypassMap) {\n                if (_classes && (_classes.length > 2)) {\n                    // find the class\n                    var c = getClass(val);\n                    t = c / (_classes.length-2);\n                } else if (_max !== _min) {\n                    // just interpolate between min/max\n                    t = (val - _min) / (_max - _min);\n                } else {\n                    t = 1;\n                }\n            } else {\n                t = val;\n            }\n\n            // domain map\n            t = tMapDomain(t);\n\n            if (!bypassMap) {\n                t = tMapLightness(t);  // lightness correction\n            }\n\n            if (_gamma !== 1) { t = pow$5(t, _gamma); }\n\n            t = _padding[0] + (t * (1 - _padding[0] - _padding[1]));\n\n            t = Math.min(1, Math.max(0, t));\n\n            var k = Math.floor(t * 10000);\n\n            if (_useCache && _colorCache[k]) {\n                col = _colorCache[k];\n            } else {\n                if (type$j(_colors) === 'array') {\n                    //for i in [0.._pos.length-1]\n                    for (var i=0; i<_pos.length; i++) {\n                        var p = _pos[i];\n                        if (t <= p) {\n                            col = _colors[i];\n                            break;\n                        }\n                        if ((t >= p) && (i === (_pos.length-1))) {\n                            col = _colors[i];\n                            break;\n                        }\n                        if (t > p && t < _pos[i+1]) {\n                            t = (t-p)/(_pos[i+1]-p);\n                            col = chroma_1.interpolate(_colors[i], _colors[i+1], t, _mode);\n                            break;\n                        }\n                    }\n                } else if (type$j(_colors) === 'function') {\n                    col = _colors(t);\n                }\n                if (_useCache) { _colorCache[k] = col; }\n            }\n            return col;\n        };\n\n        var resetCache = function () { return _colorCache = {}; };\n\n        setColors(colors);\n\n        // public interface\n\n        var f = function(v) {\n            var c = chroma_1(getColor(v));\n            if (_out && c[_out]) { return c[_out](); } else { return c; }\n        };\n\n        f.classes = function(classes) {\n            if (classes != null) {\n                if (type$j(classes) === 'array') {\n                    _classes = classes;\n                    _domain = [classes[0], classes[classes.length-1]];\n                } else {\n                    var d = chroma_1.analyze(_domain);\n                    if (classes === 0) {\n                        _classes = [d.min, d.max];\n                    } else {\n                        _classes = chroma_1.limits(d, 'e', classes);\n                    }\n                }\n                return f;\n            }\n            return _classes;\n        };\n\n\n        f.domain = function(domain) {\n            if (!arguments.length) {\n                return _domain;\n            }\n            _min = domain[0];\n            _max = domain[domain.length-1];\n            _pos = [];\n            var k = _colors.length;\n            if ((domain.length === k) && (_min !== _max)) {\n                // update positions\n                for (var i = 0, list = Array.from(domain); i < list.length; i += 1) {\n                    var d = list[i];\n\n                  _pos.push((d-_min) / (_max-_min));\n                }\n            } else {\n                for (var c=0; c<k; c++) {\n                    _pos.push(c/(k-1));\n                }\n                if (domain.length > 2) {\n                    // set domain map\n                    var tOut = domain.map(function (d,i) { return i/(domain.length-1); });\n                    var tBreaks = domain.map(function (d) { return (d - _min) / (_max - _min); });\n                    if (!tBreaks.every(function (val, i) { return tOut[i] === val; })) {\n                        tMapDomain = function (t) {\n                            if (t <= 0 || t >= 1) { return t; }\n                            var i = 0;\n                            while (t >= tBreaks[i+1]) { i++; }\n                            var f = (t - tBreaks[i]) / (tBreaks[i+1] - tBreaks[i]);\n                            var out = tOut[i] + f * (tOut[i+1] - tOut[i]);\n                            return out;\n                        };\n                    }\n\n                }\n            }\n            _domain = [_min, _max];\n            return f;\n        };\n\n        f.mode = function(_m) {\n            if (!arguments.length) {\n                return _mode;\n            }\n            _mode = _m;\n            resetCache();\n            return f;\n        };\n\n        f.range = function(colors, _pos) {\n            setColors(colors, _pos);\n            return f;\n        };\n\n        f.out = function(_o) {\n            _out = _o;\n            return f;\n        };\n\n        f.spread = function(val) {\n            if (!arguments.length) {\n                return _spread;\n            }\n            _spread = val;\n            return f;\n        };\n\n        f.correctLightness = function(v) {\n            if (v == null) { v = true; }\n            _correctLightness = v;\n            resetCache();\n            if (_correctLightness) {\n                tMapLightness = function(t) {\n                    var L0 = getColor(0, true).lab()[0];\n                    var L1 = getColor(1, true).lab()[0];\n                    var pol = L0 > L1;\n                    var L_actual = getColor(t, true).lab()[0];\n                    var L_ideal = L0 + ((L1 - L0) * t);\n                    var L_diff = L_actual - L_ideal;\n                    var t0 = 0;\n                    var t1 = 1;\n                    var max_iter = 20;\n                    while ((Math.abs(L_diff) > 1e-2) && (max_iter-- > 0)) {\n                        (function() {\n                            if (pol) { L_diff *= -1; }\n                            if (L_diff < 0) {\n                                t0 = t;\n                                t += (t1 - t) * 0.5;\n                            } else {\n                                t1 = t;\n                                t += (t0 - t) * 0.5;\n                            }\n                            L_actual = getColor(t, true).lab()[0];\n                            return L_diff = L_actual - L_ideal;\n                        })();\n                    }\n                    return t;\n                };\n            } else {\n                tMapLightness = function (t) { return t; };\n            }\n            return f;\n        };\n\n        f.padding = function(p) {\n            if (p != null) {\n                if (type$j(p) === 'number') {\n                    p = [p,p];\n                }\n                _padding = p;\n                return f;\n            } else {\n                return _padding;\n            }\n        };\n\n        f.colors = function(numColors, out) {\n            // If no arguments are given, return the original colors that were provided\n            if (arguments.length < 2) { out = 'hex'; }\n            var result = [];\n\n            if (arguments.length === 0) {\n                result = _colors.slice(0);\n\n            } else if (numColors === 1) {\n                result = [f(0.5)];\n\n            } else if (numColors > 1) {\n                var dm = _domain[0];\n                var dd = _domain[1] - dm;\n                result = __range__(0, numColors, false).map(function (i) { return f( dm + ((i/(numColors-1)) * dd) ); });\n\n            } else { // returns all colors based on the defined classes\n                colors = [];\n                var samples = [];\n                if (_classes && (_classes.length > 2)) {\n                    for (var i = 1, end = _classes.length, asc = 1 <= end; asc ? i < end : i > end; asc ? i++ : i--) {\n                        samples.push((_classes[i-1]+_classes[i])*0.5);\n                    }\n                } else {\n                    samples = _domain;\n                }\n                result = samples.map(function (v) { return f(v); });\n            }\n\n            if (chroma_1[out]) {\n                result = result.map(function (c) { return c[out](); });\n            }\n            return result;\n        };\n\n        f.cache = function(c) {\n            if (c != null) {\n                _useCache = c;\n                return f;\n            } else {\n                return _useCache;\n            }\n        };\n\n        f.gamma = function(g) {\n            if (g != null) {\n                _gamma = g;\n                return f;\n            } else {\n                return _gamma;\n            }\n        };\n\n        f.nodata = function(d) {\n            if (d != null) {\n                _nacol = chroma_1(d);\n                return f;\n            } else {\n                return _nacol;\n            }\n        };\n\n        return f;\n    };\n\n    function __range__(left, right, inclusive) {\n      var range = [];\n      var ascending = left < right;\n      var end = !inclusive ? right : ascending ? right + 1 : right - 1;\n      for (var i = left; ascending ? i < end : i > end; ascending ? i++ : i--) {\n        range.push(i);\n      }\n      return range;\n    }\n\n    //\n    // interpolates between a set of colors uzing a bezier spline\n    //\n\n    // @requires utils lab\n\n\n\n\n    var bezier = function(colors) {\n        var assign, assign$1, assign$2;\n\n        var I, lab0, lab1, lab2;\n        colors = colors.map(function (c) { return new Color_1(c); });\n        if (colors.length === 2) {\n            // linear interpolation\n            (assign = colors.map(function (c) { return c.lab(); }), lab0 = assign[0], lab1 = assign[1]);\n            I = function(t) {\n                var lab = ([0, 1, 2].map(function (i) { return lab0[i] + (t * (lab1[i] - lab0[i])); }));\n                return new Color_1(lab, 'lab');\n            };\n        } else if (colors.length === 3) {\n            // quadratic bezier interpolation\n            (assign$1 = colors.map(function (c) { return c.lab(); }), lab0 = assign$1[0], lab1 = assign$1[1], lab2 = assign$1[2]);\n            I = function(t) {\n                var lab = ([0, 1, 2].map(function (i) { return ((1-t)*(1-t) * lab0[i]) + (2 * (1-t) * t * lab1[i]) + (t * t * lab2[i]); }));\n                return new Color_1(lab, 'lab');\n            };\n        } else if (colors.length === 4) {\n            // cubic bezier interpolation\n            var lab3;\n            (assign$2 = colors.map(function (c) { return c.lab(); }), lab0 = assign$2[0], lab1 = assign$2[1], lab2 = assign$2[2], lab3 = assign$2[3]);\n            I = function(t) {\n                var lab = ([0, 1, 2].map(function (i) { return ((1-t)*(1-t)*(1-t) * lab0[i]) + (3 * (1-t) * (1-t) * t * lab1[i]) + (3 * (1-t) * t * t * lab2[i]) + (t*t*t * lab3[i]); }));\n                return new Color_1(lab, 'lab');\n            };\n        } else if (colors.length === 5) {\n            var I0 = bezier(colors.slice(0, 3));\n            var I1 = bezier(colors.slice(2, 5));\n            I = function(t) {\n                if (t < 0.5) {\n                    return I0(t*2);\n                } else {\n                    return I1((t-0.5)*2);\n                }\n            };\n        }\n        return I;\n    };\n\n    var bezier_1 = function (colors) {\n        var f = bezier(colors);\n        f.scale = function () { return scale(f); };\n        return f;\n    };\n\n    /*\n     * interpolates between a set of colors uzing a bezier spline\n     * blend mode formulas taken from http://www.venture-ware.com/kevin/coding/lets-learn-math-photoshop-blend-modes/\n     */\n\n\n\n\n    var blend = function (bottom, top, mode) {\n        if (!blend[mode]) {\n            throw new Error('unknown blend mode ' + mode);\n        }\n        return blend[mode](bottom, top);\n    };\n\n    var blend_f = function (f) { return function (bottom,top) {\n            var c0 = chroma_1(top).rgb();\n            var c1 = chroma_1(bottom).rgb();\n            return chroma_1.rgb(f(c0, c1));\n        }; };\n\n    var each = function (f) { return function (c0, c1) {\n            var out = [];\n            out[0] = f(c0[0], c1[0]);\n            out[1] = f(c0[1], c1[1]);\n            out[2] = f(c0[2], c1[2]);\n            return out;\n        }; };\n\n    var normal = function (a) { return a; };\n    var multiply = function (a,b) { return a * b / 255; };\n    var darken$1 = function (a,b) { return a > b ? b : a; };\n    var lighten = function (a,b) { return a > b ? a : b; };\n    var screen = function (a,b) { return 255 * (1 - (1-a/255) * (1-b/255)); };\n    var overlay = function (a,b) { return b < 128 ? 2 * a * b / 255 : 255 * (1 - 2 * (1 - a / 255 ) * ( 1 - b / 255 )); };\n    var burn = function (a,b) { return 255 * (1 - (1 - b / 255) / (a/255)); };\n    var dodge = function (a,b) {\n        if (a === 255) { return 255; }\n        a = 255 * (b / 255) / (1 - a / 255);\n        return a > 255 ? 255 : a\n    };\n\n    // # add = (a,b) ->\n    // #     if (a + b > 255) then 255 else a + b\n\n    blend.normal = blend_f(each(normal));\n    blend.multiply = blend_f(each(multiply));\n    blend.screen = blend_f(each(screen));\n    blend.overlay = blend_f(each(overlay));\n    blend.darken = blend_f(each(darken$1));\n    blend.lighten = blend_f(each(lighten));\n    blend.dodge = blend_f(each(dodge));\n    blend.burn = blend_f(each(burn));\n    // blend.add = blend_f(each(add));\n\n    var blend_1 = blend;\n\n    // cubehelix interpolation\n    // based on D.A. Green \"A colour scheme for the display of astronomical intensity images\"\n    // http://astron-soc.in/bulletin/11June/289392011.pdf\n\n    var type$k = utils.type;\n    var clip_rgb$3 = utils.clip_rgb;\n    var TWOPI$2 = utils.TWOPI;\n    var pow$6 = Math.pow;\n    var sin$2 = Math.sin;\n    var cos$3 = Math.cos;\n\n\n    var cubehelix = function(start, rotations, hue, gamma, lightness) {\n        if ( start === void 0 ) start=300;\n        if ( rotations === void 0 ) rotations=-1.5;\n        if ( hue === void 0 ) hue=1;\n        if ( gamma === void 0 ) gamma=1;\n        if ( lightness === void 0 ) lightness=[0,1];\n\n        var dh = 0, dl;\n        if (type$k(lightness) === 'array') {\n            dl = lightness[1] - lightness[0];\n        } else {\n            dl = 0;\n            lightness = [lightness, lightness];\n        }\n\n        var f = function(fract) {\n            var a = TWOPI$2 * (((start+120)/360) + (rotations * fract));\n            var l = pow$6(lightness[0] + (dl * fract), gamma);\n            var h = dh !== 0 ? hue[0] + (fract * dh) : hue;\n            var amp = (h * l * (1-l)) / 2;\n            var cos_a = cos$3(a);\n            var sin_a = sin$2(a);\n            var r = l + (amp * ((-0.14861 * cos_a) + (1.78277* sin_a)));\n            var g = l + (amp * ((-0.29227 * cos_a) - (0.90649* sin_a)));\n            var b = l + (amp * (+1.97294 * cos_a));\n            return chroma_1(clip_rgb$3([r*255,g*255,b*255,1]));\n        };\n\n        f.start = function(s) {\n            if ((s == null)) { return start; }\n            start = s;\n            return f;\n        };\n\n        f.rotations = function(r) {\n            if ((r == null)) { return rotations; }\n            rotations = r;\n            return f;\n        };\n\n        f.gamma = function(g) {\n            if ((g == null)) { return gamma; }\n            gamma = g;\n            return f;\n        };\n\n        f.hue = function(h) {\n            if ((h == null)) { return hue; }\n            hue = h;\n            if (type$k(hue) === 'array') {\n                dh = hue[1] - hue[0];\n                if (dh === 0) { hue = hue[1]; }\n            } else {\n                dh = 0;\n            }\n            return f;\n        };\n\n        f.lightness = function(h) {\n            if ((h == null)) { return lightness; }\n            if (type$k(h) === 'array') {\n                lightness = h;\n                dl = h[1] - h[0];\n            } else {\n                lightness = [h,h];\n                dl = 0;\n            }\n            return f;\n        };\n\n        f.scale = function () { return chroma_1.scale(f); };\n\n        f.hue(hue);\n\n        return f;\n    };\n\n    var digits = '0123456789abcdef';\n\n    var floor$2 = Math.floor;\n    var random = Math.random;\n\n    var random_1 = function () {\n        var code = '#';\n        for (var i=0; i<6; i++) {\n            code += digits.charAt(floor$2(random() * 16));\n        }\n        return new Color_1(code, 'hex');\n    };\n\n    var log$1 = Math.log;\n    var pow$7 = Math.pow;\n    var floor$3 = Math.floor;\n    var abs = Math.abs;\n\n\n    var analyze = function (data, key) {\n        if ( key === void 0 ) key=null;\n\n        var r = {\n            min: Number.MAX_VALUE,\n            max: Number.MAX_VALUE*-1,\n            sum: 0,\n            values: [],\n            count: 0\n        };\n        if (type(data) === 'object') {\n            data = Object.values(data);\n        }\n        data.forEach(function (val) {\n            if (key && type(val) === 'object') { val = val[key]; }\n            if (val !== undefined && val !== null && !isNaN(val)) {\n                r.values.push(val);\n                r.sum += val;\n                if (val < r.min) { r.min = val; }\n                if (val > r.max) { r.max = val; }\n                r.count += 1;\n            }\n        });\n\n        r.domain = [r.min, r.max];\n\n        r.limits = function (mode, num) { return limits(r, mode, num); };\n\n        return r;\n    };\n\n\n    var limits = function (data, mode, num) {\n        if ( mode === void 0 ) mode='equal';\n        if ( num === void 0 ) num=7;\n\n        if (type(data) == 'array') {\n            data = analyze(data);\n        }\n        var min = data.min;\n        var max = data.max;\n        var values = data.values.sort(function (a,b) { return a-b; });\n\n        if (num === 1) { return [min,max]; }\n\n        var limits = [];\n\n        if (mode.substr(0,1) === 'c') { // continuous\n            limits.push(min);\n            limits.push(max);\n        }\n\n        if (mode.substr(0,1) === 'e') { // equal interval\n            limits.push(min);\n            for (var i=1; i<num; i++) {\n                limits.push(min+((i/num)*(max-min)));\n            }\n            limits.push(max);\n        }\n\n        else if (mode.substr(0,1) === 'l') { // log scale\n            if (min <= 0) {\n                throw new Error('Logarithmic scales are only possible for values > 0');\n            }\n            var min_log = Math.LOG10E * log$1(min);\n            var max_log = Math.LOG10E * log$1(max);\n            limits.push(min);\n            for (var i$1=1; i$1<num; i$1++) {\n                limits.push(pow$7(10, min_log + ((i$1/num) * (max_log - min_log))));\n            }\n            limits.push(max);\n        }\n\n        else if (mode.substr(0,1) === 'q') { // quantile scale\n            limits.push(min);\n            for (var i$2=1; i$2<num; i$2++) {\n                var p = ((values.length-1) * i$2)/num;\n                var pb = floor$3(p);\n                if (pb === p) {\n                    limits.push(values[pb]);\n                } else { // p > pb\n                    var pr = p - pb;\n                    limits.push((values[pb]*(1-pr)) + (values[pb+1]*pr));\n                }\n            }\n            limits.push(max);\n\n        }\n\n        else if (mode.substr(0,1) === 'k') { // k-means clustering\n            /*\n            implementation based on\n            http://code.google.com/p/figue/source/browse/trunk/figue.js#336\n            simplified for 1-d input values\n            */\n            var cluster;\n            var n = values.length;\n            var assignments = new Array(n);\n            var clusterSizes = new Array(num);\n            var repeat = true;\n            var nb_iters = 0;\n            var centroids = null;\n\n            // get seed values\n            centroids = [];\n            centroids.push(min);\n            for (var i$3=1; i$3<num; i$3++) {\n                centroids.push(min + ((i$3/num) * (max-min)));\n            }\n            centroids.push(max);\n\n            while (repeat) {\n                // assignment step\n                for (var j=0; j<num; j++) {\n                    clusterSizes[j] = 0;\n                }\n                for (var i$4=0; i$4<n; i$4++) {\n                    var value = values[i$4];\n                    var mindist = Number.MAX_VALUE;\n                    var best = (void 0);\n                    for (var j$1=0; j$1<num; j$1++) {\n                        var dist = abs(centroids[j$1]-value);\n                        if (dist < mindist) {\n                            mindist = dist;\n                            best = j$1;\n                        }\n                        clusterSizes[best]++;\n                        assignments[i$4] = best;\n                    }\n                }\n\n                // update centroids step\n                var newCentroids = new Array(num);\n                for (var j$2=0; j$2<num; j$2++) {\n                    newCentroids[j$2] = null;\n                }\n                for (var i$5=0; i$5<n; i$5++) {\n                    cluster = assignments[i$5];\n                    if (newCentroids[cluster] === null) {\n                        newCentroids[cluster] = values[i$5];\n                    } else {\n                        newCentroids[cluster] += values[i$5];\n                    }\n                }\n                for (var j$3=0; j$3<num; j$3++) {\n                    newCentroids[j$3] *= 1/clusterSizes[j$3];\n                }\n\n                // check convergence\n                repeat = false;\n                for (var j$4=0; j$4<num; j$4++) {\n                    if (newCentroids[j$4] !== centroids[j$4]) {\n                        repeat = true;\n                        break;\n                    }\n                }\n\n                centroids = newCentroids;\n                nb_iters++;\n\n                if (nb_iters > 200) {\n                    repeat = false;\n                }\n            }\n\n            // finished k-means clustering\n            // the next part is borrowed from gabrielflor.it\n            var kClusters = {};\n            for (var j$5=0; j$5<num; j$5++) {\n                kClusters[j$5] = [];\n            }\n            for (var i$6=0; i$6<n; i$6++) {\n                cluster = assignments[i$6];\n                kClusters[cluster].push(values[i$6]);\n            }\n            var tmpKMeansBreaks = [];\n            for (var j$6=0; j$6<num; j$6++) {\n                tmpKMeansBreaks.push(kClusters[j$6][0]);\n                tmpKMeansBreaks.push(kClusters[j$6][kClusters[j$6].length-1]);\n            }\n            tmpKMeansBreaks = tmpKMeansBreaks.sort(function (a,b){ return a-b; });\n            limits.push(tmpKMeansBreaks[0]);\n            for (var i$7=1; i$7 < tmpKMeansBreaks.length; i$7+= 2) {\n                var v = tmpKMeansBreaks[i$7];\n                if (!isNaN(v) && (limits.indexOf(v) === -1)) {\n                    limits.push(v);\n                }\n            }\n        }\n        return limits;\n    };\n\n    var analyze_1 = {analyze: analyze, limits: limits};\n\n    var contrast = function (a, b) {\n        // WCAG contrast ratio\n        // see http://www.w3.org/TR/2008/REC-WCAG20-20081211/#contrast-ratiodef\n        a = new Color_1(a);\n        b = new Color_1(b);\n        var l1 = a.luminance();\n        var l2 = b.luminance();\n        return l1 > l2 ? (l1 + 0.05) / (l2 + 0.05) : (l2 + 0.05) / (l1 + 0.05);\n    };\n\n    var sqrt$4 = Math.sqrt;\n    var atan2$2 = Math.atan2;\n    var abs$1 = Math.abs;\n    var cos$4 = Math.cos;\n    var PI$2 = Math.PI;\n\n    var deltaE = function(a, b, L, C) {\n        if ( L === void 0 ) L=1;\n        if ( C === void 0 ) C=1;\n\n        // Delta E (CMC)\n        // see http://www.brucelindbloom.com/index.html?Eqn_DeltaE_CMC.html\n        a = new Color_1(a);\n        b = new Color_1(b);\n        var ref = Array.from(a.lab());\n        var L1 = ref[0];\n        var a1 = ref[1];\n        var b1 = ref[2];\n        var ref$1 = Array.from(b.lab());\n        var L2 = ref$1[0];\n        var a2 = ref$1[1];\n        var b2 = ref$1[2];\n        var c1 = sqrt$4((a1 * a1) + (b1 * b1));\n        var c2 = sqrt$4((a2 * a2) + (b2 * b2));\n        var sl = L1 < 16.0 ? 0.511 : (0.040975 * L1) / (1.0 + (0.01765 * L1));\n        var sc = ((0.0638 * c1) / (1.0 + (0.0131 * c1))) + 0.638;\n        var h1 = c1 < 0.000001 ? 0.0 : (atan2$2(b1, a1) * 180.0) / PI$2;\n        while (h1 < 0) { h1 += 360; }\n        while (h1 >= 360) { h1 -= 360; }\n        var t = (h1 >= 164.0) && (h1 <= 345.0) ? (0.56 + abs$1(0.2 * cos$4((PI$2 * (h1 + 168.0)) / 180.0))) : (0.36 + abs$1(0.4 * cos$4((PI$2 * (h1 + 35.0)) / 180.0)));\n        var c4 = c1 * c1 * c1 * c1;\n        var f = sqrt$4(c4 / (c4 + 1900.0));\n        var sh = sc * (((f * t) + 1.0) - f);\n        var delL = L1 - L2;\n        var delC = c1 - c2;\n        var delA = a1 - a2;\n        var delB = b1 - b2;\n        var dH2 = ((delA * delA) + (delB * delB)) - (delC * delC);\n        var v1 = delL / (L * sl);\n        var v2 = delC / (C * sc);\n        var v3 = sh;\n        return sqrt$4((v1 * v1) + (v2 * v2) + (dH2 / (v3 * v3)));\n    };\n\n    // simple Euclidean distance\n    var distance = function(a, b, mode) {\n        if ( mode === void 0 ) mode='lab';\n\n        // Delta E (CIE 1976)\n        // see http://www.brucelindbloom.com/index.html?Equations.html\n        a = new Color_1(a);\n        b = new Color_1(b);\n        var l1 = a.get(mode);\n        var l2 = b.get(mode);\n        var sum_sq = 0;\n        for (var i in l1) {\n            var d = (l1[i] || 0) - (l2[i] || 0);\n            sum_sq += d*d;\n        }\n        return Math.sqrt(sum_sq);\n    };\n\n    var valid = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        try {\n            new (Function.prototype.bind.apply( Color_1, [ null ].concat( args) ));\n            return true;\n        } catch (e) {\n            return false;\n        }\n    };\n\n    // some pre-defined color scales:\n\n\n\n\n    var scales = {\n    \tcool: function cool() { return scale([chroma_1.hsl(180,1,.9), chroma_1.hsl(250,.7,.4)]) },\n    \thot: function hot() { return scale(['#000','#f00','#ff0','#fff'], [0,.25,.75,1]).mode('rgb') }\n    };\n\n    /**\n        ColorBrewer colors for chroma.js\n\n        Copyright (c) 2002 Cynthia Brewer, Mark Harrower, and The\n        Pennsylvania State University.\n\n        Licensed under the Apache License, Version 2.0 (the \"License\");\n        you may not use this file except in compliance with the License.\n        You may obtain a copy of the License at\n        http://www.apache.org/licenses/LICENSE-2.0\n\n        Unless required by applicable law or agreed to in writing, software distributed\n        under the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n        CONDITIONS OF ANY KIND, either express or implied. See the License for the\n        specific language governing permissions and limitations under the License.\n    */\n\n    var colorbrewer = {\n        // sequential\n        OrRd: ['#fff7ec', '#fee8c8', '#fdd49e', '#fdbb84', '#fc8d59', '#ef6548', '#d7301f', '#b30000', '#7f0000'],\n        PuBu: ['#fff7fb', '#ece7f2', '#d0d1e6', '#a6bddb', '#74a9cf', '#3690c0', '#0570b0', '#045a8d', '#023858'],\n        BuPu: ['#f7fcfd', '#e0ecf4', '#bfd3e6', '#9ebcda', '#8c96c6', '#8c6bb1', '#88419d', '#810f7c', '#4d004b'],\n        Oranges: ['#fff5eb', '#fee6ce', '#fdd0a2', '#fdae6b', '#fd8d3c', '#f16913', '#d94801', '#a63603', '#7f2704'],\n        BuGn: ['#f7fcfd', '#e5f5f9', '#ccece6', '#99d8c9', '#66c2a4', '#41ae76', '#238b45', '#006d2c', '#00441b'],\n        YlOrBr: ['#ffffe5', '#fff7bc', '#fee391', '#fec44f', '#fe9929', '#ec7014', '#cc4c02', '#993404', '#662506'],\n        YlGn: ['#ffffe5', '#f7fcb9', '#d9f0a3', '#addd8e', '#78c679', '#41ab5d', '#238443', '#006837', '#004529'],\n        Reds: ['#fff5f0', '#fee0d2', '#fcbba1', '#fc9272', '#fb6a4a', '#ef3b2c', '#cb181d', '#a50f15', '#67000d'],\n        RdPu: ['#fff7f3', '#fde0dd', '#fcc5c0', '#fa9fb5', '#f768a1', '#dd3497', '#ae017e', '#7a0177', '#49006a'],\n        Greens: ['#f7fcf5', '#e5f5e0', '#c7e9c0', '#a1d99b', '#74c476', '#41ab5d', '#238b45', '#006d2c', '#00441b'],\n        YlGnBu: ['#ffffd9', '#edf8b1', '#c7e9b4', '#7fcdbb', '#41b6c4', '#1d91c0', '#225ea8', '#253494', '#081d58'],\n        Purples: ['#fcfbfd', '#efedf5', '#dadaeb', '#bcbddc', '#9e9ac8', '#807dba', '#6a51a3', '#54278f', '#3f007d'],\n        GnBu: ['#f7fcf0', '#e0f3db', '#ccebc5', '#a8ddb5', '#7bccc4', '#4eb3d3', '#2b8cbe', '#0868ac', '#084081'],\n        Greys: ['#ffffff', '#f0f0f0', '#d9d9d9', '#bdbdbd', '#969696', '#737373', '#525252', '#252525', '#000000'],\n        YlOrRd: ['#ffffcc', '#ffeda0', '#fed976', '#feb24c', '#fd8d3c', '#fc4e2a', '#e31a1c', '#bd0026', '#800026'],\n        PuRd: ['#f7f4f9', '#e7e1ef', '#d4b9da', '#c994c7', '#df65b0', '#e7298a', '#ce1256', '#980043', '#67001f'],\n        Blues: ['#f7fbff', '#deebf7', '#c6dbef', '#9ecae1', '#6baed6', '#4292c6', '#2171b5', '#08519c', '#08306b'],\n        PuBuGn: ['#fff7fb', '#ece2f0', '#d0d1e6', '#a6bddb', '#67a9cf', '#3690c0', '#02818a', '#016c59', '#014636'],\n        Viridis: ['#440154', '#482777', '#3f4a8a', '#31678e', '#26838f', '#1f9d8a', '#6cce5a', '#b6de2b', '#fee825'],\n\n        // diverging\n\n        Spectral: ['#9e0142', '#d53e4f', '#f46d43', '#fdae61', '#fee08b', '#ffffbf', '#e6f598', '#abdda4', '#66c2a5', '#3288bd', '#5e4fa2'],\n        RdYlGn: ['#a50026', '#d73027', '#f46d43', '#fdae61', '#fee08b', '#ffffbf', '#d9ef8b', '#a6d96a', '#66bd63', '#1a9850', '#006837'],\n        RdBu: ['#67001f', '#b2182b', '#d6604d', '#f4a582', '#fddbc7', '#f7f7f7', '#d1e5f0', '#92c5de', '#4393c3', '#2166ac', '#053061'],\n        PiYG: ['#8e0152', '#c51b7d', '#de77ae', '#f1b6da', '#fde0ef', '#f7f7f7', '#e6f5d0', '#b8e186', '#7fbc41', '#4d9221', '#276419'],\n        PRGn: ['#40004b', '#762a83', '#9970ab', '#c2a5cf', '#e7d4e8', '#f7f7f7', '#d9f0d3', '#a6dba0', '#5aae61', '#1b7837', '#00441b'],\n        RdYlBu: ['#a50026', '#d73027', '#f46d43', '#fdae61', '#fee090', '#ffffbf', '#e0f3f8', '#abd9e9', '#74add1', '#4575b4', '#313695'],\n        BrBG: ['#543005', '#8c510a', '#bf812d', '#dfc27d', '#f6e8c3', '#f5f5f5', '#c7eae5', '#80cdc1', '#35978f', '#01665e', '#003c30'],\n        RdGy: ['#67001f', '#b2182b', '#d6604d', '#f4a582', '#fddbc7', '#ffffff', '#e0e0e0', '#bababa', '#878787', '#4d4d4d', '#1a1a1a'],\n        PuOr: ['#7f3b08', '#b35806', '#e08214', '#fdb863', '#fee0b6', '#f7f7f7', '#d8daeb', '#b2abd2', '#8073ac', '#542788', '#2d004b'],\n\n        // qualitative\n\n        Set2: ['#66c2a5', '#fc8d62', '#8da0cb', '#e78ac3', '#a6d854', '#ffd92f', '#e5c494', '#b3b3b3'],\n        Accent: ['#7fc97f', '#beaed4', '#fdc086', '#ffff99', '#386cb0', '#f0027f', '#bf5b17', '#666666'],\n        Set1: ['#e41a1c', '#377eb8', '#4daf4a', '#984ea3', '#ff7f00', '#ffff33', '#a65628', '#f781bf', '#999999'],\n        Set3: ['#8dd3c7', '#ffffb3', '#bebada', '#fb8072', '#80b1d3', '#fdb462', '#b3de69', '#fccde5', '#d9d9d9', '#bc80bd', '#ccebc5', '#ffed6f'],\n        Dark2: ['#1b9e77', '#d95f02', '#7570b3', '#e7298a', '#66a61e', '#e6ab02', '#a6761d', '#666666'],\n        Paired: ['#a6cee3', '#1f78b4', '#b2df8a', '#33a02c', '#fb9a99', '#e31a1c', '#fdbf6f', '#ff7f00', '#cab2d6', '#6a3d9a', '#ffff99', '#b15928'],\n        Pastel2: ['#b3e2cd', '#fdcdac', '#cbd5e8', '#f4cae4', '#e6f5c9', '#fff2ae', '#f1e2cc', '#cccccc'],\n        Pastel1: ['#fbb4ae', '#b3cde3', '#ccebc5', '#decbe4', '#fed9a6', '#ffffcc', '#e5d8bd', '#fddaec', '#f2f2f2'],\n    };\n\n    // add lowercase aliases for case-insensitive matches\n    for (var i$1 = 0, list$1 = Object.keys(colorbrewer); i$1 < list$1.length; i$1 += 1) {\n        var key = list$1[i$1];\n\n        colorbrewer[key.toLowerCase()] = colorbrewer[key];\n    }\n\n    var colorbrewer_1 = colorbrewer;\n\n    // feel free to comment out anything to rollup\n    // a smaller chroma.js built\n\n    // io --> convert colors\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n    // operators --> modify existing Colors\n\n\n\n\n\n\n\n\n\n\n    // interpolators\n\n\n\n\n\n\n\n\n\n\n    // generators -- > create new colors\n    chroma_1.average = average;\n    chroma_1.bezier = bezier_1;\n    chroma_1.blend = blend_1;\n    chroma_1.cubehelix = cubehelix;\n    chroma_1.mix = chroma_1.interpolate = mix;\n    chroma_1.random = random_1;\n    chroma_1.scale = scale;\n\n    // other utility methods\n    chroma_1.analyze = analyze_1.analyze;\n    chroma_1.contrast = contrast;\n    chroma_1.deltaE = deltaE;\n    chroma_1.distance = distance;\n    chroma_1.limits = analyze_1.limits;\n    chroma_1.valid = valid;\n\n    // scale\n    chroma_1.scales = scales;\n\n    // colors\n    chroma_1.colors = w3cx11_1;\n    chroma_1.brewer = colorbrewer_1;\n\n    var chroma_js = chroma_1;\n\n    return chroma_js;\n\n})));\n","/**\n * Unwrap a coordinate from a Point Feature, Geometry or a single coordinate.\n *\n * @name getCoord\n * @param {Array<number>|Geometry<Point>|Feature<Point>} obj Object\n * @returns {Array<number>} coordinates\n * @example\n * var pt = turf.point([10, 10]);\n *\n * var coord = turf.getCoord(pt);\n * //= [10, 10]\n */\nfunction getCoord(obj) {\n    if (!obj) throw new Error('obj is required');\n\n    var coordinates = getCoords(obj);\n\n    // getCoord() must contain at least two numbers (Point)\n    if (coordinates.length > 1 &&\n        typeof coordinates[0] === 'number' &&\n        typeof coordinates[1] === 'number') {\n        return coordinates;\n    } else {\n        throw new Error('Coordinate is not a valid Point');\n    }\n}\n\n/**\n * Unwrap coordinates from a Feature, Geometry Object or an Array of numbers\n *\n * @name getCoords\n * @param {Array<number>|Geometry|Feature} obj Object\n * @returns {Array<number>} coordinates\n * @example\n * var poly = turf.polygon([[[119.32, -8.7], [119.55, -8.69], [119.51, -8.54], [119.32, -8.7]]]);\n *\n * var coord = turf.getCoords(poly);\n * //= [[[119.32, -8.7], [119.55, -8.69], [119.51, -8.54], [119.32, -8.7]]]\n */\nfunction getCoords(obj) {\n    if (!obj) throw new Error('obj is required');\n    var coordinates;\n\n    // Array of numbers\n    if (obj.length) {\n        coordinates = obj;\n\n    // Geometry Object\n    } else if (obj.coordinates) {\n        coordinates = obj.coordinates;\n\n    // Feature\n    } else if (obj.geometry && obj.geometry.coordinates) {\n        coordinates = obj.geometry.coordinates;\n    }\n    // Checks if coordinates contains a number\n    if (coordinates) {\n        containsNumber(coordinates);\n        return coordinates;\n    }\n    throw new Error('No valid coordinates');\n}\n\n/**\n * Checks if coordinates contains a number\n *\n * @name containsNumber\n * @param {Array<any>} coordinates GeoJSON Coordinates\n * @returns {boolean} true if Array contains a number\n */\nfunction containsNumber(coordinates) {\n    if (coordinates.length > 1 &&\n        typeof coordinates[0] === 'number' &&\n        typeof coordinates[1] === 'number') {\n        return true;\n    }\n\n    if (Array.isArray(coordinates[0]) && coordinates[0].length) {\n        return containsNumber(coordinates[0]);\n    }\n    throw new Error('coordinates must only contain numbers');\n}\n\n/**\n * Enforce expectations about types of GeoJSON objects for Turf.\n *\n * @name geojsonType\n * @param {GeoJSON} value any GeoJSON object\n * @param {string} type expected GeoJSON type\n * @param {string} name name of calling function\n * @throws {Error} if value is not the expected type.\n */\nfunction geojsonType(value, type, name) {\n    if (!type || !name) throw new Error('type and name required');\n\n    if (!value || value.type !== type) {\n        throw new Error('Invalid input to ' + name + ': must be a ' + type + ', given ' + value.type);\n    }\n}\n\n/**\n * Enforce expectations about types of {@link Feature} inputs for Turf.\n * Internally this uses {@link geojsonType} to judge geometry types.\n *\n * @name featureOf\n * @param {Feature} feature a feature with an expected geometry type\n * @param {string} type expected GeoJSON type\n * @param {string} name name of calling function\n * @throws {Error} error if value is not the expected type.\n */\nfunction featureOf(feature, type, name) {\n    if (!feature) throw new Error('No feature passed');\n    if (!name) throw new Error('.featureOf() requires a name');\n    if (!feature || feature.type !== 'Feature' || !feature.geometry) {\n        throw new Error('Invalid input to ' + name + ', Feature with geometry required');\n    }\n    if (!feature.geometry || feature.geometry.type !== type) {\n        throw new Error('Invalid input to ' + name + ': must be a ' + type + ', given ' + feature.geometry.type);\n    }\n}\n\n/**\n * Enforce expectations about types of {@link FeatureCollection} inputs for Turf.\n * Internally this uses {@link geojsonType} to judge geometry types.\n *\n * @name collectionOf\n * @param {FeatureCollection} featureCollection a FeatureCollection for which features will be judged\n * @param {string} type expected GeoJSON type\n * @param {string} name name of calling function\n * @throws {Error} if value is not the expected type.\n */\nfunction collectionOf(featureCollection, type, name) {\n    if (!featureCollection) throw new Error('No featureCollection passed');\n    if (!name) throw new Error('.collectionOf() requires a name');\n    if (!featureCollection || featureCollection.type !== 'FeatureCollection') {\n        throw new Error('Invalid input to ' + name + ', FeatureCollection required');\n    }\n    for (var i = 0; i < featureCollection.features.length; i++) {\n        var feature = featureCollection.features[i];\n        if (!feature || feature.type !== 'Feature' || !feature.geometry) {\n            throw new Error('Invalid input to ' + name + ', Feature with geometry required');\n        }\n        if (!feature.geometry || feature.geometry.type !== type) {\n            throw new Error('Invalid input to ' + name + ': must be a ' + type + ', given ' + feature.geometry.type);\n        }\n    }\n}\n\n/**\n * Get Geometry from Feature or Geometry Object\n *\n * @param {Feature|Geometry} geojson GeoJSON Feature or Geometry Object\n * @returns {Geometry|null} GeoJSON Geometry Object\n * @throws {Error} if geojson is not a Feature or Geometry Object\n * @example\n * var point = {\n *   \"type\": \"Feature\",\n *   \"properties\": {},\n *   \"geometry\": {\n *     \"type\": \"Point\",\n *     \"coordinates\": [110, 40]\n *   }\n * }\n * var geom = turf.getGeom(point)\n * //={\"type\": \"Point\", \"coordinates\": [110, 40]}\n */\nfunction getGeom(geojson) {\n    if (!geojson) throw new Error('geojson is required');\n    if (geojson.geometry !== undefined) return geojson.geometry;\n    if (geojson.coordinates || geojson.geometries) return geojson;\n    throw new Error('geojson must be a valid Feature or Geometry Object');\n}\n\n/**\n * Get Geometry Type from Feature or Geometry Object\n *\n * @param {Feature|Geometry} geojson GeoJSON Feature or Geometry Object\n * @returns {string} GeoJSON Geometry Type\n * @throws {Error} if geojson is not a Feature or Geometry Object\n * @example\n * var point = {\n *   \"type\": \"Feature\",\n *   \"properties\": {},\n *   \"geometry\": {\n *     \"type\": \"Point\",\n *     \"coordinates\": [110, 40]\n *   }\n * }\n * var geom = turf.getGeomType(point)\n * //=\"Point\"\n */\nfunction getGeomType(geojson) {\n    if (!geojson) throw new Error('geojson is required');\n    var geom = getGeom(geojson);\n    if (geom) return geom.type;\n}\n\nmodule.exports = {\n    geojsonType: geojsonType,\n    collectionOf: collectionOf,\n    featureOf: featureOf,\n    getCoord: getCoord,\n    getCoords: getCoords,\n    containsNumber: containsNumber,\n    getGeom: getGeom,\n    getGeomType: getGeomType\n};\n","/*\r\n  1.0.1 (downloaded from https://github.com/Sumbera/gLayers.Leaflet/releases/tag/v1.0.1)\r\n\r\n  Generic  Canvas Layer for leaflet 0.7 and 1.0-rc,\r\n  copyright Stanislav Sumbera,  2016 , sumbera.com , license MIT\r\n  originally created and motivated by L.CanvasOverlay  available here: https://gist.github.com/Sumbera/11114288\r\n*/\r\n\r\nL.CanvasLayer = L.Layer.extend({\r\n\t\r\n    // -- initialized is called on prototype\r\n    initialize: function (options) {\r\n        this._map = null;\r\n        this._canvas = null;\r\n        this._frame = null;\r\n        this._delegate = null;\r\n        L.setOptions(this, options);\r\n    },\r\n\r\n    delegate: function (del) {\r\n        this._delegate = del;\r\n        return this;\r\n    },\r\n\r\n    needRedraw: function () {\r\n        if (!this._frame) {\r\n            this._frame = L.Util.requestAnimFrame(this.drawLayer, this);\r\n        }\r\n        return this;\r\n    },\r\n\r\n    //-------------------------------------------------------------\r\n    _onLayerDidResize: function (resizeEvent) {\r\n        this._canvas.width = resizeEvent.newSize.x;\r\n        this._canvas.height = resizeEvent.newSize.y;\r\n    },\r\n    \r\n    //-------------------------------------------------------------\r\n    _onLayerDidMove: function () {\r\n        var topLeft = this._map.containerPointToLayerPoint([0, 0]);\r\n        L.DomUtil.setPosition(this._canvas, topLeft);\r\n        this.drawLayer();\r\n    },\r\n    \r\n    //-------------------------------------------------------------\r\n    getEvents: function () {\r\n        var events = {\r\n            resize: this._onLayerDidResize,\r\n            moveend: this._onLayerDidMove\r\n        };\r\n        if (this._map.options.zoomAnimation && L.Browser.any3d) {\r\n            events.zoomanim = this._animateZoom;\r\n        }\r\n\r\n        return events;\r\n    },\r\n    //-------------------------------------------------------------\r\n    onAdd: function (map) {\r\n        this._map = map;\r\n        this._canvas = L.DomUtil.create('canvas', 'leaflet-layer');\r\n        this.tiles = {};\r\n\r\n        var size = this._map.getSize();\r\n        this._canvas.width = size.x;\r\n        this._canvas.height = size.y;\r\n\r\n        var animated = this._map.options.zoomAnimation && L.Browser.any3d;\r\n        L.DomUtil.addClass(this._canvas, 'leaflet-zoom-' + (animated ? 'animated' : 'hide'));\r\n\r\n        let pane = this.options.pane ? map.getPanes()[this.options.pane] : map._panes.overlayPane;\r\n        pane.appendChild(this._canvas);\r\n\r\n        map.on(this.getEvents(), this);\r\n\r\n        var del = this._delegate || this;\r\n        del.onLayerDidMount && del.onLayerDidMount(); // -- callback\r\n\r\n        this.needRedraw();\r\n    },\r\n\r\n    //-------------------------------------------------------------\r\n    onRemove: function (map) {\r\n        var del = this._delegate || this;\r\n        del.onLayerWillUnmount && del.onLayerWillUnmount(); // -- callback\r\n\r\n        let pane = this.options.pane ? map.getPanes()[this.options.pane] : map._panes.overlayPane;\r\n        pane.removeChild(this._canvas);\r\n\r\n        map.off(this.getEvents(), this);\r\n\r\n        this._canvas = null;\r\n    },\r\n\r\n    //------------------------------------------------------------\r\n    addTo: function (map) {\r\n        map.addLayer(this);\r\n        return this;\r\n    },\r\n    \r\n    // --------------------------------------------------------------------------------\r\n    LatLonToMercator: function (latlon) {\r\n        return {\r\n            x: latlon.lng * 6378137 * Math.PI / 180,\r\n            y: Math.log(Math.tan((90 + latlon.lat) * Math.PI / 360)) * 6378137\r\n        };\r\n    },\r\n\r\n    //------------------------------------------------------------------------------\r\n    drawLayer: function () {\r\n        // -- todo make the viewInfo properties  flat objects.\r\n        var size = this._map.getSize();\r\n        var bounds = this._map.getBounds();\r\n        var zoom = this._map.getZoom();\r\n\r\n        var center = this.LatLonToMercator(this._map.getCenter());\r\n        var corner = this.LatLonToMercator(this._map.containerPointToLatLng(this._map.getSize()));\r\n\r\n        var del = this._delegate || this;\r\n        del.onDrawLayer && del.onDrawLayer({\r\n            layer: this,\r\n            canvas: this._canvas,\r\n            bounds: bounds,\r\n            size: size,\r\n            zoom: zoom,\r\n            center: center,\r\n            corner: corner\r\n        });\r\n        this._frame = null;\r\n    },\r\n\r\n    //------------------------------------------------------------------------------\r\n    _animateZoom: function (e) {\r\n        var scale = this._map.getZoomScale(e.zoom);\r\n        var offset = this._map._latLngToNewLayerPoint(this._map.getBounds().getNorthWest(), e.zoom, e.center);\r\n\r\n        L.DomUtil.setTransform(this._canvas, offset, scale);\r\n    }\r\n});\r\n\r\nL.canvasLayer = function () {\r\n    return new L.CanvasLayer();\r\n};\r\n","/**\r\n *  Simple layer with lon-lat points\r\n *\r\n *  TODO rename to SimplePoint?\r\n */\r\nL.CanvasLayer.SimpleLonLat = L.CanvasLayer.extend({\r\n    options: {\r\n        color: 'gray',\r\n        size: 2\r\n    },\r\n\r\n    initialize: function(points, options) {\r\n        this.points = points;\r\n        L.Util.setOptions(this, options);\r\n    },\r\n\r\n    onLayerDidMount: function() {\r\n        // -- prepare custom drawing\r\n    },\r\n\r\n    onLayerWillUnmount: function() {\r\n        // -- custom cleanup\r\n    },\r\n\r\n    /* eslint-disable no-unused-vars */\r\n    setData: function(data) {\r\n        // -- custom data set\r\n        this.needRedraw(); // -- call to drawLayer\r\n    },\r\n    /* eslint-enable no-unused-vars */\r\n\r\n    onDrawLayer: function(viewInfo) {\r\n        // canvas preparation\r\n        let g = viewInfo.canvas.getContext('2d');\r\n        g.clearRect(0, 0, viewInfo.canvas.width, viewInfo.canvas.height);\r\n        g.fillStyle = this.options.color;\r\n\r\n        for (let point of this.points) {\r\n            let p = viewInfo.layer._map.latLngToContainerPoint(point);\r\n            g.beginPath();\r\n            //g.arc(p.x, p.y, 1, 0, Math.PI * 2); // circle | TODO style 'function' as parameter?\r\n            g.fillRect(p.x, p.y, this.options.size, this.options.size); //simple point\r\n            g.fill();\r\n            g.closePath();\r\n            g.stroke();\r\n        }\r\n    },\r\n\r\n    getBounds: function() {\r\n        // TODO: bounding with points...\r\n        let xs = this.points.map(pt => pt.lng);\r\n        let ys = this.points.map(pt => pt.lat);\r\n\r\n        let xmin = Math.min(...xs);\r\n        let ymin = Math.min(...ys);\r\n        let xmax = Math.max(...xs);\r\n        let ymax = Math.max(...ys);\r\n\r\n        let southWest = L.latLng(ymin, xmin),\r\n            northEast = L.latLng(ymax, xmax);\r\n        let bounds = L.latLngBounds(southWest, northEast); // TODO FIX ERROR ? half-pixel?\r\n        return bounds;\r\n    }\r\n});\r\n\r\nL.canvasLayer.simpleLonLat = function(lonslats, options) {\r\n    return new L.CanvasLayer.SimpleLonLat(lonslats, options);\r\n};\r\n","/**\r\n * Abstract class for a Field layer on canvas, aka 'a Raster layer'\r\n * (ScalarField or a VectorField)\r\n */\r\nL.CanvasLayer.Field = L.CanvasLayer.extend({\r\n    options: {\r\n        mouseMoveCursor: {\r\n            value: 'pointer',\r\n            noValue: 'default'\r\n        },\r\n        opacity: 1,\r\n        onClick: null,\r\n        onMouseMove: null,\r\n        inFilter: null\r\n    },\r\n\r\n    initialize: function(field, options) {\r\n        L.Util.setOptions(this, options);\r\n        this._visible = true;\r\n        if (field) {\r\n            this.setData(field);\r\n        }\r\n    },\r\n\r\n    getEvents: function() {\r\n        var events = L.CanvasLayer.prototype.getEvents.call(this);\r\n        events.zoomstart = this._hideCanvas.bind(this);\r\n        events.zoomend = this._showCanvas.bind(this);\r\n        return events;\r\n    },\r\n\r\n    onLayerDidMount: function() {\r\n        this._enableIdentify();\r\n        this._ensureCanvasAlignment();\r\n    },\r\n\r\n    show() {\r\n        this._visible = true;\r\n        this._showCanvas();\r\n        this._enableIdentify();\r\n    },\r\n\r\n    hide() {\r\n        this._visible = false;\r\n        this._hideCanvas();\r\n        this._disableIdentify();\r\n    },\r\n\r\n    isVisible() {\r\n        return this._visible;\r\n    },\r\n\r\n    _showCanvas() {\r\n        if (this._canvas && this._visible) {\r\n            this._canvas.style.visibility = 'visible';\r\n        }\r\n    },\r\n\r\n    _hideCanvas() {\r\n        if (this._canvas) {\r\n            this._canvas.style.visibility = 'hidden';\r\n        }\r\n    },\r\n\r\n    _enableIdentify() {\r\n        this._map.on('click', this._onClick, this);\r\n        this._map.on('mousemove', this._onMouseMove, this);\r\n\r\n        this.options.onClick && this.on('click', this.options.onClick, this);\r\n        this.options.onMouseMove &&\r\n            this.on('mousemove', this.options.onMouseMove, this);\r\n    },\r\n\r\n    _disableIdentify() {\r\n        this._map.off('click', this._onClick, this);\r\n        this._map.off('mousemove', this._onMouseMove, this);\r\n\r\n        this.options.onClick && this.off('click', this.options.onClick, this);\r\n        this.options.onMouseMove &&\r\n            this.off('mousemove', this.options.onMouseMove, this);\r\n    },\r\n\r\n    _ensureCanvasAlignment() {\r\n        var topLeft = this._map.containerPointToLayerPoint([0, 0]);\r\n        L.DomUtil.setPosition(this._canvas, topLeft);\r\n    },\r\n\r\n    onLayerWillUnmount: function() {\r\n        this._disableIdentify();\r\n    },\r\n\r\n    needRedraw() {\r\n        if (this._map && this._field) {\r\n            L.CanvasLayer.prototype.needRedraw.call(this);\r\n        }\r\n    },\r\n\r\n    /* eslint-disable no-unused-vars */\r\n    onDrawLayer: function(viewInfo) {\r\n        throw new TypeError('Must be overriden');\r\n    },\r\n    /* eslint-enable no-unused-vars */\r\n\r\n    setData: function(field) {\r\n        this.options.inFilter && field.setFilter(this.options.inFilter);\r\n        this._field = field;\r\n        this.needRedraw();\r\n        this.fire('load');\r\n    },\r\n\r\n    setFilter: function(f) {\r\n        this.options.inFilter = f;\r\n        this._field && this._field.setFilter(f);\r\n        this.needRedraw();\r\n    },\r\n\r\n    setOpacity: function(opacity) {\r\n        this.options.opacity = opacity;\r\n\r\n        if (this._canvas) {\r\n            this._updateOpacity();\r\n        }\r\n        return this;\r\n    },\r\n\r\n    getBounds: function() {\r\n        let bb = this._field.extent();\r\n\r\n        let southWest = L.latLng(bb[1], bb[0]),\r\n            northEast = L.latLng(bb[3], bb[2]);\r\n        let bounds = L.latLngBounds(southWest, northEast);\r\n        return bounds;\r\n    },\r\n\r\n    _onClick: function(e) {\r\n        let v = this._queryValue(e);\r\n        this.fire('click', v);\r\n    },\r\n\r\n    _onMouseMove: function(e) {\r\n        let v = this._queryValue(e);\r\n        this._changeCursorOn(v);\r\n        this.fire('mousemove', v);\r\n    },\r\n\r\n    _changeCursorOn: function(v) {\r\n        if (!this.options.mouseMoveCursor) return;\r\n\r\n        let { value, noValue } = this.options.mouseMoveCursor;\r\n        let style = this._map.getContainer().style;\r\n        style.cursor = v.value !== null ? value : noValue;\r\n    },\r\n\r\n    _updateOpacity: function() {\r\n        L.DomUtil.setOpacity(this._canvas, this.options.opacity);\r\n    },\r\n\r\n    _queryValue: function(e) {\r\n        let v = this._field\r\n            ? this._field.valueAt(e.latlng.lng, e.latlng.lat)\r\n            : null;\r\n        let result = {\r\n            latlng: e.latlng,\r\n            value: v\r\n        };\r\n        return result;\r\n    },\r\n\r\n    _getDrawingContext: function() {\r\n        let g = this._canvas.getContext('2d');\r\n        g.clearRect(0, 0, this._canvas.width, this._canvas.height);\r\n        return g;\r\n    }\r\n});\r\n","import Cell from '../Cell';\r\nimport chroma from 'chroma-js';\r\n/**\r\n * ScalarField on canvas (a 'Raster')\r\n */\r\nL.CanvasLayer.ScalarField = L.CanvasLayer.Field.extend({\r\n    options: {\r\n        type: 'colormap', // [colormap|vector]\r\n        color: null, // function colorFor(value) [e.g. chromajs.scale],\r\n        interpolate: false, // Change to use interpolation\r\n        vectorSize: 20, // only used if 'vector'\r\n        arrowDirection: 'from' // [from|towards]\r\n    },\r\n\r\n    initialize: function(scalarField, options) {\r\n        L.CanvasLayer.Field.prototype.initialize.call(\r\n            this,\r\n            scalarField,\r\n            options\r\n        );\r\n        L.Util.setOptions(this, options);\r\n    },\r\n\r\n    _defaultColorScale: function() {\r\n        return chroma.scale(['white', 'black']).domain(this._field.range);\r\n    },\r\n\r\n    setColor(f) {\r\n        this.options.color = f; //color scale\r\n        this.needRedraw();\r\n    },\r\n\r\n    /* eslint-disable no-unused-vars */\r\n    onDrawLayer: function(viewInfo) {\r\n        if (!this.isVisible()) return;\r\n        this._updateOpacity();\r\n\r\n        let r = this._getRendererMethod();\r\n        //console.time('onDrawLayer');\r\n        r();\r\n        //console.timeEnd('onDrawLayer');\r\n    },\r\n    /* eslint-enable no-unused-vars */\r\n\r\n    _getRendererMethod: function() {\r\n        switch (this.options.type) {\r\n            case 'colormap':\r\n                return this._drawImage.bind(this);\r\n            case 'vector':\r\n                return this._drawArrows.bind(this);\r\n            default:\r\n                throw Error(`Unkwown renderer type: ${this.options.type}`);\r\n        }\r\n    },\r\n\r\n    _ensureColor: function() {\r\n        if (this.options.color === null) {\r\n            this.setColor(this._defaultColorScale());\r\n        }\r\n    },\r\n\r\n    _showCanvas() {\r\n        L.CanvasLayer.Field.prototype._showCanvas.call(this);\r\n        this.needRedraw(); // TODO check spurious redraw (e.g. hide/show without moving map)\r\n    },\r\n\r\n    /**\r\n     * Draws the field in an ImageData and applying it with putImageData.\r\n     * Used as a reference: http://geoexamples.com/d3-raster-tools-docs/code_samples/raster-pixels-page.html\r\n     */\r\n    _drawImage: function() {\r\n        this._ensureColor();\r\n\r\n        let ctx = this._getDrawingContext();\r\n        let width = this._canvas.width;\r\n        let height = this._canvas.height;\r\n\r\n        let img = ctx.createImageData(width, height);\r\n        let data = img.data;\r\n\r\n        this._prepareImageIn(data, width, height);\r\n        ctx.putImageData(img, 0, 0);\r\n    },\r\n\r\n    /**\r\n     * Prepares the image in data, as array with RGBAs\r\n     * [R1, G1, B1, A1, R2, G2, B2, A2...]\r\n     * @private\r\n     * @param {[[Type]]} data   [[Description]]\r\n     * @param {Numver} width\r\n     * @param {Number} height\r\n     */\r\n    _prepareImageIn(data, width, height) {\r\n        let f = this.options.interpolate ? 'interpolatedValueAt' : 'valueAt';\r\n\r\n        let pos = 0;\r\n        for (let j = 0; j < height; j++) {\r\n            for (let i = 0; i < width; i++) {\r\n                let pointCoords = this._map.containerPointToLatLng([i, j]);\r\n                let lon = pointCoords.lng;\r\n                let lat = pointCoords.lat;\r\n\r\n                let v = this._field[f](lon, lat); // 'valueAt' | 'interpolatedValueAt' || TODO check some 'artifacts'\r\n                if (v !== null) {\r\n                    let [R, G, B, A] = this._getColorFor(v);                    \r\n                    data[pos] = R;\r\n                    data[pos + 1] = G;\r\n                    data[pos + 2] = B;\r\n                    data[pos + 3] = parseInt(A * 255); // not percent in alpha but hex 0-255\r\n                }\r\n                pos = pos + 4;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Draws the field as a set of arrows. Direction from 0 to 360 is assumed.\r\n     */\r\n    _drawArrows: function() {\r\n        const bounds = this._pixelBounds();\r\n        const pixelSize = (bounds.max.x - bounds.min.x) / this._field.nCols;\r\n\r\n        var stride = Math.max(\r\n            1,\r\n            Math.floor(1.2 * this.options.vectorSize / pixelSize)\r\n        );\r\n\r\n        const ctx = this._getDrawingContext();\r\n        ctx.strokeStyle = this.options.color;\r\n\r\n        var currentBounds = this._map.getBounds();\r\n\r\n        for (var y = 0; y < this._field.height; y = y + stride) {\r\n            for (var x = 0; x < this._field.width; x = x + stride) {\r\n                let [lon, lat] = this._field._lonLatAtIndexes(x, y);\r\n                let v = this._field.valueAt(lon, lat);\r\n                let center = L.latLng(lat, lon);\r\n                if (v !== null && currentBounds.contains(center)) {\r\n                    let cell = new Cell(\r\n                        center,\r\n                        v,\r\n                        this.cellXSize,\r\n                        this.cellYSize\r\n                    );\r\n                    this._drawArrow(cell, ctx);\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    _pixelBounds: function() {\r\n        const bounds = this.getBounds();\r\n        const northWest = this._map.latLngToContainerPoint(\r\n            bounds.getNorthWest()\r\n        );\r\n        const southEast = this._map.latLngToContainerPoint(\r\n            bounds.getSouthEast()\r\n        );\r\n        var pixelBounds = L.bounds(northWest, southEast);\r\n        return pixelBounds;\r\n    },\r\n\r\n    _drawArrow: function(cell, ctx) {\r\n        var projected = this._map.latLngToContainerPoint(cell.center);\r\n\r\n        // colormap vs. simple color\r\n        let color = this.options.color;\r\n        if (typeof color === 'function') {\r\n            ctx.strokeStyle = color(cell.value);\r\n        }\r\n\r\n        const size = this.options.vectorSize;\r\n        ctx.save();\r\n\r\n        ctx.translate(projected.x, projected.y);\r\n\r\n        let rotationRads = (90 + cell.value) * Math.PI / 180; // from, by default\r\n        if (this.options.arrowDirection === 'towards') {\r\n            rotationRads = rotationRads + Math.PI;\r\n        }\r\n        ctx.rotate(rotationRads);\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(-size / 2, 0);\r\n        ctx.lineTo(+size / 2, 0);\r\n        ctx.moveTo(size * 0.25, -size * 0.25);\r\n        ctx.lineTo(+size / 2, 0);\r\n        ctx.lineTo(size * 0.25, size * 0.25);\r\n        ctx.stroke();\r\n        ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * Gets a chroma color for a pixel value, according to 'options.color'\r\n     */\r\n    _getColorFor(v) {        \r\n        let rgba = this.options.color(v).rgba();\r\n        return rgba;\r\n    }\r\n});\r\n\r\nL.canvasLayer.scalarField = function(scalarField, options) {\r\n    return new L.CanvasLayer.ScalarField(scalarField, options);\r\n};\r\n","/**\r\n * Animated VectorField on canvas\r\n */\r\nL.CanvasLayer.VectorFieldAnim = L.CanvasLayer.Field.extend({\r\n    options: {\r\n        paths: 800,\r\n        color: 'white', // html-color | function colorFor(value) [e.g. chromajs.scale]\r\n        width: 1.0, // number | function widthFor(value)\r\n        fade: 0.96, // 0 to 1\r\n        duration: 20, // milliseconds per 'frame'\r\n        maxAge: 200, // number of maximum frames per path\r\n        velocityScale: 1 / 5000\r\n    },\r\n\r\n    initialize: function(vectorField, options) {\r\n        L.CanvasLayer.Field.prototype.initialize.call(\r\n            this,\r\n            vectorField,\r\n            options\r\n        );\r\n        L.Util.setOptions(this, options);\r\n\r\n        this.timer = null;\r\n    },\r\n\r\n    onLayerDidMount: function() {\r\n        L.CanvasLayer.Field.prototype.onLayerDidMount.call(this);\r\n        this._map.on('move resize', this._stopAnimation, this);\r\n    },\r\n\r\n    onLayerWillUnmount: function() {\r\n        L.CanvasLayer.Field.prototype.onLayerWillUnmount.call(this);\r\n        this._map.off('move resize', this._stopAnimation, this);\r\n        this._stopAnimation();\r\n    },\r\n\r\n    _hideCanvas: function _showCanvas() {\r\n        L.CanvasLayer.Field.prototype._hideCanvas.call(this);\r\n        this._stopAnimation();\r\n    },\r\n\r\n    onDrawLayer: function(viewInfo) {\r\n        if (!this._field || !this.isVisible()) return;\r\n\r\n        this._updateOpacity();\r\n\r\n        let ctx = this._getDrawingContext();\r\n        let paths = this._prepareParticlePaths();\r\n\r\n        this.timer = d3.timer(function() {\r\n            _moveParticles();\r\n            _drawParticles();\r\n        }, this.options.duration);\r\n\r\n        let self = this;\r\n\r\n        /**\r\n         * Builds the paths, adding 'particles' on each animation step, considering\r\n         * their properties (age / position source > target)\r\n         */\r\n        function _moveParticles() {\r\n            // let screenFactor = 1 / self._map.getZoom(); // consider using a 'screenFactor' to ponderate velocityScale\r\n            paths.forEach(function(par) {\r\n                if (par.age > self.options.maxAge) {\r\n                    // restart, on a random x,y\r\n                    par.age = 0;\r\n                    self._field.randomPosition(par);\r\n                }\r\n\r\n                let vector = self._field.valueAt(par.x, par.y);\r\n                if (vector === null) {\r\n                    par.age = self.options.maxAge;\r\n                } else {\r\n                    // the next point will be...\r\n                    let xt = par.x + vector.u * self.options.velocityScale; //* screenFactor;\r\n                    let yt = par.y + vector.v * self.options.velocityScale; //* screenFactor;\r\n\r\n                    if (self._field.hasValueAt(xt, yt)) {\r\n                        par.xt = xt;\r\n                        par.yt = yt;\r\n                        par.m = vector.magnitude();\r\n                    } else {\r\n                        // not visible anymore...\r\n                        par.age = self.options.maxAge;\r\n                    }\r\n                }\r\n                par.age += 1;\r\n            });\r\n        }\r\n\r\n        /**\r\n         * Draws the paths on each step\r\n         */\r\n        function _drawParticles() {\r\n            // Previous paths...\r\n            let prev = ctx.globalCompositeOperation;\r\n            ctx.globalCompositeOperation = 'destination-in';\r\n            ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n            //ctx.globalCompositeOperation = 'source-over';\r\n            ctx.globalCompositeOperation = prev;\r\n\r\n            // fading paths...\r\n            ctx.fillStyle = `rgba(0, 0, 0, ${self.options.fade})`;\r\n            ctx.lineWidth = self.options.width;\r\n            ctx.strokeStyle = self.options.color;\r\n\r\n            // New paths\r\n            paths.forEach(function(par) {\r\n                self._drawParticle(viewInfo, ctx, par);\r\n            });\r\n        }\r\n    },\r\n\r\n    _drawParticle(viewInfo, ctx, par) {\r\n        let source = new L.latLng(par.y, par.x);\r\n        let target = new L.latLng(par.yt, par.xt);\r\n\r\n        if (\r\n            viewInfo.bounds.contains(source) &&\r\n            par.age <= this.options.maxAge\r\n        ) {\r\n            let pA = viewInfo.layer._map.latLngToContainerPoint(source);\r\n            let pB = viewInfo.layer._map.latLngToContainerPoint(target);\r\n\r\n            ctx.beginPath();\r\n            ctx.moveTo(pA.x, pA.y);\r\n            ctx.lineTo(pB.x, pB.y);\r\n\r\n            // next-step movement\r\n            par.x = par.xt;\r\n            par.y = par.yt;\r\n\r\n            // colormap vs. simple color\r\n            let color = this.options.color;\r\n            if (typeof color === 'function') {\r\n                ctx.strokeStyle = color(par.m);\r\n            }\r\n\r\n            let width = this.options.width;\r\n            if (typeof width === 'function') {\r\n                ctx.lineWidth = width(par.m);\r\n            }\r\n\r\n            ctx.stroke();\r\n        }\r\n    },\r\n\r\n    _prepareParticlePaths: function() {\r\n        let paths = [];\r\n\r\n        for (var i = 0; i < this.options.paths; i++) {\r\n            let p = this._field.randomPosition();\r\n            p.age = this._randomAge();\r\n            paths.push(p);\r\n        }\r\n        return paths;\r\n    },\r\n\r\n    _randomAge: function() {\r\n        return Math.floor(Math.random() * this.options.maxAge);\r\n    },\r\n\r\n    _stopAnimation: function() {\r\n        if (this.timer) {\r\n            this.timer.stop();\r\n        }\r\n    }\r\n});\r\n\r\nL.canvasLayer.vectorFieldAnim = function(vectorField, options) {\r\n    return new L.CanvasLayer.VectorFieldAnim(vectorField, options);\r\n};\r\n","/**\r\n *   Control for a simple legend with a colorbar\r\n *   References:\r\n *      - http://jsfiddle.net/ramnathv/g8stqcf6/\r\n *      - http://jsfiddle.net/vis4/cYLZH/\r\n */\r\nL.Control.ColorBar = L.Control.extend({\r\n    options: {\r\n        position: 'bottomleft',\r\n        width: 300, // for colorbar itself (control is wider)\r\n        height: 15,\r\n        margin: 15,\r\n        background: '#fff',\r\n        textColor: 'black',\r\n        steps: 100,\r\n        decimals: 2,\r\n        units: 'uds', // ej: m/s\r\n        title: 'Legend', // ej: Ocean Currents\r\n        labels: [], // empty for no labels\r\n        textLabels: [], // empty for default labels. Custom labels ej: ['low', 'mid','high'] \r\n        labelFontSize: 10,\r\n        labelTextPosition: 'middle' // start | middle | end\r\n    },\r\n\r\n    initialize: function (color, range, options) {\r\n        this.color = color; // 'chromajs' scale function\r\n        this.range = range; // [min, max]\r\n        L.Util.setOptions(this, options);\r\n    },\r\n\r\n    onAdd: function (map) {\r\n        this._map = map;\r\n        let div = L.DomUtil.create(\r\n            'div',\r\n            'leaflet-control-colorBar leaflet-bar leaflet-control'\r\n        );\r\n        div.style.padding = '10px';\r\n\r\n        L.DomEvent\r\n            .addListener(div, 'click', L.DomEvent.stopPropagation)\r\n            .addListener(div, 'click', L.DomEvent.preventDefault);\r\n        div.style.backgroundColor = this.options.background;\r\n        div.style.cursor = 'text';\r\n        div.innerHTML = this.title() + this.palette();\r\n        return div;\r\n    },\r\n\r\n    title: function () {\r\n        let d = document.createElement('div');\r\n        d3\r\n            .select(d)\r\n            .append('span')\r\n            .style('color', this.options.textColor)\r\n            .style('display', 'block')\r\n            .style('margin-bottom', '5px')\r\n            .attr('class', 'leaflet-control-colorBar-title')\r\n            .text(this.options.title);\r\n        return d.innerHTML;\r\n    },\r\n\r\n    palette: function () {\r\n        let d = document.createElement('div');\r\n        let svg = this._createSvgIn(d);\r\n\r\n        this._appendColorBarTo(svg);\r\n\r\n        if (this.options.labels) {\r\n            this._appendLabelsTo(svg);\r\n        }\r\n\r\n        return d.innerHTML;\r\n    },\r\n\r\n    _createSvgIn: function (d) {\r\n        let spaceForLabels = this.options.labels ? this.options.margin : 0;\r\n        let svg = d3\r\n            .select(d)\r\n            .append('svg')\r\n            .attr('width', this.options.width + this.options.margin * 2)\r\n            .attr('height', this.options.height + spaceForLabels);\r\n        return svg;\r\n    },\r\n\r\n    _appendColorBarTo: function (svg) {\r\n        const colorPerValue = this._getColorPerValue();\r\n        const w = this.options.width / colorPerValue.length;\r\n\r\n        let groupBars = svg.append('g').attr('id', 'colorBar-buckets');\r\n        let buckets = groupBars\r\n            .selectAll('rect')\r\n            .data(colorPerValue)\r\n            .enter()\r\n            .append('rect');\r\n        buckets\r\n            .attr('x', (d, i) => i * w + this.options.margin)\r\n            .attr('y', () => 0)\r\n            .attr('height', () => this.options.height /*w * 4*/ )\r\n            .attr('width', () => w)\r\n            .attr('stroke-width', 2)\r\n            .attr('stroke-linecap', 'butt')\r\n            .attr('stroke', d => d.color.hex())\r\n            .attr('fill', d => d.color.hex());\r\n        buckets\r\n            .append('title')\r\n            .text(\r\n                d =>\r\n                    `${d.value.toFixed(this.options.decimals)} ${this.options\r\n                        .units}`\r\n            );\r\n    },\r\n\r\n    _appendLabelsTo: function (svg) {\r\n        const positionPerLabelValue = this._getPositionPerLabelValue();\r\n        //const w = this.options.width / colorPerValue.length;\r\n        let groupLabels = svg.append('g').attr('id', 'colorBar-labels');\r\n        let labels = groupLabels\r\n            .selectAll('text')\r\n            .data(positionPerLabelValue)\r\n            .enter()\r\n            .append('text');\r\n        labels\r\n            .attr('x', d => d.position + this.options.margin)\r\n            .attr('y', this.options.height + this.options.margin)\r\n            .attr('font-size', `${this.options.labelFontSize}px`)\r\n            .attr('text-anchor', this.options.labelTextPosition)\r\n            .attr('fill', this.options.textColor)\r\n            .attr('class', 'leaflet-control-colorBar-label')\r\n            .text(d => this.options.textLabels ? d.label : `${d.value.toFixed(this.options.decimals)}`);\r\n    },\r\n\r\n    _getColorPerValue: function () {\r\n        const [min, max] = this.range;\r\n        let delta = (max - min) / this.options.steps;\r\n        let data = d3.range(min, max + delta, delta);\r\n        let colorPerValue = data.map(d => {\r\n            return {\r\n                value: d,\r\n                color: this.color(d)\r\n            };\r\n        });\r\n        return colorPerValue;\r\n    },\r\n\r\n    _getPositionPerLabelValue: function () {\r\n        var xPositionFor = d3\r\n            .scaleLinear()\r\n            .range([0, this.options.width])\r\n            .domain(this.range);\r\n        let data = this.options.labels;\r\n        let positionPerLabel = data.map((d, index) => {\r\n            return {\r\n                label: this.options.textLabels ? this.options.textLabels[index] : '',\r\n                value: d,\r\n                position: xPositionFor(d)\r\n            };\r\n        });\r\n        return positionPerLabel;\r\n    }\r\n});\r\n\r\nL.control.colorBar = function (color, range, options) {\r\n    return new L.Control.ColorBar(color, range, options);\r\n};","/**\r\n *   Control for a simple player for controlling canvas rotation\r\n */\r\n\r\nL.Control.LayersPlayer = L.Control.extend({\r\n\r\n    initialize: function (canvasList, paneId, options) {\r\n        this.activePopup = null;\r\n        this.canvasList = canvasList;\r\n        this.paneId = paneId;\r\n        this.refreshTime = options.refreshTime ? options.refreshTime : 1000;\r\n        this.loop = options.loop ? options.loop : false;\r\n        this.currentPlay = null;\r\n        this.buttons = {};\r\n        options.cvLst = this.canvasList;\r\n        L.Util.setOptions(this, options);\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    onAdd: function (map) {\r\n        this.currentFrame = 0;\r\n        this._map = map;\r\n        this.div = L.DomUtil.create(\r\n            'div',\r\n            'leaflet-control'\r\n        );\r\n        this.div.style.padding = '10px';\r\n\r\n        L.DomEvent\r\n            .addListener(this.div, 'click', L.DomEvent.stopPropagation)\r\n            .addListener(this.div, 'click', L.DomEvent.preventDefault);\r\n        this.div.style.backgroundColor = this.options.background;\r\n        this.div.style.cursor = 'text';\r\n        this._createLabels(this.div);\r\n        this._createButtons(this.div);\r\n        this.goTo(0);\r\n        return this.div;\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    /**\r\n     * Make only the idxShow-th layer visible. \r\n     * idxShow: int. From 1 to control.canvasList.length (inclusive)\r\n     */\r\n    displayLayer: function (idxShow) {\r\n        \r\n        let control = L.Control.LayersPlayer.lastCreated;\r\n        let paneChildren = control._map.getPane(control.paneId);\r\n        paneChildren = paneChildren.children;\r\n        \r\n        if (paneChildren.length == 0) return;\r\n        \r\n        [...Array(control.canvasList.length).keys()].forEach(function (idxCurrent) {\r\n            let paneChild = paneChildren[idxCurrent+1];\r\n            let isActive = (idxShow == (idxCurrent+1));\r\n            \r\n            /** show or hide */\r\n            paneChild.style.display = isActive ? 'block' : 'none';\r\n            \r\n            /** activate or deactivate onClick response */\r\n            if (control.onClick && isActive) {\r\n                control.canvasList[idxCurrent][0].on('click', control.onClick);\r\n            } else {\r\n                control.canvasList[idxCurrent][0].off('click');\r\n            }\r\n        });\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    toggleLoop: function () {\r\n        let control = L.Control.LayersPlayer.lastCreated;\r\n        control.loop = !control.loop;\r\n        control._setButtonActive(this, 'toggleLoop', control.loop);\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    goTo: function (idx) {\r\n        let control = L.Control.LayersPlayer.lastCreated;\r\n        this.currentFrame = idx;\r\n        \r\n        /** show idx canvas, hide other canvas */\r\n        this.displayLayer(idx+1);\r\n        \r\n        /** update counter */\r\n        this.div\r\n            .querySelector('.leaflet-control-layersPlayer-frameCounter')\r\n            .innerHTML = this._zeroPad(idx+1, 2) + '/' + this._zeroPad(this.canvasList.length, 2);\r\n        \r\n        /** update label */\r\n        this.div\r\n            .querySelector('.leaflet-control-layersPlayer-frameLabel')\r\n            .innerHTML = this.canvasList[idx][1];\r\n            \r\n        /** update onClick function */\r\n        if (control.onClick) {\r\n            this.canvasList[control.currentFrame][0].on('click', control.onClick);\r\n        }\r\n        \r\n        /** update popup content */\r\n        if (this.activePopup) {\r\n            let latLng = this.activePopup._latlng;\r\n            let activeField = this.canvasList[control.currentFrame][0];\r\n            let cellValue = activeField._field['valueAt'](latLng.lng, latLng.lat);\r\n            \r\n            this.canvasList[control.currentFrame][0].fireEvent('click', {\r\n                latlng: latLng,\r\n                frameChange: true,\r\n                value: cellValue\r\n            });\r\n        }\r\n        \r\n        return this.div;\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    goFirst: function() {\r\n        let control = L.Control.LayersPlayer.lastCreated;\r\n        control.goTo(0);\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    goLast: function() {\r\n        let control = L.Control.LayersPlayer.lastCreated;\r\n        let lastId = control.canvasList.length - 1;\r\n        \r\n        control.goTo((lastId >= 0) ? lastId : 0);\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    goNext: function() {\r\n        let control = L.Control.LayersPlayer.lastCreated;\r\n        let nextIdx = control.currentFrame + 1;\r\n        \r\n        if (nextIdx < control.canvasList.length){\r\n            control.goTo(nextIdx);\r\n        } else if (control.loop){\r\n            control.goTo(0);\r\n        } else {\r\n            control.goTo(control.canvasList.length-1);\r\n            control.playStop();\r\n        }\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    goPrev: function() {\r\n        let control = L.Control.LayersPlayer.lastCreated;\r\n        let nextIdx = control.currentFrame - 1;\r\n        \r\n        if (nextIdx >= 0){\r\n            control.goTo(nextIdx);\r\n        } else if (control.loop){\r\n            control.goTo(control.canvasList.length-1);\r\n        } else {\r\n            control.goTo(0);\r\n            control.playStop();\r\n        }\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    playBackward: function() {\r\n        let control = L.Control.LayersPlayer.lastCreated;\r\n        control.playStop();\r\n        control.currentPlay = setInterval(control.goPrev, control.refreshTime);\r\n        control._setButtonActive(this, 'playBackward', true);\r\n        control._setButtonActive(control.buttons['playForward'], 'playForward', false);\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    playForward: function() {\r\n        let control = L.Control.LayersPlayer.lastCreated;\r\n        control.playStop();\r\n        control.currentPlay = setInterval(control.goNext, control.refreshTime);\r\n        control._setButtonActive(this, 'playForward', true);\r\n        control._setButtonActive(control.buttons['playBackward'], 'playBackward', false);\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    playStop: function() {\r\n        let control = L.Control.LayersPlayer.lastCreated;\r\n        if (control.currentPlay != null) {\r\n            clearInterval(control.currentPlay);\r\n            control.currentPlay = null;\r\n        }\r\n        control._setButtonActive(control.buttons['playForward'], 'playForward', false);\r\n        control._setButtonActive(control.buttons['playBackward'], 'playBackward', false);\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    _addStyles: function (domUtilElement, styleDictionary) {\r\n        Object.keys(styleDictionary).forEach(function(key) {\r\n            domUtilElement.style[key] = styleDictionary[key];\r\n        });\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    _createLabels: function (container) {\r\n        let n = this.canvasList.length;\r\n        let d = document.createElement('div');\r\n        \r\n        d3\r\n            .select(d)\r\n            .attr('class', 'leaflet-control-layersPlayer-title');\r\n        \r\n        d3\r\n            .select(d)\r\n            .append('span')\r\n            .style('color', this.options.textColor)\r\n            .style('text-color', '#777777')\r\n            .style('display', 'block')\r\n            .style('margin-bottom', '5px')\r\n            .style('width', '35px')\r\n            .style('display', 'block')\r\n            .style('float', 'left')\r\n            .attr('class', 'leaflet-control-layersPlayer-frameCounter')\r\n            .text('00/' + this._zeroPad(n, 2));\r\n        \r\n        d3\r\n            .select(d)\r\n            .append('span')\r\n            .style('color', this.options.textColor)\r\n            .style('display', 'block')\r\n            .style('margin-bottom', '5px')\r\n            .style('width', '125px')\r\n            .style('display', 'block')\r\n            .style('float', 'left')\r\n            .attr('class', 'leaflet-control-layersPlayer-frameLabel')\r\n            .text('Loading labels...');\r\n        container.innerHTML += d.innerHTML;\r\n        return null;\r\n    },\r\n\r\n    //------------------------------------------------------------------\r\n    _createButtons: function (container) {\r\n        let d = L.DomUtil.create('div', null, container);\r\n        \r\n        d.style.width = 'auto';\r\n        \r\n        this.buttons['moveFirst'] = this._createMoveFirstButton(d);\r\n        this.buttons['playBackward'] = this._createPlayBackwardsButton(d);\r\n        this.buttons['previous'] = this._createPreviousButton(d);\r\n        \r\n        this.buttons['stop'] = this._createStopButton(d);\r\n        \r\n        this.buttons['next'] = this._createNextButton(d);\r\n        this.buttons['playForward'] = this._createPlayForwardButton(d);\r\n        this.buttons['moveLast'] = this._createMoveLastButton(d);\r\n        \r\n        this.buttons['toggleLoop'] = this._createToggleLoopButton(d);\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    _createButton: function (d, id, defaults, onClickFunction) {\r\n        \r\n        // set a custom class if it is provided\r\n        let customClass = null;\r\n        try {\r\n            customClass = this.options.buttons[id].cssClass;\r\n        } catch (ex) {\r\n            customClass = null;\r\n        }\r\n        \r\n        // create button\r\n        let button = L.DomUtil.create('div', customClass, d);\r\n        \r\n        // set custom styles if they are provided\r\n        let customStyle = undefined;\r\n        try {\r\n            customStyle = this.options.buttons[id].style;\r\n        } catch (ex) {\r\n            customStyle = undefined;\r\n        }\r\n        if (customStyle) {\r\n            this._addStyles(button, customStyle);\r\n        }\r\n        \r\n        // set default styles if nothing is provided\r\n        if ((!customClass) && (!customStyle)){\r\n            this._addStyles(button, this._buttonsDefaultStyle);\r\n        }\r\n        \r\n        // set innerHTML\r\n        try {\r\n            button.innerHTML = this.options.buttons[id].innerHTML || defaults.innerHTML;\r\n        } catch (ex) {\r\n            button.innerHTML = defaults.innerHTML;\r\n        }\r\n        \r\n        // set tooltip\r\n        try {\r\n            button.setAttribute('title', this.options.buttons[id].title || defaults.title);\r\n        } catch (ex) {\r\n            button.setAttribute('title', defaults.title);\r\n        }\r\n        \r\n        L.DomEvent\r\n            .addListener(button, 'click', onClickFunction);\r\n        \r\n        return (button);\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    _createMoveFirstButton: function (d) {\r\n        let defaults = {\r\n            'innerHTML': '|&#9665;',\r\n            'title': 'First frame'\r\n        };\r\n        return this._createButton(d, 'moveFirst', defaults, this.goFirst);\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    _createPlayBackwardsButton: function (d) {\r\n        let defaults = {\r\n            'innerHTML': '&#9668;',\r\n            'title': 'Play backwards'\r\n        };\r\n        return this._createButton(d, 'playBackward', defaults, this.playBackward);\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    _createPreviousButton: function (d) {\r\n        let defaults = {\r\n            'innerHTML': '&#9665;',\r\n            'title': 'Previous frame'\r\n        };\r\n        return this._createButton(d, 'prev', defaults, this.goPrev);\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    _createNextButton: function (d) {\r\n        let defaults = {\r\n            'innerHTML': '&#9655;',\r\n            'title': 'Next frame'\r\n        };\r\n        return this._createButton(d, 'next', defaults, this.goNext);\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    _createPlayForwardButton: function (d) {\r\n        let defaults = {\r\n            'innerHTML': '&#9658;',\r\n            'title': 'Play Forward'\r\n        };\r\n        return this._createButton(d, 'playForward', defaults, this.playForward);\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    _createStopButton: function (d) {\r\n        let defaults = {\r\n            'innerHTML': '&#9632;',\r\n            'title': 'Stop'\r\n        };\r\n        return this._createButton(d, 'stop', defaults, this.playStop);\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    _createMoveLastButton: function (d) {\r\n        let defaults = {\r\n            'innerHTML': '&#9655;|',\r\n            'title': 'Last frame'\r\n        };\r\n        return this._createButton(d, 'moveLast', defaults, this.goLast);\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    _createToggleLoopButton: function (d) {\r\n        let defaults = {\r\n            'innerHTML': '&#8734;',\r\n            'title': 'Loop'\r\n        };\r\n        return this._createButton(d, 'toggleLoop', defaults, this.toggleLoop);\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    _setButtonActive: function (button, buttonId, isActive) {\r\n        // get the 'running class' id\r\n        let buttonClassRunId = undefined;\r\n        try {\r\n            buttonClassRunId = this.options.buttons[buttonId].cssClassRun;\r\n        } catch (ex) {\r\n            buttonClassRunId = undefined;\r\n        }\r\n        if (!buttonClassRunId) { return; }\r\n        \r\n        // set/remove it\r\n        if (isActive) {\r\n            L.DomUtil.addClass(button, buttonClassRunId);\r\n        } else {\r\n            L.DomUtil.removeClass(button, buttonClassRunId);\r\n        }\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    _zeroPad: function (num, places) {\r\n        return String(num).padStart(places, '0');\r\n    },\r\n    \r\n    //------------------------------------------------------------------\r\n    _buttonsDefaultStyle: {\r\n        'float': 'left',\r\n        'display': 'block',\r\n        'width': '16px',\r\n        'backgroundColor': '#FFFFFF',\r\n        'padding': '2px',\r\n        'border': '1px solid #333333',\r\n        'cursor': 'pointer',\r\n        'color': '#111111',\r\n        'textAlign': 'center'\r\n    }\r\n});\r\n\r\n/**\r\n * Only one LayersPlayer controler is expected to exist at a time.\r\n * A singleton approach is used to create and refeer to the initiated controlers.\r\n **/\r\nL.control.layersPlayer = function (canvasList, paneId, options) {\r\n     \r\n    let newControler = new L.Control.LayersPlayer(canvasList, paneId, options);\r\n    \r\n    // if there is an existing Layer Player controler, destroy it recursively\r\n    if (L.Control.LayersPlayer.lastCreated) {\r\n        let clearInner = function (node) {\r\n            while (node.hasChildNodes()) {\r\n                clear(node.firstChild);\r\n            }\r\n        };\r\n        let clear = function(node) {\r\n            while (node.hasChildNodes()) {\r\n                clear(node.firstChild);\r\n            }\r\n            node.parentNode.removeChild(node);\r\n        };\r\n        clearInner(L.Control.LayersPlayer.lastCreated.div);\r\n        delete L.Control.LayersPlayer.lastCreated;\r\n    }\r\n    \r\n    L.Control.LayersPlayer.lastCreated = newControler;\r\n    return L.Control.LayersPlayer.lastCreated;\r\n};\r\n","/**\r\n *  2D Vector\r\n */\r\nexport default class Vector {\r\n\r\n    constructor(u, v) {\r\n        this.u = u;\r\n        this.v = v;\r\n    }\r\n\r\n    /**\r\n     * Magnitude\r\n     * @returns {Number}\r\n     */\r\n    magnitude() {\r\n        return Math.sqrt(this.u * this.u + this.v * this.v);\r\n    }\r\n\r\n    /**\r\n     * Angle in degrees (0 to 360º) --> Towards\r\n     * N is 0º and E is 90º\r\n     * @returns {Number}\r\n     */\r\n    directionTo() {\r\n        let verticalAngle = Math.atan2(this.u, this.v);\r\n        let inDegrees = verticalAngle * (180.0 / Math.PI);\r\n        if (inDegrees < 0) {\r\n            inDegrees = inDegrees + 360.0;\r\n        }\r\n        return inDegrees;\r\n    }\r\n\r\n    /**\r\n     * Angle in degrees (0 to 360º) From x-->\r\n     * N is 0º and E is 90º\r\n     * @returns {Number}\r\n     */\r\n    directionFrom() {\r\n        let a = this.directionTo();\r\n        let opposite = (a + 180.0) % 360.0;\r\n        return opposite;\r\n    }\r\n\r\n    /*\r\n        Degrees --> text\r\n        new Dictionary<int, string>\r\n        {\r\n            //{0, 23, 45, 68, 90, 113, 135, 158, 180, 203, 225, 248, 270, 293, 315, 338, 360};\r\n            {0, 'N'},\r\n            {23, 'NNE'},\r\n            {45, 'NE'},\r\n            {68, 'ENE'},\r\n            {90, 'E'},\r\n            {113, 'ESE'},\r\n            {135, 'SE'},\r\n            {158, 'SSE'},\r\n            {180, 'S'},\r\n            {203, 'SSW'},\r\n            {225, 'SW'},\r\n            {248, 'WSW'},\r\n            {270, 'W'},\r\n            {293, 'WNW'},\r\n            {315, 'NW'},\r\n            {338, 'NNW'},\r\n            {360, 'N'}\r\n        };\r\n    */\r\n}\r\n","import Cell from './Cell';\r\nimport inside from '@turf/inside';\r\n\r\n/**\r\n *  Abstract class for a set of values (Vector | Scalar)\r\n *  assigned to a regular 2D-grid (lon-lat), aka 'a Raster source'\r\n */\r\nexport default class Field {\r\n    constructor(params) {\r\n        this.params = params;\r\n\r\n        this.nCols = params['nCols'];\r\n        this.nRows = params['nRows'];\r\n\r\n        // alias\r\n        this.width = params['nCols'];\r\n        this.height = params['nRows'];\r\n\r\n        // ll = lower-left\r\n        this.xllCorner = params['xllCorner'];\r\n        this.yllCorner = params['yllCorner'];\r\n\r\n        // ur = upper-right\r\n        this.xurCorner =\r\n            params['xllCorner'] + params['nCols'] * params['cellXSize'];\r\n        this.yurCorner =\r\n            params['yllCorner'] + params['nRows'] * params['cellYSize'];\r\n\r\n        this.cellXSize = params['cellXSize'];\r\n        this.cellYSize = params['cellYSize'];\r\n\r\n        this.grid = null; // to be defined by subclasses\r\n        this.isContinuous = this.xurCorner - this.xllCorner >= 360;\r\n        this.longitudeNeedsToBeWrapped = this.xurCorner > 180; // [0, 360] --> [-180, 180]\r\n\r\n        this._inFilter = null;\r\n        this._spatialMask = null;\r\n    }\r\n\r\n    /**\r\n     * Builds a grid with a value at each point (either Vector or Number)\r\n     * Original params must include the required input values, following\r\n     * x-ascending & y-descending order (same as in ASCIIGrid)\r\n     * @abstract\r\n     * @private\r\n     * @returns {Array.<Array.<Vector|Number>>} - grid[row][column]--> Vector|Number\r\n     */\r\n    _buildGrid() {\r\n        throw new TypeError('Must be overriden');\r\n    }\r\n\r\n    _updateRange() {\r\n        this.range = this._calculateRange();\r\n    }\r\n\r\n    /**\r\n     * Number of cells in the grid (rows * cols)\r\n     * @returns {Number}\r\n     */\r\n    numCells() {\r\n        return this.nRows * this.nCols;\r\n    }\r\n\r\n    /**\r\n     * A list with every cell\r\n     * @returns {Array<Cell>} - cells (x-ascending & y-descending order)\r\n     */\r\n    getCells(stride = 1) {\r\n        let cells = [];\r\n        for (let j = 0; j < this.nRows; j = j + stride) {\r\n            for (let i = 0; i < this.nCols; i = i + stride) {\r\n                let [lon, lat] = this._lonLatAtIndexes(i, j);\r\n                let center = L.latLng(lat, lon);\r\n                let value = this._valueAtIndexes(i, j);\r\n                let c = new Cell(center, value, this.cellXSize, this.cellYSize);\r\n                cells.push(c); // <<\r\n            }\r\n        }\r\n        return cells;\r\n    }\r\n\r\n    /**\r\n     * Apply a filter function to field values\r\n     * @param   {Function} f - boolean function\r\n     */\r\n    setFilter(f) {\r\n        this._inFilter = f;\r\n        this._updateRange();\r\n    }\r\n\r\n    /**\r\n     * Apply a spatial mask to field values\r\n     * @param {L.GeoJSON} m \r\n     */\r\n    setSpatialMask(m) {\r\n        this._spatialMask = m;\r\n    }\r\n\r\n    /**\r\n     * Grid extent\r\n     * @returns {Number[]} [xmin, ymin, xmax, ymax]\r\n     */\r\n    extent() {\r\n        let [xmin, xmax] = this._getWrappedLongitudes();\r\n        return [xmin, this.yllCorner, xmax, this.yurCorner];\r\n    }\r\n\r\n    /**\r\n     * [xmin, xmax] in [-180, 180] range\r\n     */\r\n    _getWrappedLongitudes() {\r\n        let xmin = this.xllCorner;\r\n        let xmax = this.xurCorner;\r\n\r\n        if (this.longitudeNeedsToBeWrapped) {\r\n            if (this.isContinuous) {\r\n                xmin = -180;\r\n                xmax = 180;\r\n            } else {\r\n                // not sure about this (just one particular case, but others...?)\r\n                xmax = this.xurCorner - 360;\r\n                xmin = this.xllCorner - 360;\r\n                /* eslint-disable no-console */\r\n                // console.warn(`are these xmin: ${xmin} & xmax: ${xmax} OK?`);\r\n                // TODO: Better throw an exception on no-controlled situations.\r\n                /* eslint-enable no-console */\r\n            }\r\n        }\r\n        return [xmin, xmax];\r\n    }\r\n\r\n    /**\r\n     * Returns whether or not the grid contains the point, considering\r\n     * the spatialMask if it has been previously set\r\n     * @param   {Number} lon - longitude\r\n     * @param   {Number} lat - latitude\r\n     * @returns {Boolean}\r\n     */\r\n    contains(lon, lat) {\r\n        if (this._spatialMask) {\r\n            return this._pointInMask(lon, lat);\r\n        }\r\n        return this._pointInExtent(lon, lat);\r\n    }\r\n\r\n    /**\r\n     * Checks if coordinates are inside the Extent (considering wrapped longitudes if needed)\r\n     * @param {Number} lon \r\n     * @param {Number} lat \r\n     */\r\n    _pointInExtent(lon, lat) {\r\n        let [xmin, xmax] = this._getWrappedLongitudes();\r\n        let longitudeIn = lon >= xmin && lon <= xmax;\r\n        let latitudeIn = lat >= this.yllCorner && lat <= this.yurCorner;\r\n        return longitudeIn && latitudeIn;\r\n    }\r\n\r\n    /**\r\n     * Check if coordinates are inside the spatialMask (Point in Polygon analysis)\r\n     * @param {Number} lon \r\n     * @param {Number} lat \r\n     */\r\n    _pointInMask(lon, lat) {\r\n        const pt = {\r\n            type: 'Feature',\r\n            geometry: {\r\n                type: 'Point',\r\n                coordinates: [lon, lat] // geojson, lon-lat order !\r\n            },\r\n            properties: {}\r\n        };\r\n        const poly = this._spatialMask;\r\n        return inside(pt, poly);\r\n    }\r\n\r\n    /**\r\n     * Returns if the grid doesn't contain the point\r\n     * @param   {Number} lon - longitude\r\n     * @param   {Number} lat - latitude\r\n     * @returns {Boolean}\r\n     */\r\n    notContains(lon, lat) {\r\n        return !this.contains(lon, lat);\r\n    }\r\n\r\n    /**\r\n     * Interpolated value at lon-lat coordinates (bilinear method)\r\n     * @param   {Number} longitude\r\n     * @param   {Number} latitude\r\n     * @returns {Vector|Number} [u, v, magnitude]\r\n     *                          \r\n     * Source: https://github.com/cambecc/earth > product.js\r\n     */\r\n    interpolatedValueAt(lon, lat) {\r\n        if (this.notContains(lon, lat)) return null;\r\n\r\n        let [i, j] = this._getDecimalIndexes(lon, lat);\r\n        return this.interpolatedValueAtIndexes(i, j);\r\n    }\r\n\r\n    /**\r\n     * Interpolated value at i-j indexes (bilinear method)\r\n     * @param   {Number} i\r\n     * @param   {Number} j\r\n     * @returns {Vector|Number} [u, v, magnitude]\r\n     *\r\n     * Source: https://github.com/cambecc/earth > product.js\r\n     */\r\n    interpolatedValueAtIndexes(i, j) {\r\n        //         1      2           After converting λ and φ to fractional grid indexes i and j, we find the\r\n        //        fi  i   ci          four points 'G' that enclose point (i, j). These points are at the four\r\n        //         | =1.4 |           corners specified by the floor and ceiling of i and j. For example, given\r\n        //      ---G--|---G--- fj 8   i = 1.4 and j = 8.3, the four surrounding grid points are (1, 8), (2, 8),\r\n        //    j ___|_ .   |           (1, 9) and (2, 9).\r\n        //  =8.3   |      |\r\n        //      ---G------G--- cj 9   Note that for wrapped grids, the first column is duplicated as the last\r\n        //         |      |           column, so the index ci can be used without taking a modulo.\r\n\r\n        let indexes = this._getFourSurroundingIndexes(i, j);\r\n        let [fi, ci, fj, cj] = indexes;\r\n        let values = this._getFourSurroundingValues(fi, ci, fj, cj);\r\n        if (values) {\r\n            let [g00, g10, g01, g11] = values;\r\n            return this._doInterpolation(i - fi, j - fj, g00, g10, g01, g11);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Get decimal indexes\r\n     * @private\r\n     * @param {Number} lon\r\n     * @param {Number} lat\r\n     * @returns {Array}    [[Description]]\r\n     */\r\n    _getDecimalIndexes(lon, lat) {\r\n        if (this.longitudeNeedsToBeWrapped && lon < this.xllCorner) {\r\n            lon = lon + 360;\r\n        }\r\n        let i = (lon - this.xllCorner) / this.cellXSize;\r\n        let j = (this.yurCorner - lat) / this.cellYSize;\r\n        return [i, j];\r\n    }\r\n\r\n    /**\r\n     * Get surrounding indexes (integer), clampling on borders\r\n     * @private\r\n     * @param   {Number} i - decimal index\r\n     * @param   {Number} j - decimal index\r\n     * @returns {Array} [fi, ci, fj, cj]\r\n     */\r\n    _getFourSurroundingIndexes(i, j) {\r\n        let fi = Math.floor(i);\r\n        let ci = fi + 1;\r\n        // duplicate colum to simplify interpolation logic (wrapped value)\r\n        if (this.isContinuous && ci >= this.nCols) {\r\n            ci = 0;\r\n        }\r\n        ci = this._clampColumnIndex(ci);\r\n\r\n        let fj = this._clampRowIndex(Math.floor(j));\r\n        let cj = this._clampRowIndex(fj + 1);\r\n\r\n        return [fi, ci, fj, cj];\r\n    }\r\n\r\n    /**\r\n     * Get four surrounding values or null if not available,\r\n     * from 4 integer indexes\r\n     * @private\r\n     * @param   {Number} fi\r\n     * @param   {Number} ci\r\n     * @param   {Number} fj\r\n     * @param   {Number} cj\r\n     * @returns {Array} \r\n     */\r\n    _getFourSurroundingValues(fi, ci, fj, cj) {\r\n        var row;\r\n        if ((row = this.grid[fj])) {\r\n            // upper row ^^\r\n            var g00 = row[fi]; // << left\r\n            var g10 = row[ci]; // right >>\r\n            if (\r\n                this._isValid(g00) &&\r\n                this._isValid(g10) &&\r\n                (row = this.grid[cj])\r\n            ) {\r\n                // lower row vv\r\n                var g01 = row[fi]; // << left\r\n                var g11 = row[ci]; // right >>\r\n                if (this._isValid(g01) && this._isValid(g11)) {\r\n                    return [g00, g10, g01, g11]; // 4 values found!\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Nearest value at lon-lat coordinates\r\n     * @param   {Number} longitude\r\n     * @param   {Number} latitude\r\n     * @returns {Vector|Number}\r\n     */\r\n    valueAt(lon, lat) {\r\n        if (this.notContains(lon, lat)) return null;\r\n\r\n        let [i, j] = this._getDecimalIndexes(lon, lat);\r\n        let ii = Math.floor(i);\r\n        let jj = Math.floor(j);\r\n\r\n        const ci = this._clampColumnIndex(ii);\r\n        const cj = this._clampRowIndex(jj);\r\n\r\n        let value = this._valueAtIndexes(ci, cj);\r\n        if (this._inFilter) {\r\n            if (!this._inFilter(value)) return null;\r\n        }\r\n\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * Returns whether or not the field has a value at the point\r\n     * @param   {Number} lon - longitude\r\n     * @param   {Number} lat - latitude\r\n     * @returns {Boolean}\r\n     */\r\n    hasValueAt(lon, lat) {\r\n        let value = this.valueAt(lon, lat);\r\n        let hasValue = value !== null;\r\n\r\n        let included = true;\r\n        if (this._inFilter) {\r\n            included = this._inFilter(value);\r\n        }\r\n        return hasValue && included;\r\n    }\r\n\r\n    /**\r\n     * Returns if the grid has no value at the point\r\n     * @param   {Number} lon - longitude\r\n     * @param   {Number} lat - latitude\r\n     * @returns {Boolean}\r\n     */\r\n    notHasValueAt(lon, lat) {\r\n        return !this.hasValueAt(lon, lat);\r\n    }\r\n\r\n    /**\r\n     * Gives a random position to 'o' inside the grid\r\n     * @param {Object} [o] - an object (eg. a particle)\r\n     * @returns {{x: Number, y: Number}} - object with x, y (lon, lat)\r\n     */\r\n    randomPosition(o = {}) {\r\n        let i = (Math.random() * this.nCols) | 0;\r\n        let j = (Math.random() * this.nRows) | 0;\r\n\r\n        o.x = this._longitudeAtX(i);\r\n        o.y = this._latitudeAtY(j);\r\n\r\n        return o;\r\n    }\r\n\r\n    /**\r\n     * Value for grid indexes\r\n     * @param   {Number} i - column index (integer)\r\n     * @param   {Number} j - row index (integer)\r\n     * @returns {Vector|Number}\r\n     */\r\n    _valueAtIndexes(i, j) {\r\n        return this.grid[j][i]; // <-- j,i !!\r\n    }\r\n\r\n    /**\r\n     * Lon-Lat for grid indexes\r\n     * @param   {Number} i - column index (integer)\r\n     * @param   {Number} j - row index (integer)\r\n     * @returns {Number[]} [lon, lat]\r\n     */\r\n    _lonLatAtIndexes(i, j) {\r\n        let lon = this._longitudeAtX(i);\r\n        let lat = this._latitudeAtY(j);\r\n\r\n        return [lon, lat];\r\n    }\r\n\r\n    /**\r\n     * Longitude for grid-index\r\n     * @param   {Number} i - column index (integer)\r\n     * @returns {Number} longitude at the center of the cell\r\n     */\r\n    _longitudeAtX(i) {\r\n        let halfXPixel = this.cellXSize / 2.0;\r\n        let lon = this.xllCorner + halfXPixel + i * this.cellXSize;\r\n        if (this.longitudeNeedsToBeWrapped) {\r\n            lon = lon > 180 ? lon - 360 : lon;\r\n        }\r\n        return lon;\r\n    }\r\n\r\n    /**\r\n     * Latitude for grid-index\r\n     * @param   {Number} j - row index (integer)\r\n     * @returns {Number} latitude at the center of the cell\r\n     */\r\n    _latitudeAtY(j) {\r\n        let halfYPixel = this.cellYSize / 2.0;\r\n        return this.yurCorner - halfYPixel - j * this.cellYSize;\r\n    }\r\n\r\n    /**\r\n     * Apply the interpolation\r\n     * @abstract\r\n     * @private\r\n     */\r\n    /* eslint-disable no-unused-vars */\r\n    _doInterpolation(x, y, g00, g10, g01, g11) {\r\n        throw new TypeError('Must be overriden');\r\n    }\r\n    /* eslint-disable no-unused-vars */\r\n\r\n    /**\r\n     * Check the column index is inside the field,\r\n     * adjusting to min or max when needed\r\n     * @private\r\n     * @param   {Number} ii - index\r\n     * @returns {Number} i - inside the allowed indexes\r\n     */\r\n    _clampColumnIndex(ii) {\r\n        let i = ii;\r\n        if (ii < 0) {\r\n            i = 0;\r\n        }\r\n        let maxCol = this.nCols - 1;\r\n        if (ii > maxCol) {\r\n            i = maxCol;\r\n        }\r\n        return i;\r\n    }\r\n\r\n    /**\r\n     * Check the row index is inside the field,\r\n     * adjusting to min or max when needed\r\n     * @private\r\n     * @param   {Number} jj index\r\n     * @returns {Number} j - inside the allowed indexes\r\n     */\r\n    _clampRowIndex(jj) {\r\n        let j = jj;\r\n        if (jj < 0) {\r\n            j = 0;\r\n        }\r\n        let maxRow = this.nRows - 1;\r\n        if (jj > maxRow) {\r\n            j = maxRow;\r\n        }\r\n        return j;\r\n    }\r\n\r\n    /**\r\n     * Is valid (not 'null' nor 'undefined')\r\n     * @private\r\n     * @param   {Object} x object\r\n     * @returns {Boolean}\r\n     */\r\n    _isValid(x) {\r\n        return x !== null && x !== undefined;\r\n    }\r\n}\r\n","import Field from './Field';\r\n\r\n/**\r\n * Scalar Field\r\n */\r\nexport default class ScalarField extends Field {\r\n    /**\r\n   * Creates a ScalarField from the content of an ASCIIGrid file\r\n   * @param   {String}   asc\r\n   * @returns {ScalarField}\r\n   */\r\n    static fromASCIIGrid(asc, scaleFactor = 1) {\r\n    //console.time('ScalarField from ASC');\r\n\r\n        let lines = asc.split('\\n');\r\n\r\n        // Header\r\n        var header = ScalarField._parseASCIIGridHeader(lines.slice(0, 6));\r\n\r\n        // Data (left-right and top-down)\r\n        let zs = [];\r\n        for (let i = 6; i < lines.length; i++) {\r\n            let line = lines[i].trim();\r\n            if (line === '') break;\r\n\r\n            let items = line.split(' ');\r\n            items.forEach((it) => {\r\n                let floatItem = parseFloat(it);\r\n                let v =\r\n          floatItem !== header.noDataValue ? floatItem * scaleFactor : null;\r\n                zs.push(v);\r\n            });\r\n        }\r\n        let p = header;\r\n        p.zs = zs;\r\n\r\n        //console.timeEnd('ScalarField from ASC');\r\n        return new ScalarField(p);\r\n    }\r\n\r\n    /**\r\n   * Parse an ASCII Grid header, made with 6 lines\r\n   * It allows the use of XLLCORNER/YLLCORNER or XLLCENTER/YLLCENTER conventions\r\n   * @param {Array.String} headerLines\r\n   */\r\n    static _parseASCIIGridHeader(headerLines) {\r\n        try {\r\n            const headerItems = headerLines.map((line) => {\r\n                var items = line.split(' ').filter((i) => i != '');\r\n                var param = items[0].trim().toUpperCase();\r\n                var value = parseFloat(items[1].trim());\r\n                return {\r\n                    [param]: value,\r\n                };\r\n            });\r\n\r\n            const usesCorner = 'XLLCORNER' in headerItems[2];\r\n            const cellSize = headerItems[4]['CELLSIZE'];\r\n\r\n            const header = {\r\n                nCols: parseInt(headerItems[0]['NCOLS']),\r\n                nRows: parseInt(headerItems[1]['NROWS']),\r\n                xllCorner: usesCorner\r\n                    ? headerItems[2]['XLLCORNER']\r\n                    : headerItems[2]['XLLCENTER'] - cellSize / 2,\r\n                yllCorner: usesCorner\r\n                    ? headerItems[3]['YLLCORNER']\r\n                    : headerItems[3]['YLLCENTER'] - cellSize / 2,\r\n                cellXSize: cellSize,\r\n                cellYSize: cellSize,\r\n                noDataValue: headerItems[5]['NODATA_VALUE'],\r\n            };\r\n            return header;\r\n        } catch (err) {\r\n            throw new Error(`Not a valid ASCIIGrid Header: ${err}`);\r\n        }\r\n    }\r\n\r\n    /**\r\n   * Creates a ScalarField from the content of a GeoTIFF file\r\n   * @param   {ArrayBuffer}   data\r\n   * @param   {Number}   bandIndex\r\n   * @returns {ScalarField}\r\n   */\r\n    static fromGeoTIFF(data, bandIndex = 0, scaleFactor = 1) {\r\n        return ScalarField.multipleFromGeoTIFF(data, [bandIndex], scaleFactor)[0];\r\n    }\r\n\r\n    /**\r\n   * Creates a ScalarField array (one per band) from the content of a GeoTIFF file\r\n   * @param   {ArrayBuffer}   data\r\n   * @param   {Array}   bandIndexes - if not provided all bands are returned\r\n   * @returns {Array.<ScalarField>}\r\n   */\r\n    static multipleFromGeoTIFF(data, bandIndexes, scaleFactor = 1) {\r\n    //console.time('ScalarField from GeoTIFF');\r\n\r\n        let tiff = GeoTIFF.parse(data); // geotiff.js\r\n        let image = tiff.getImage();\r\n        let rasters = image.readRasters();\r\n        let tiepoint = image.getTiePoints()[0];\r\n        let fileDirectory = image.getFileDirectory();\r\n        let [xScale, yScale] = fileDirectory.ModelPixelScale;\r\n\r\n        if (typeof bandIndexes === 'undefined' || bandIndexes.length === 0) {\r\n            bandIndexes = [...Array(rasters.length).keys()];\r\n        }\r\n\r\n        let scalarFields = [];\r\n        scalarFields = bandIndexes.map(function (bandIndex) {\r\n            let zs = rasters[bandIndex]; // left-right and top-down order\r\n\r\n            if (fileDirectory.GDAL_NODATA) {\r\n                let noData = parseFloat(fileDirectory.GDAL_NODATA);\r\n                // console.log(noData);\r\n                let simpleZS = Array.from(zs); // to simple array, so null is allowed | TODO efficiency??\r\n                zs = simpleZS.map(function (z) {\r\n                    return z === noData ? null : z * scaleFactor;\r\n                });\r\n            }\r\n\r\n            let p = {\r\n                nCols: image.getWidth(),\r\n                nRows: image.getHeight(),\r\n                xllCorner: tiepoint.x,\r\n                yllCorner: tiepoint.y - image.getHeight() * yScale,\r\n                cellXSize: xScale,\r\n                cellYSize: yScale,\r\n                zs: zs,\r\n            };\r\n            return new ScalarField(p);\r\n        });\r\n\r\n        //console.timeEnd('ScalarField from GeoTIFF');\r\n        return scalarFields;\r\n    }\r\n\r\n    constructor(params) {\r\n        super(params);\r\n        this.zs = params['zs'];\r\n\r\n        this.grid = this._buildGrid();\r\n        this._updateRange();\r\n    //console.log(`ScalarField created (${this.nCols} x ${this.nRows})`);\r\n    }\r\n\r\n    /**\r\n   * Builds a grid with a Number at each point, from an array\r\n   * 'zs' following x-ascending & y-descending order\r\n   * (same as in ASCIIGrid)\r\n   * @private\r\n   * @returns {Array.<Array.<Number>>} - grid[row][column]--> Number\r\n   */\r\n    _buildGrid() {\r\n        let grid = this._arrayTo2d(this.zs, this.nRows, this.nCols);\r\n        return grid;\r\n    }\r\n\r\n    _arrayTo2d(array, nRows, nCols) {\r\n        let grid = [];\r\n        let p = 0;\r\n        for (var j = 0; j < nRows; j++) {\r\n            var row = [];\r\n            for (var i = 0; i < nCols; i++, p++) {\r\n                let z = array[p];\r\n                row[i] = this._isValid(z) ? z : null; // <<<\r\n            }\r\n            grid[j] = row;\r\n        }\r\n        return grid;\r\n    }\r\n\r\n    _newDataArrays(params) {\r\n        params['zs'] = [];\r\n    }\r\n\r\n    _pushValueToArrays(params, value) {\r\n        params['zs'].push(value);\r\n    }\r\n\r\n    _makeNewFrom(params) {\r\n        return new ScalarField(params);\r\n    }\r\n\r\n    /**\r\n   * Calculate min & max values\r\n   * @private\r\n   * @returns {Array} - [min, max]\r\n   */\r\n    _calculateRange() {\r\n        var data = this.zs;\r\n        if (this._inFilter) {\r\n            data = data.filter(this._inFilter);\r\n        }\r\n        return [d3.min(data), d3.max(data)];\r\n    }\r\n\r\n    /**\r\n   * Bilinear interpolation for Number\r\n   * https://en.wikipedia.org/wiki/Bilinear_interpolation\r\n   * @param   {Number} x\r\n   * @param   {Number} y\r\n   * @param   {Number} g00\r\n   * @param   {Number} g10\r\n   * @param   {Number} g01\r\n   * @param   {Number} g11\r\n   * @returns {Number}\r\n   */\r\n    _doInterpolation(x, y, g00, g10, g01, g11) {\r\n        var rx = 1 - x;\r\n        var ry = 1 - y;\r\n        return g00 * rx * ry + g10 * x * ry + g01 * rx * y + g11 * x * y;\r\n    }\r\n}\r\n","import Vector from './Vector';\r\nimport Field from './Field';\r\nimport ScalarField from './ScalarField';\r\n\r\n/**\r\n *  A set of vectors assigned to a regular 2D-grid (lon-lat)\r\n *  (e.g. a raster representing winds for a region)\r\n */\r\nexport default class VectorField extends Field {\r\n    /**\r\n     * Creates a VectorField from the content of two ASCIIGrid files\r\n     * @param   {String} ascU - with u-component\r\n     * @param   {String} ascV - with v-component\r\n     * @returns {VectorField}\r\n     */\r\n    static fromASCIIGrids(ascU, ascV, scaleFactor = 1) {\r\n        let u = ScalarField.fromASCIIGrid(ascU, scaleFactor);\r\n        let v = ScalarField.fromASCIIGrid(ascV, scaleFactor);\r\n        let p = VectorField._paramsFromScalarFields(u, v);\r\n\r\n        return new VectorField(p);\r\n    }\r\n\r\n    /**\r\n     * Creates a VectorField from the content of two different Geotiff files\r\n     * @param   {ArrayBuffer} gtU - geotiff data with u-component (band 0)\r\n     * @param   {ArrayBuffer} gtV - geotiff data with v-component (band 0)\r\n     * @returns {VectorField}\r\n     */\r\n    static fromGeoTIFFs(gtU, gtV, scaleFactor = 1) {\r\n        let u = ScalarField.fromGeoTIFF(gtU, undefined, scaleFactor);\r\n        let v = ScalarField.fromGeoTIFF(gtV, undefined, scaleFactor);\r\n        let p = VectorField._paramsFromScalarFields(u, v);\r\n\r\n        return new VectorField(p);\r\n    }\r\n\r\n    /**\r\n     * Creates a VectorField from the content of Multiband Geotiff\r\n     * @param   {ArrayBuffer} geotiffData - multiband\r\n     * @param   {Array} bandIndexesForUV\r\n     * @returns {VectorField}\r\n     */\r\n    static fromMultibandGeoTIFF(geotiffData, bandIndexesForUV = [0, 1]) {\r\n        let [u, v] = ScalarField.multipleFromGeoTIFF(\r\n            geotiffData,\r\n            bandIndexesForUV\r\n        );\r\n        let p = VectorField._paramsFromScalarFields(u, v);\r\n\r\n        return new VectorField(p);\r\n    }\r\n\r\n    /**\r\n     * Build parameters for VectorField, from 2 ScalarFields.\r\n     * No validation at all (nor interpolation) is applied, so u and v\r\n     * must be 'compatible' from the source\r\n     * @param   {ScalarField} u\r\n     * @param   {ScalarField} v\r\n     * @returns {Object} - parameters to build VectorField\r\n     */\r\n    static _paramsFromScalarFields(u, v) {\r\n        // TODO check u & v compatibility (cellSize...)\r\n        let p = {\r\n            nCols: u.nCols,\r\n            nRows: u.nRows,\r\n            xllCorner: u.xllCorner,\r\n            yllCorner: u.yllCorner,\r\n            cellXSize: u.cellXSize,\r\n            cellYSize: u.cellYSize,\r\n            us: u.zs,\r\n            vs: v.zs\r\n        };\r\n        return p;\r\n    }\r\n\r\n    constructor(params) {\r\n        super(params);\r\n\r\n        this.us = params['us'];\r\n        this.vs = params['vs'];\r\n        this.grid = this._buildGrid();\r\n        this.range = this._calculateRange();\r\n    }\r\n\r\n    /**\r\n     * Get a derived field, from a computation on\r\n     * the VectorField\r\n     * @param   {String} type ['magnitude' | 'directionTo' | 'directionFrom']\r\n     * @returns {ScalarField}\r\n     */\r\n    getScalarField(type) {\r\n        let f = this._getFunctionFor(type);\r\n        let p = {\r\n            nCols: this.params.nCols,\r\n            nRows: this.params.nRows,\r\n            xllCorner: this.params.xllCorner,\r\n            yllCorner: this.params.yllCorner,\r\n            cellXSize: this.params.cellXSize,\r\n            cellYSize: this.params.cellYSize,\r\n            zs: this._applyOnField(f)\r\n        };\r\n        return new ScalarField(p);\r\n    }\r\n\r\n    _getFunctionFor(type) {\r\n        return function(u, v) {\r\n            let uv = new Vector(u, v);\r\n            return uv[type](); // magnitude, directionTo, directionFrom\r\n        };\r\n    }\r\n\r\n    _applyOnField(func) {\r\n        let zs = [];\r\n        let n = this.numCells();\r\n        for (var i = 0; i < n; i++) {\r\n            let u = this.us[i];\r\n            let v = this.vs[i];\r\n            if (this._isValid(u) && this._isValid(v)) {\r\n                zs.push(func(u, v));\r\n            } else {\r\n                zs.push(null);\r\n            }\r\n        }\r\n        return zs;\r\n    }\r\n\r\n    /**\r\n     * Builds a grid with a Vector at each point, from two arrays\r\n     * 'us' and 'vs' following x-ascending & y-descending order\r\n     * (same as in ASCIIGrid)\r\n     * @returns {Array.<Array.<Vector>>} - grid[row][column]--> Vector\r\n     */\r\n    _buildGrid() {\r\n        let grid = this._arraysTo2d(this.us, this.vs, this.nRows, this.nCols);\r\n        return grid;\r\n    }\r\n\r\n    _arraysTo2d(us, vs, nRows, nCols) {\r\n        let grid = [];\r\n        let p = 0;\r\n\r\n        for (var j = 0; j < nRows; j++) {\r\n            var row = [];\r\n            for (var i = 0; i < nCols; i++, p++) {\r\n                let u = us[p],\r\n                    v = vs[p];\r\n                let valid = this._isValid(u) && this._isValid(v);\r\n                row[i] = valid ? new Vector(u, v) : null; // <<<\r\n            }\r\n            grid[j] = row;\r\n        }\r\n        return grid;\r\n    }\r\n\r\n    _newDataArrays(params) {\r\n        params['us'] = [];\r\n        params['vs'] = [];\r\n    }\r\n    _pushValueToArrays(params, value) {\r\n        //console.log(value);\r\n        params['us'].push(value.u);\r\n        params['vs'].push(value.v);\r\n    }\r\n    _makeNewFrom(params) {\r\n        return new VectorField(params);\r\n    }\r\n\r\n    /**\r\n     * Calculate min & max values (magnitude)\r\n     * @private\r\n     * @returns {Array}\r\n     */\r\n    _calculateRange() {\r\n        // TODO make a clearer method for getting these vectors...\r\n        let vectors = this.getCells()\r\n            .map(pt => pt.value)\r\n            .filter(function(v) {\r\n                return v !== null;\r\n            });\r\n\r\n        if (this._inFilter) {\r\n            vectors = vectors.filter(this._inFilter);\r\n        }\r\n\r\n        // TODO check memory crash with high num of vectors!\r\n        let magnitudes = vectors.map(v => v.magnitude());\r\n        let min = d3.min(magnitudes);\r\n        let max = d3.max(magnitudes);\r\n\r\n        return [min, max];\r\n    }\r\n\r\n    /**\r\n     * Bilinear interpolation for Vector\r\n     * https://en.wikipedia.org/wiki/Bilinear_interpolation\r\n     * @param   {Number} x\r\n     * @param   {Number} y\r\n     * @param   {Number[]} g00\r\n     * @param   {Number[]} g10\r\n     * @param   {Number[]} g01\r\n     * @param   {Number[]} g11\r\n     * @returns {Vector}\r\n     */\r\n    _doInterpolation(x, y, g00, g10, g01, g11) {\r\n        var rx = 1 - x;\r\n        var ry = 1 - y;\r\n        var a = rx * ry,\r\n            b = x * ry,\r\n            c = rx * y,\r\n            d = x * y;\r\n        var u = g00.u * a + g10.u * b + g01.u * c + g11.u * d;\r\n        var v = g00.v * a + g10.v * b + g01.v * c + g11.v * d;\r\n        return new Vector(u, v);\r\n    }\r\n\r\n    /**\r\n     * Is valid (not 'null' nor 'undefined')\r\n     * @private\r\n     * @param   {Object} x object\r\n     * @returns {Boolean}\r\n     */\r\n    _isValid(x) {\r\n        return x !== null && x !== undefined;\r\n    }\r\n}\r\n","// base\r\nimport Vector from './Vector.js';\r\nwindow.L.Vector = Vector;\r\n\r\nimport Cell from './Cell.js';\r\nwindow.L.Cell = Cell;\r\n\r\nimport Field from './Field.js';\r\nwindow.L.Field = Field;\r\n\r\nimport ScalarField from './ScalarField.js';\r\nwindow.L.ScalarField = ScalarField;\r\n\r\nimport VectorField from './VectorField.js';\r\nwindow.L.VectorField = VectorField;\r\n\r\n// layer\r\nrequire('./layer/L.CanvasLayer.js');\r\nrequire('./layer/L.CanvasLayer.SimpleLonLat.js');\r\nrequire('./layer/L.CanvasLayer.Field.js');\r\nrequire('./layer/L.CanvasLayer.ScalarField.js');\r\nrequire('./layer/L.CanvasLayer.VectorFieldAnim.js');\r\n\r\n// control\r\nrequire('./control/L.Control.ColorBar.js');\r\nrequire('./control/L.Control.LayersPlayer.js');\r\n"],"sourceRoot":""}